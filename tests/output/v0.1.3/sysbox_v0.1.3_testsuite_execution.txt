# Ubuntu Bionic VM


```
vagrant@ubuntu-bionic-vm:~/wsp/v0.1.3/sysbox$ make test

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:bionic
 ---> ccc6e87d482b
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> 0b5cc71e768b
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> e8beb0b42a48
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> 402e90d536f6
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> 459fa3cffa48
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> 1caf07cd6d25
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 6c7cedf81582
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 1b14b7efa482
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> ecda69a9f702
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> b3f60268059c
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 42bc36679f60
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> 48dabd6b1f31
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         $(lsb_release -cs)         stable"
 ---> Using cache
 ---> 0f186ffe03fb
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> b78715b6212f
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> d55903bc1285
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> 0140bc4409be
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> 6ca6ca771ab1
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> 456d15f528dd
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> 7118444e54c9
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> 27e03db6af83
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> 37be812812d0
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> 0c95f8739821
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> 999a490fb1fd
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> 6a08fb3c64d5
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> f0587217cb1c
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> 6d2086a5de28
Successfully built 6d2086a5de28
Successfully tagged sysbox-test:latest

** Running sysbox-fs unit tests **

docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "make --no-print-directory test-fs-local"
make[1]: 'protobuf.pb.go' is up to date.
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
cd sysbox-fs && go test -timeout 3m -v github.com/nestybox/sysbox-fs/cmd/sysbox-fs github.com/nestybox/sysbox-fs/domain github.com/nestybox/sysbox-fs/fuse github.com/nestybox/sysbox-fs/handler github.com/nestybox/sysbox-fs/handler/implementations github.com/nestybox/sysbox-fs/ipc github.com/nestybox/sysbox-fs/mocks github.com/nestybox/sysbox-fs/nsenter github.com/nestybox/sysbox-fs/state github.com/nestybox/sysbox-fs/sysio
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
=== RUN   Test_signalHandler
--- PASS: Test_signalHandler (0.00s)
=== RUN   Test_main
--- PASS: Test_main (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/cmd/sysbox-fs	0.006s
?   	github.com/nestybox/sysbox-fs/domain	[no test files]
=== RUN   TestNewFuseService
=== RUN   TestNewFuseService/1
=== RUN   TestNewFuseService/2
--- PASS: TestNewFuseService (0.00s)
    --- PASS: TestNewFuseService/1 (0.00s)
    --- PASS: TestNewFuseService/2 (0.00s)
=== RUN   Test_fuseService_Run
--- SKIP: Test_fuseService_Run (0.00s)
    server_test.go:75: Skipping fuseService.Runc() for now
=== RUN   Test_fuseService_Root
--- PASS: Test_fuseService_Root (0.00s)
=== RUN   Test_fuseService_MountPoint
--- PASS: Test_fuseService_MountPoint (0.00s)
=== RUN   Test_fuseService_Unmount
--- PASS: Test_fuseService_Unmount (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/fuse	0.016s
?   	github.com/nestybox/sysbox-fs/handler	[no test files]
=== RUN   TestCommonHandler_Lookup
=== RUN   TestCommonHandler_Lookup/1
=== RUN   TestCommonHandler_Lookup/2
=== RUN   TestCommonHandler_Lookup/3
--- PASS: TestCommonHandler_Lookup (0.00s)
    --- PASS: TestCommonHandler_Lookup/1 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Lookup/2 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Lookup/3 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_Getattr
=== RUN   TestCommonHandler_Getattr/1
=== RUN   TestCommonHandler_Getattr/2
--- PASS: TestCommonHandler_Getattr (0.00s)
    --- PASS: TestCommonHandler_Getattr/1 (0.00s)
    --- PASS: TestCommonHandler_Getattr/2 (0.00s)
=== RUN   TestCommonHandler_Read
=== RUN   TestCommonHandler_Read/1
=== RUN   TestCommonHandler_Read/2
=== RUN   TestCommonHandler_Read/3
--- PASS: TestCommonHandler_Read (0.00s)
    --- PASS: TestCommonHandler_Read/1 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Read/2 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Read/3 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_Write
=== RUN   TestCommonHandler_Write/1
=== RUN   TestCommonHandler_Write/2
=== RUN   TestCommonHandler_Write/3
--- PASS: TestCommonHandler_Write (0.00s)
    --- PASS: TestCommonHandler_Write/1 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Write/2 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Write/3 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_ReadDirAll
=== RUN   TestCommonHandler_ReadDirAll/1
=== RUN   TestCommonHandler_ReadDirAll/2
=== RUN   TestCommonHandler_ReadDirAll/3
--- PASS: TestCommonHandler_ReadDirAll (0.00s)
    --- PASS: TestCommonHandler_ReadDirAll/1 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_ReadDirAll/2 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_ReadDirAll/3 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_EmulatedFilesInfo
=== RUN   TestCommonHandler_EmulatedFilesInfo/1
--- PASS: TestCommonHandler_EmulatedFilesInfo (0.00s)
    --- PASS: TestCommonHandler_EmulatedFilesInfo/1 (0.00s)
=== RUN   TestCommonHandler_FetchFile
=== RUN   TestCommonHandler_FetchFile/1
--- PASS: TestCommonHandler_FetchFile (0.00s)
    --- PASS: TestCommonHandler_FetchFile/1 (0.00s)
        common_test.go:1097: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:1097: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:1097: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_PushFile
=== RUN   TestCommonHandler_PushFile/1
--- PASS: TestCommonHandler_PushFile (0.00s)
    --- PASS: TestCommonHandler_PushFile/1 (0.00s)
        common_test.go:1226: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:1226: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:1226: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_GetName
=== RUN   TestCommonHandler_GetName/1
--- PASS: TestCommonHandler_GetName (0.00s)
    --- PASS: TestCommonHandler_GetName/1 (0.00s)
=== RUN   TestCommonHandler_GetPath
=== RUN   TestCommonHandler_GetPath/1
--- PASS: TestCommonHandler_GetPath (0.00s)
    --- PASS: TestCommonHandler_GetPath/1 (0.00s)
=== RUN   TestCommonHandler_GetEnabled
=== RUN   TestCommonHandler_GetEnabled/1
--- PASS: TestCommonHandler_GetEnabled (0.00s)
    --- PASS: TestCommonHandler_GetEnabled/1 (0.00s)
=== RUN   TestCommonHandler_GetService
=== RUN   TestCommonHandler_GetService/1
--- PASS: TestCommonHandler_GetService (0.00s)
    --- PASS: TestCommonHandler_GetService/1 (0.00s)
=== RUN   TestCommonHandler_SetEnabled
=== RUN   TestCommonHandler_SetEnabled/1
--- PASS: TestCommonHandler_SetEnabled (0.00s)
    --- PASS: TestCommonHandler_SetEnabled/1 (0.00s)
=== RUN   TestCommonHandler_SetService
=== RUN   TestCommonHandler_SetService/1
--- PASS: TestCommonHandler_SetService (0.00s)
    --- PASS: TestCommonHandler_SetService/1 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Lookup
=== RUN   TestNfConntrackMaxHandler_Lookup/1
--- PASS: TestNfConntrackMaxHandler_Lookup (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Lookup/1 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Getattr
=== RUN   TestNfConntrackMaxHandler_Getattr/1
=== RUN   TestNfConntrackMaxHandler_Getattr/2
--- PASS: TestNfConntrackMaxHandler_Getattr (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Getattr/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Getattr/2 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Open
=== RUN   TestNfConntrackMaxHandler_Open/1
=== RUN   TestNfConntrackMaxHandler_Open/2
=== RUN   TestNfConntrackMaxHandler_Open/3
--- PASS: TestNfConntrackMaxHandler_Open (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/2 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/3 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Close
--- PASS: TestNfConntrackMaxHandler_Close (0.00s)
=== RUN   TestNfConntrackMaxHandler_Read
=== RUN   TestNfConntrackMaxHandler_Read/1
=== RUN   TestNfConntrackMaxHandler_Read/2
=== RUN   TestNfConntrackMaxHandler_Read/3
=== RUN   TestNfConntrackMaxHandler_Read/4
--- PASS: TestNfConntrackMaxHandler_Read (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/2 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/3 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/4 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Write
--- SKIP: TestNfConntrackMaxHandler_Write (0.00s)
    nfConntrackMax_test.go:542: Skipping write testcase temporarily
=== RUN   TestNfConntrackMaxHandler_ReadDirAll
--- PASS: TestNfConntrackMaxHandler_ReadDirAll (0.00s)
=== RUN   TestNfConntrackMaxHandler_FetchFile
--- PASS: TestNfConntrackMaxHandler_FetchFile (0.00s)
=== RUN   TestNfConntrackMaxHandler_PushFile
--- PASS: TestNfConntrackMaxHandler_PushFile (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetName
--- PASS: TestNfConntrackMaxHandler_GetName (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetPath
--- PASS: TestNfConntrackMaxHandler_GetPath (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetEnabled
--- PASS: TestNfConntrackMaxHandler_GetEnabled (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetService
--- PASS: TestNfConntrackMaxHandler_GetService (0.00s)
=== RUN   TestNfConntrackMaxHandler_SetEnabled
--- PASS: TestNfConntrackMaxHandler_SetEnabled (0.00s)
=== RUN   TestNfConntrackMaxHandler_SetService
--- PASS: TestNfConntrackMaxHandler_SetService (0.00s)
=== RUN   TestProcUptimeHandler_Lookup
=== RUN   TestProcUptimeHandler_Lookup/1
--- PASS: TestProcUptimeHandler_Lookup (0.00s)
    --- PASS: TestProcUptimeHandler_Lookup/1 (0.00s)
=== RUN   TestProcUptimeHandler_Getattr
=== RUN   TestProcUptimeHandler_Getattr/1
=== RUN   TestProcUptimeHandler_Getattr/2
--- PASS: TestProcUptimeHandler_Getattr (0.00s)
    --- PASS: TestProcUptimeHandler_Getattr/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Getattr/2 (0.00s)
=== RUN   TestProcUptimeHandler_Open
=== RUN   TestProcUptimeHandler_Open/1
=== RUN   TestProcUptimeHandler_Open/2
=== RUN   TestProcUptimeHandler_Open/3
--- PASS: TestProcUptimeHandler_Open (0.00s)
    --- PASS: TestProcUptimeHandler_Open/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Open/2 (0.00s)
    --- PASS: TestProcUptimeHandler_Open/3 (0.00s)
=== RUN   TestProcUptimeHandler_Read
=== RUN   TestProcUptimeHandler_Read/1
=== RUN   TestProcUptimeHandler_Read/2
=== RUN   TestProcUptimeHandler_Read/3
=== RUN   TestProcUptimeHandler_Read/4
--- PASS: TestProcUptimeHandler_Read (0.00s)
    --- PASS: TestProcUptimeHandler_Read/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/2 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/3 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/4 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/handler/implementations	0.017s
=== RUN   TestNewIpcService
--- PASS: TestNewIpcService (0.00s)
=== RUN   TestContainerRegister
=== RUN   TestContainerRegister/1
=== RUN   TestContainerRegister/2
=== RUN   TestContainerRegister/3
--- PASS: TestContainerRegister (0.00s)
    --- PASS: TestContainerRegister/1 (0.00s)
    --- PASS: TestContainerRegister/2 (0.00s)
    --- PASS: TestContainerRegister/3 (0.00s)
=== RUN   TestContainerUnregister
=== RUN   TestContainerUnregister/1
=== RUN   TestContainerUnregister/2
=== RUN   TestContainerUnregister/3
--- PASS: TestContainerUnregister (0.00s)
    --- PASS: TestContainerUnregister/1 (0.00s)
    --- PASS: TestContainerUnregister/2 (0.00s)
    --- PASS: TestContainerUnregister/3 (0.00s)
=== RUN   TestContainerUpdate
=== RUN   TestContainerUpdate/1
=== RUN   TestContainerUpdate/2
=== RUN   TestContainerUpdate/3
--- PASS: TestContainerUpdate (0.00s)
    --- PASS: TestContainerUpdate/1 (0.00s)
    --- PASS: TestContainerUpdate/2 (0.00s)
    --- PASS: TestContainerUpdate/3 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/ipc	0.005s
?   	github.com/nestybox/sysbox-fs/mocks	[no test files]
?   	github.com/nestybox/sysbox-fs/nsenter	[no test files]
=== RUN   TestNewContainerStateService
=== RUN   TestNewContainerStateService/1
--- PASS: TestNewContainerStateService (0.00s)
    --- PASS: TestNewContainerStateService/1 (0.00s)
=== RUN   Test_containerStateService_ContainerCreate
=== RUN   Test_containerStateService_ContainerCreate/1
--- PASS: Test_containerStateService_ContainerCreate (0.00s)
    --- PASS: Test_containerStateService_ContainerCreate/1 (0.00s)
=== RUN   Test_containerStateService_ContainerAdd
=== RUN   Test_containerStateService_ContainerAdd/1
=== RUN   Test_containerStateService_ContainerAdd/2
=== RUN   Test_containerStateService_ContainerAdd/3
--- PASS: Test_containerStateService_ContainerAdd (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/3 (0.00s)
=== RUN   Test_containerStateService_ContainerUpdate
=== RUN   Test_containerStateService_ContainerUpdate/1
=== RUN   Test_containerStateService_ContainerUpdate/2
=== RUN   Test_containerStateService_ContainerUpdate/3
--- PASS: Test_containerStateService_ContainerUpdate (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/3 (0.00s)
=== RUN   Test_containerStateService_ContainerDelete
=== RUN   Test_containerStateService_ContainerDelete/1
=== RUN   Test_containerStateService_ContainerDelete/2
=== RUN   Test_containerStateService_ContainerDelete/3
--- PASS: Test_containerStateService_ContainerDelete (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/3 (0.00s)
=== RUN   Test_containerStateService_ContainerLookupById
=== RUN   Test_containerStateService_ContainerLookupById/1
=== RUN   Test_containerStateService_ContainerLookupById/2
=== RUN   Test_containerStateService_ContainerLookupById/3
--- PASS: Test_containerStateService_ContainerLookupById (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/3 (0.00s)
=== RUN   Test_containerStateService_ContainerLookupByPid
=== RUN   Test_containerStateService_ContainerLookupByPid/1
=== RUN   Test_containerStateService_ContainerLookupByPid/2
=== RUN   Test_containerStateService_ContainerLookupByPid/3
--- PASS: Test_containerStateService_ContainerLookupByPid (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/3 (0.00s)
=== RUN   Test_container_ID
=== RUN   Test_container_ID/1
=== RUN   Test_container_ID/2
--- PASS: Test_container_ID (0.00s)
    --- PASS: Test_container_ID/1 (0.00s)
    --- PASS: Test_container_ID/2 (0.00s)
=== RUN   Test_container_InitPid
=== RUN   Test_container_InitPid/1
=== RUN   Test_container_InitPid/2
--- PASS: Test_container_InitPid (0.00s)
    --- PASS: Test_container_InitPid/1 (0.00s)
    --- PASS: Test_container_InitPid/2 (0.00s)
=== RUN   Test_container_Hostname
=== RUN   Test_container_Hostname/1
=== RUN   Test_container_Hostname/2
--- PASS: Test_container_Hostname (0.00s)
    --- PASS: Test_container_Hostname/1 (0.00s)
    --- PASS: Test_container_Hostname/2 (0.00s)
=== RUN   Test_container_Ctime
=== RUN   Test_container_Ctime/1
=== RUN   Test_container_Ctime/2
--- PASS: Test_container_Ctime (0.00s)
    --- PASS: Test_container_Ctime/1 (0.00s)
    --- PASS: Test_container_Ctime/2 (0.00s)
=== RUN   Test_container_PidInode
=== RUN   Test_container_PidInode/1
=== RUN   Test_container_PidInode/2
--- PASS: Test_container_PidInode (0.00s)
    --- PASS: Test_container_PidInode/1 (0.00s)
    --- PASS: Test_container_PidInode/2 (0.00s)
=== RUN   Test_container_Data
=== RUN   Test_container_Data/1
=== RUN   Test_container_Data/2
=== RUN   Test_container_Data/3
=== RUN   Test_container_Data/4
--- PASS: Test_container_Data (0.00s)
    --- PASS: Test_container_Data/1 (0.00s)
    --- PASS: Test_container_Data/2 (0.00s)
    --- PASS: Test_container_Data/3 (0.00s)
    --- PASS: Test_container_Data/4 (0.00s)
=== RUN   Test_container_String
=== RUN   Test_container_String/1
--- PASS: Test_container_String (0.00s)
    --- PASS: Test_container_String/1 (0.00s)
=== RUN   Test_container_SetCtime
=== RUN   Test_container_SetCtime/1
=== RUN   Test_container_SetCtime/2
--- PASS: Test_container_SetCtime (0.00s)
    --- PASS: Test_container_SetCtime/1 (0.00s)
    --- PASS: Test_container_SetCtime/2 (0.00s)
=== RUN   Test_container_SetData
=== RUN   Test_container_SetData/1
=== RUN   Test_container_SetData/2
=== RUN   Test_container_SetData/3
--- PASS: Test_container_SetData (0.00s)
    --- PASS: Test_container_SetData/1 (0.00s)
    --- PASS: Test_container_SetData/2 (0.00s)
    --- PASS: Test_container_SetData/3 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/state	0.004s
=== RUN   Test_ioFileService_NewIOnode
--- PASS: Test_ioFileService_NewIOnode (0.00s)
=== RUN   Test_ioFileService_OpenNode
=== RUN   Test_ioFileService_OpenNode/1
--- PASS: Test_ioFileService_OpenNode (0.00s)
    --- PASS: Test_ioFileService_OpenNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadNode
=== RUN   Test_ioFileService_ReadNode/1
--- PASS: Test_ioFileService_ReadNode (0.00s)
    --- PASS: Test_ioFileService_ReadNode/1 (0.00s)
=== RUN   Test_ioFileService_WriteNode
=== RUN   Test_ioFileService_WriteNode/1
--- PASS: Test_ioFileService_WriteNode (0.00s)
    --- PASS: Test_ioFileService_WriteNode/1 (0.00s)
=== RUN   Test_ioFileService_CloseNode
=== RUN   Test_ioFileService_CloseNode/1
--- PASS: Test_ioFileService_CloseNode (0.00s)
    --- PASS: Test_ioFileService_CloseNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadAtNode
=== RUN   Test_ioFileService_ReadAtNode/1
--- PASS: Test_ioFileService_ReadAtNode (0.00s)
    --- PASS: Test_ioFileService_ReadAtNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadDirAllNode
--- PASS: Test_ioFileService_ReadDirAllNode (0.00s)
=== RUN   Test_ioFileService_ReadLineNode
=== RUN   Test_ioFileService_ReadLineNode/1
--- PASS: Test_ioFileService_ReadLineNode (0.00s)
    --- PASS: Test_ioFileService_ReadLineNode/1 (0.00s)
=== RUN   Test_ioFileService_StatNode
=== RUN   Test_ioFileService_StatNode/1
--- PASS: Test_ioFileService_StatNode (0.00s)
    --- PASS: Test_ioFileService_StatNode/1 (0.00s)
=== RUN   Test_ioFileService_SeekResetNode
=== RUN   Test_ioFileService_SeekResetNode/1
--- PASS: Test_ioFileService_SeekResetNode (0.00s)
    --- PASS: Test_ioFileService_SeekResetNode/1 (0.00s)
=== RUN   Test_ioFileService_PidNsInode
--- SKIP: Test_ioFileService_PidNsInode (0.00s)
    ionodeFile_test.go:438: Skipping IOnodeService.PidNsInode() for now
=== RUN   Test_ioFileService_PathNode
=== RUN   Test_ioFileService_PathNode/1
--- PASS: Test_ioFileService_PathNode (0.00s)
    --- PASS: Test_ioFileService_PathNode/1 (0.00s)
=== RUN   TestIOnodeFile_Open
=== RUN   TestIOnodeFile_Open/1
=== RUN   TestIOnodeFile_Open/2
--- PASS: TestIOnodeFile_Open (0.00s)
    --- PASS: TestIOnodeFile_Open/1 (0.00s)
    --- PASS: TestIOnodeFile_Open/2 (0.00s)
=== RUN   TestIOnodeFile_Read
=== RUN   TestIOnodeFile_Read/1
=== RUN   TestIOnodeFile_Read/2
=== RUN   TestIOnodeFile_Read/3
=== RUN   TestIOnodeFile_Read/4
--- PASS: TestIOnodeFile_Read (0.00s)
    --- PASS: TestIOnodeFile_Read/1 (0.00s)
    --- PASS: TestIOnodeFile_Read/2 (0.00s)
    --- PASS: TestIOnodeFile_Read/3 (0.00s)
    --- PASS: TestIOnodeFile_Read/4 (0.00s)
=== RUN   TestIOnodeFile_Write
=== RUN   TestIOnodeFile_Write/1
=== RUN   TestIOnodeFile_Write/2
=== RUN   TestIOnodeFile_Write/3
--- PASS: TestIOnodeFile_Write (0.00s)
    --- PASS: TestIOnodeFile_Write/1 (0.00s)
    --- PASS: TestIOnodeFile_Write/2 (0.00s)
    --- PASS: TestIOnodeFile_Write/3 (0.00s)
=== RUN   TestIOnodeFile_Close
=== RUN   TestIOnodeFile_Close/1
=== RUN   TestIOnodeFile_Close/2
--- PASS: TestIOnodeFile_Close (0.00s)
    --- PASS: TestIOnodeFile_Close/1 (0.00s)
    --- PASS: TestIOnodeFile_Close/2 (0.00s)
=== RUN   TestIOnodeFile_ReadAt
=== RUN   TestIOnodeFile_ReadAt/1
=== RUN   TestIOnodeFile_ReadAt/2
=== RUN   TestIOnodeFile_ReadAt/3
=== RUN   TestIOnodeFile_ReadAt/4
--- PASS: TestIOnodeFile_ReadAt (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/2 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/3 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/4 (0.00s)
=== RUN   TestIOnodeFile_ReadDirAll
=== RUN   TestIOnodeFile_ReadDirAll/1
=== RUN   TestIOnodeFile_ReadDirAll/2
--- PASS: TestIOnodeFile_ReadDirAll (0.00s)
    --- PASS: TestIOnodeFile_ReadDirAll/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadDirAll/2 (0.00s)
=== RUN   TestIOnodeFile_ReadLine
=== RUN   TestIOnodeFile_ReadLine/1
=== RUN   TestIOnodeFile_ReadLine/2
=== RUN   TestIOnodeFile_ReadLine/3
=== RUN   TestIOnodeFile_ReadLine/4
--- PASS: TestIOnodeFile_ReadLine (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/2 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/3 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/4 (0.00s)
=== RUN   TestIOnodeFile_Stat
=== RUN   TestIOnodeFile_Stat/1
=== RUN   TestIOnodeFile_Stat/2
--- PASS: TestIOnodeFile_Stat (0.00s)
    --- PASS: TestIOnodeFile_Stat/1 (0.00s)
    --- PASS: TestIOnodeFile_Stat/2 (0.00s)
=== RUN   TestIOnodeFile_SeekReset
=== RUN   TestIOnodeFile_SeekReset/1
=== RUN   TestIOnodeFile_SeekReset/2
--- PASS: TestIOnodeFile_SeekReset (0.00s)
    --- PASS: TestIOnodeFile_SeekReset/1 (0.00s)
    --- PASS: TestIOnodeFile_SeekReset/2 (0.00s)
=== RUN   TestIOnodeFile_PidNsInode
=== RUN   TestIOnodeFile_PidNsInode/1
--- PASS: TestIOnodeFile_PidNsInode (0.00s)
    --- PASS: TestIOnodeFile_PidNsInode/1 (0.00s)
=== RUN   TestIOnodeFile_Name
=== RUN   TestIOnodeFile_Name/1
--- PASS: TestIOnodeFile_Name (0.00s)
    --- PASS: TestIOnodeFile_Name/1 (0.00s)
=== RUN   TestIOnodeFile_Path
=== RUN   TestIOnodeFile_Path/1
--- PASS: TestIOnodeFile_Path (0.00s)
    --- PASS: TestIOnodeFile_Path/1 (0.00s)
=== RUN   TestIOnodeFile_OpenFlags
=== RUN   TestIOnodeFile_OpenFlags/1
=== RUN   TestIOnodeFile_OpenFlags/2
--- PASS: TestIOnodeFile_OpenFlags (0.00s)
    --- PASS: TestIOnodeFile_OpenFlags/1 (0.00s)
    --- PASS: TestIOnodeFile_OpenFlags/2 (0.00s)
=== RUN   TestIOnodeFile_SetOpenFlags
=== RUN   TestIOnodeFile_SetOpenFlags/1
=== RUN   TestIOnodeFile_SetOpenFlags/2
--- PASS: TestIOnodeFile_SetOpenFlags (0.00s)
    --- PASS: TestIOnodeFile_SetOpenFlags/1 (0.00s)
    --- PASS: TestIOnodeFile_SetOpenFlags/2 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/sysio	0.012s

** Running sysbox-mgr unit tests **

docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "make --no-print-directory test-mgr-local"
make[1]: 'protobuf.pb.go' is up to date.
cd sysbox-mgr && go test -timeout 3m -v github.com/nestybox/sysbox-mgr github.com/nestybox/sysbox-mgr/dsVolMgr github.com/nestybox/sysbox-mgr/intf github.com/nestybox/sysbox-mgr/lib/buddyAlloc github.com/nestybox/sysbox-mgr/lib/dockerUtils github.com/nestybox/sysbox-mgr/shiftfsMgr github.com/nestybox/sysbox-mgr/subidAlloc
=== RUN   TestAllocSubidRange
--- PASS: TestAllocSubidRange (0.00s)
=== RUN   TestConfigSubidRange
--- PASS: TestConfigSubidRange (0.01s)
=== RUN   TestGetSubidLimits
--- PASS: TestGetSubidLimits (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr	0.017s
=== RUN   TestCreateVol
--- PASS: TestCreateVol (0.00s)
=== RUN   TestDestroyVol
--- PASS: TestDestroyVol (0.00s)
=== RUN   TestSyncIn
--- PASS: TestSyncIn (0.03s)
=== RUN   TestSyncInUidShift
--- PASS: TestSyncInUidShift (0.02s)
=== RUN   TestSyncOut
--- PASS: TestSyncOut (0.01s)
=== RUN   TestSyncOutUidShift
--- PASS: TestSyncOutUidShift (0.01s)
=== RUN   TestSyncInSkip
--- PASS: TestSyncInSkip (0.00s)
=== RUN   TestSyncOutSkip
--- PASS: TestSyncOutSkip (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/dsVolMgr	0.078s
?   	github.com/nestybox/sysbox-mgr/intf	[no test files]
=== RUN   TestGetBlkSize
--- PASS: TestGetBlkSize (0.00s)
=== RUN   TestGetOrder
--- PASS: TestGetOrder (0.00s)
=== RUN   TestBuddyLimits
--- PASS: TestBuddyLimits (0.00s)
=== RUN   TestMaxRange
--- PASS: TestMaxRange (0.00s)
=== RUN   TestAllocBasic
--- PASS: TestAllocBasic (0.00s)
=== RUN   TestAllocExhausted
--- PASS: TestAllocExhausted (0.00s)
=== RUN   TestRealloc
--- PASS: TestRealloc (0.00s)
=== RUN   TestFree
--- PASS: TestFree (0.00s)
=== RUN   TestFreeEmpty
--- PASS: TestFreeEmpty (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/lib/buddyAlloc	0.015s
=== RUN   TestParseDataRoot
--- PASS: TestParseDataRoot (0.00s)
=== RUN   TestIsDockerContainer
--- PASS: TestIsDockerContainer (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/lib/dockerUtils	0.002s
=== RUN   TestShiftfsMgrBasic
--- PASS: TestShiftfsMgrBasic (0.02s)
=== RUN   TestShiftfsMgrErrors
--- PASS: TestShiftfsMgrErrors (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/shiftfsMgr	0.034s
=== RUN   TestAllocBasic
--- PASS: TestAllocBasic (0.00s)
=== RUN   TestAllocRangeLimit
--- PASS: TestAllocRangeLimit (0.00s)
=== RUN   TestAllocReuse
--- PASS: TestAllocReuse (0.00s)
=== RUN   TestAllocNoReuse
--- PASS: TestAllocNoReuse (0.00s)
=== RUN   TestAllocErrors
--- PASS: TestAllocErrors (0.00s)
=== RUN   TestFreeBasic
--- PASS: TestFreeBasic (0.00s)
=== RUN   TestFreeErrors
--- PASS: TestFreeErrors (0.00s)
=== RUN   TestAllocInvalidUser
--- PASS: TestAllocInvalidUser (0.00s)
=== RUN   TestConcurrency
--- PASS: TestConcurrency (0.00s)
=== RUN   TestAllocLimits
--- PASS: TestAllocLimits (0.00s)
=== RUN   TestAllocMultiRange
--- PASS: TestAllocMultiRange (0.00s)
=== RUN   TestGetCommonRanges
--- PASS: TestGetCommonRanges (0.00s)
=== RUN   TestAllocCommonRange
--- PASS: TestAllocCommonRange (0.00s)
=== RUN   TestIdentityMode
--- PASS: TestIdentityMode (0.00s)
=== RUN   TestExclusiveModeOverride
--- PASS: TestExclusiveModeOverride (0.00s)
=== RUN   TestIdentityModeOverride
--- PASS: TestIdentityModeOverride (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/subidAlloc	0.006s
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxFsGrpc/protobuf'
make[1]: 'protobuf.pb.go' is up to date.
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxFsGrpc/protobuf'
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxMgrGrpc/protobuf'
make[1]: 'protobuf.pb.go' is up to date.
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxMgrGrpc/protobuf'

** Running sysbox-runc unit & integration tests **

cd sysbox-runc && make clean && make BUILDTAGS="seccomp apparmor" test
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
rm -f sysbox-runc sysbox-runc-*
rm -f contrib/cmd/recvtty/recvtty
rm -rf /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/release
rm -rf /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/man/man8
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make unittest integration integration-shiftuid
make[2]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
docker build  -t runc_dev:HEAD .
Sending build context to Docker daemon  1.373MB
Step 1/13 : FROM golang:1.13.0-buster
 ---> c4d6fdf2260a
Step 2/13 : RUN dpkg --add-architecture armel     && dpkg --add-architecture armhf     && dpkg --add-architecture arm64     && dpkg --add-architecture ppc64el     && apt-get update && apt-get install -y     build-essential     curl     sudo     gawk     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libprotobuf-c-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     crossbuild-essential-armel crossbuild-essential-armhf crossbuild-essential-arm64 crossbuild-essential-ppc64el     libseccomp-dev:armel libseccomp-dev:armhf libseccomp-dev:arm64 libseccomp-dev:ppc64el     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> 4590fcdf6f34
Step 3/13 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 7faa7e3a7cee
Step 4/13 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 5eddcc27844e
Step 5/13 : ENV CRIU_VERSION v3.11
 ---> Using cache
 ---> 975f0399498a
Step 6/13 : RUN mkdir -p /usr/src/criu     && curl -sSL https://github.com/checkpoint-restore/criu/archive/${CRIU_VERSION}.tar.gz | tar -v -C /usr/src/criu/ -xz --strip-components=1     && cd /usr/src/criu     && curl https://github.com/checkpoint-restore/criu/commit/bb0b2f2635d71e549851b7c626a1464e42a3b5c7.patch | patch -p1     && make install-criu     && rm -rf /usr/src/criu
 ---> Using cache
 ---> 775db8d6665d
Step 7/13 : ENV ROOTFS /busybox
 ---> Using cache
 ---> a9159d371438
Step 8/13 : RUN mkdir -p ${ROOTFS}
 ---> Using cache
 ---> 2f1cbe531cec
Step 9/13 : COPY script/tmpmount /
 ---> Using cache
 ---> 8e8cd08fbc81
Step 10/13 : WORKDIR /root/nestybox/sysbox-runc
 ---> Using cache
 ---> f91eda8d9ac4
Step 11/13 : ENTRYPOINT ["/tmpmount"]
 ---> Using cache
 ---> e24c4eb4ec7d
Step 12/13 : ADD . /root/nestybox/sysbox-runc
 ---> Using cache
 ---> 515784c3988d
Step 13/13 : RUN . tests/integration/multi-arch.bash     && curl -o- -sSL `get_busybox` | tar xfJC - ${ROOTFS}
 ---> Using cache
 ---> 96d2829c6ef0
Successfully built 96d2829c6ef0
Successfully tagged runc_dev:HEAD
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localunittest TESTFLAGS=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
go build -buildmode=pie  -ldflags "-X main.gitCommit="" -X main.version= " -tags "seccomp" -o contrib/cmd/recvtty/recvtty ./contrib/cmd/recvtty
go build -buildmode=pie  -ldflags '-X main.version= -X main.commitId= -X "main.builtAt=" -X main.builtBy=' -tags "seccomp" \
	-o sysbox-runc .
go: finding github.com/vishvananda/netns latest
go: finding github.com/coreos/pkg latest
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/coreos/pkg latest
go: finding github.com/vishvananda/netns latest
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
go test -timeout 3m -tags "seccomp"  -v github.com/nestybox/sysbox-runc github.com/nestybox/sysbox-runc/contrib/cmd/recvtty github.com/nestybox/sysbox-runc/libcontainer github.com/nestybox/sysbox-runc/libcontainer/apparmor github.com/nestybox/sysbox-runc/libcontainer/cgroups github.com/nestybox/sysbox-runc/libcontainer/cgroups/fs github.com/nestybox/sysbox-runc/libcontainer/cgroups/systemd github.com/nestybox/sysbox-runc/libcontainer/configs github.com/nestybox/sysbox-runc/libcontainer/configs/validate github.com/nestybox/sysbox-runc/libcontainer/devices github.com/nestybox/sysbox-runc/libcontainer/integration github.com/nestybox/sysbox-runc/libcontainer/intelrdt github.com/nestybox/sysbox-runc/libcontainer/keys github.com/nestybox/sysbox-runc/libcontainer/mount github.com/nestybox/sysbox-runc/libcontainer/nsenter github.com/nestybox/sysbox-runc/libcontainer/seccomp github.com/nestybox/sysbox-runc/libcontainer/specconv github.com/nestybox/sysbox-runc/libcontainer/stacktrace github.com/nestybox/sysbox-runc/libcontainer/system github.com/nestybox/sysbox-runc/libcontainer/user github.com/nestybox/sysbox-runc/libcontainer/utils github.com/nestybox/sysbox-runc/libsysbox/shiftfs github.com/nestybox/sysbox-runc/libsysbox/sysbox github.com/nestybox/sysbox-runc/libsysbox/syscont
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
?   	github.com/nestybox/sysbox-runc	[no test files]
?   	github.com/nestybox/sysbox-runc/contrib/cmd/recvtty	[no test files]
=== RUN   TestGetContainerPids
--- PASS: TestGetContainerPids (0.00s)
=== RUN   TestGetContainerStats
--- PASS: TestGetContainerStats (0.00s)
=== RUN   TestGetContainerState
--- PASS: TestGetContainerState (0.00s)
=== RUN   TestGetContainerStateAfterUpdate
--- PASS: TestGetContainerStateAfterUpdate (0.00s)
=== RUN   TestErrorCode
--- PASS: TestErrorCode (0.00s)
=== RUN   TestFactoryNew
--- PASS: TestFactoryNew (0.00s)
=== RUN   TestFactoryNewIntelRdt
--- PASS: TestFactoryNewIntelRdt (0.00s)
=== RUN   TestFactoryNewTmpfs
--- PASS: TestFactoryNewTmpfs (0.00s)
=== RUN   TestFactoryLoadNotExists
--- PASS: TestFactoryLoadNotExists (0.00s)
=== RUN   TestFactoryLoadContainer
time="2020-02-02T21:08:28Z" level=warning msg="cannot serialize hook of type libcontainer.unserializableHook, skipping"
--- PASS: TestFactoryLoadContainer (0.00s)
=== RUN   TestErrorDetail
--- PASS: TestErrorDetail (0.00s)
=== RUN   TestErrorWithCode
--- PASS: TestErrorWithCode (0.00s)
=== RUN   TestErrorWithError
--- PASS: TestErrorWithError (0.00s)
=== RUN   TestNotifyOnOOM
--- PASS: TestNotifyOnOOM (0.00s)
=== RUN   TestNotifyMemoryPressure
--- PASS: TestNotifyMemoryPressure (0.00s)
=== RUN   TestNeedsSetupDev
--- PASS: TestNeedsSetupDev (0.00s)
=== RUN   TestNeedsSetupDevStrangeSource
--- PASS: TestNeedsSetupDevStrangeSource (0.00s)
=== RUN   TestNeedsSetupDevStrangeDest
--- PASS: TestNeedsSetupDevStrangeDest (0.00s)
=== RUN   TestNeedsSetupDevStrangeSourceDest
--- PASS: TestNeedsSetupDevStrangeSourceDest (0.00s)
=== RUN   TestStateStatus
--- PASS: TestStateStatus (0.00s)
=== RUN   TestStoppedStateTransition
=== RUN   TestStoppedStateTransition/stopped
=== RUN   TestStoppedStateTransition/running
=== RUN   TestStoppedStateTransition/running#01
=== RUN   TestStoppedStateTransition/created
=== RUN   TestStoppedStateTransition/paused
=== RUN   TestStoppedStateTransition/running#02
--- PASS: TestStoppedStateTransition (0.00s)
    --- PASS: TestStoppedStateTransition/stopped (0.00s)
    --- PASS: TestStoppedStateTransition/running (0.00s)
    --- PASS: TestStoppedStateTransition/running#01 (0.00s)
    --- PASS: TestStoppedStateTransition/created (0.00s)
    --- PASS: TestStoppedStateTransition/paused (0.00s)
    --- PASS: TestStoppedStateTransition/running#02 (0.00s)
=== RUN   TestPausedStateTransition
=== RUN   TestPausedStateTransition/paused
=== RUN   TestPausedStateTransition/running
=== RUN   TestPausedStateTransition/stopped
=== RUN   TestPausedStateTransition/running#01
=== RUN   TestPausedStateTransition/running#02
=== RUN   TestPausedStateTransition/created
--- PASS: TestPausedStateTransition (0.00s)
    --- PASS: TestPausedStateTransition/paused (0.00s)
    --- PASS: TestPausedStateTransition/running (0.00s)
    --- PASS: TestPausedStateTransition/stopped (0.00s)
    --- PASS: TestPausedStateTransition/running#01 (0.00s)
    --- PASS: TestPausedStateTransition/running#02 (0.00s)
    --- PASS: TestPausedStateTransition/created (0.00s)
=== RUN   TestRestoredStateTransition
=== RUN   TestRestoredStateTransition/stopped
=== RUN   TestRestoredStateTransition/running
=== RUN   TestRestoredStateTransition/created
=== RUN   TestRestoredStateTransition/running#01
=== RUN   TestRestoredStateTransition/paused
=== RUN   TestRestoredStateTransition/running#02
--- PASS: TestRestoredStateTransition (0.00s)
    --- PASS: TestRestoredStateTransition/stopped (0.00s)
    --- PASS: TestRestoredStateTransition/running (0.00s)
    --- PASS: TestRestoredStateTransition/created (0.00s)
    --- PASS: TestRestoredStateTransition/running#01 (0.00s)
    --- PASS: TestRestoredStateTransition/paused (0.00s)
    --- PASS: TestRestoredStateTransition/running#02 (0.00s)
=== RUN   TestRunningStateTransition
=== RUN   TestRunningStateTransition/stopped
=== RUN   TestRunningStateTransition/paused
=== RUN   TestRunningStateTransition/running
=== RUN   TestRunningStateTransition/running#01
=== RUN   TestRunningStateTransition/created
=== RUN   TestRunningStateTransition/running#02
--- PASS: TestRunningStateTransition (0.00s)
    --- PASS: TestRunningStateTransition/stopped (0.00s)
    --- PASS: TestRunningStateTransition/paused (0.00s)
    --- PASS: TestRunningStateTransition/running (0.00s)
    --- PASS: TestRunningStateTransition/running#01 (0.00s)
    --- PASS: TestRunningStateTransition/created (0.00s)
    --- PASS: TestRunningStateTransition/running#02 (0.00s)
=== RUN   TestCreatedStateTransition
=== RUN   TestCreatedStateTransition/stopped
=== RUN   TestCreatedStateTransition/paused
=== RUN   TestCreatedStateTransition/running
=== RUN   TestCreatedStateTransition/created
=== RUN   TestCreatedStateTransition/running#01
=== RUN   TestCreatedStateTransition/running#02
--- PASS: TestCreatedStateTransition (0.00s)
    --- PASS: TestCreatedStateTransition/stopped (0.00s)
    --- PASS: TestCreatedStateTransition/paused (0.00s)
    --- PASS: TestCreatedStateTransition/running (0.00s)
    --- PASS: TestCreatedStateTransition/created (0.00s)
    --- PASS: TestCreatedStateTransition/running#01 (0.00s)
    --- PASS: TestCreatedStateTransition/running#02 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer	0.052s
?   	github.com/nestybox/sysbox-runc/libcontainer/apparmor	[no test files]
=== RUN   TestParseCgroups
--- PASS: TestParseCgroups (0.00s)
=== RUN   TestGetCgroupMounts
--- PASS: TestGetCgroupMounts (0.00s)
=== RUN   TestParseCgroupString
--- PASS: TestParseCgroupString (0.00s)
=== RUN   TestIgnoreCgroup2Mount
--- PASS: TestIgnoreCgroup2Mount (0.00s)
=== RUN   TestGetClosestMountpointAncestor
--- PASS: TestGetClosestMountpointAncestor (0.00s)
=== RUN   TestFindCgroupMountpointAndRoot
--- PASS: TestFindCgroupMountpointAndRoot (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/cgroups	0.006s
=== RUN   TestInvalidCgroupPath
--- PASS: TestInvalidCgroupPath (0.00s)
=== RUN   TestInvalidAbsoluteCgroupPath
--- PASS: TestInvalidAbsoluteCgroupPath (0.00s)
=== RUN   TestInvalidCgroupParent
--- PASS: TestInvalidCgroupParent (0.00s)
=== RUN   TestInvalidAbsoluteCgroupParent
--- PASS: TestInvalidAbsoluteCgroupParent (0.00s)
=== RUN   TestInvalidCgroupName
--- PASS: TestInvalidCgroupName (0.00s)
=== RUN   TestInvalidAbsoluteCgroupName
--- PASS: TestInvalidAbsoluteCgroupName (0.00s)
=== RUN   TestInvalidCgroupNameAndParent
--- PASS: TestInvalidCgroupNameAndParent (0.00s)
=== RUN   TestInvalidAbsoluteCgroupNameAndParent
--- PASS: TestInvalidAbsoluteCgroupNameAndParent (0.00s)
=== RUN   TestBlkioSetWeight
--- PASS: TestBlkioSetWeight (0.00s)
=== RUN   TestBlkioSetWeightDevice
--- PASS: TestBlkioSetWeightDevice (0.00s)
=== RUN   TestBlkioSetMultipleWeightDevice
--- PASS: TestBlkioSetMultipleWeightDevice (0.00s)
=== RUN   TestBlkioStats
--- PASS: TestBlkioStats (0.00s)
=== RUN   TestBlkioStatsNoSectorsFile
--- PASS: TestBlkioStatsNoSectorsFile (0.00s)
=== RUN   TestBlkioStatsNoServiceBytesFile
--- PASS: TestBlkioStatsNoServiceBytesFile (0.00s)
=== RUN   TestBlkioStatsNoServicedFile
--- PASS: TestBlkioStatsNoServicedFile (0.00s)
=== RUN   TestBlkioStatsNoQueuedFile
--- PASS: TestBlkioStatsNoQueuedFile (0.00s)
=== RUN   TestBlkioStatsNoServiceTimeFile
--- PASS: TestBlkioStatsNoServiceTimeFile (0.00s)
=== RUN   TestBlkioStatsNoWaitTimeFile
--- PASS: TestBlkioStatsNoWaitTimeFile (0.00s)
=== RUN   TestBlkioStatsNoMergedFile
--- PASS: TestBlkioStatsNoMergedFile (0.00s)
=== RUN   TestBlkioStatsNoTimeFile
--- PASS: TestBlkioStatsNoTimeFile (0.00s)
=== RUN   TestBlkioStatsUnexpectedNumberOfFields
--- PASS: TestBlkioStatsUnexpectedNumberOfFields (0.00s)
=== RUN   TestBlkioStatsUnexpectedFieldType
--- PASS: TestBlkioStatsUnexpectedFieldType (0.00s)
=== RUN   TestNonCFQBlkioStats
--- PASS: TestNonCFQBlkioStats (0.00s)
=== RUN   TestBlkioSetThrottleReadBpsDevice
--- PASS: TestBlkioSetThrottleReadBpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleWriteBpsDevice
--- PASS: TestBlkioSetThrottleWriteBpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleReadIOpsDevice
--- PASS: TestBlkioSetThrottleReadIOpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleWriteIOpsDevice
--- PASS: TestBlkioSetThrottleWriteIOpsDevice (0.00s)
=== RUN   TestCpuSetShares
--- PASS: TestCpuSetShares (0.00s)
=== RUN   TestCpuSetBandWidth
--- PASS: TestCpuSetBandWidth (0.00s)
=== RUN   TestCpuStats
--- PASS: TestCpuStats (0.00s)
=== RUN   TestNoCpuStatFile
--- PASS: TestNoCpuStatFile (0.00s)
=== RUN   TestInvalidCpuStat
--- PASS: TestInvalidCpuStat (0.00s)
=== RUN   TestCpuSetRtSchedAtApply
--- PASS: TestCpuSetRtSchedAtApply (0.00s)
=== RUN   TestCpusetSetCpus
--- PASS: TestCpusetSetCpus (0.00s)
=== RUN   TestCpusetSetMems
--- PASS: TestCpusetSetMems (0.00s)
=== RUN   TestDevicesSetAllow
--- PASS: TestDevicesSetAllow (0.00s)
=== RUN   TestDevicesSetDeny
--- PASS: TestDevicesSetDeny (0.00s)
=== RUN   TestFreezerSetState
--- PASS: TestFreezerSetState (0.00s)
=== RUN   TestFreezerSetInvalidState
--- PASS: TestFreezerSetInvalidState (0.00s)
=== RUN   TestHugetlbSetHugetlb
--- PASS: TestHugetlbSetHugetlb (0.00s)
=== RUN   TestHugetlbStats
--- PASS: TestHugetlbStats (0.00s)
=== RUN   TestHugetlbStatsNoUsageFile
--- PASS: TestHugetlbStatsNoUsageFile (0.00s)
=== RUN   TestHugetlbStatsNoMaxUsageFile
--- PASS: TestHugetlbStatsNoMaxUsageFile (0.00s)
=== RUN   TestHugetlbStatsBadUsageFile
--- PASS: TestHugetlbStatsBadUsageFile (0.00s)
=== RUN   TestHugetlbStatsBadMaxUsageFile
--- PASS: TestHugetlbStatsBadMaxUsageFile (0.00s)
=== RUN   TestMemorySetMemory
--- PASS: TestMemorySetMemory (0.00s)
=== RUN   TestMemorySetMemoryswap
--- PASS: TestMemorySetMemoryswap (0.00s)
=== RUN   TestMemorySetMemoryLargerThanSwap
--- PASS: TestMemorySetMemoryLargerThanSwap (0.00s)
=== RUN   TestMemorySetSwapSmallerThanMemory
--- PASS: TestMemorySetSwapSmallerThanMemory (0.00s)
=== RUN   TestMemorySetKernelMemory
--- PASS: TestMemorySetKernelMemory (0.00s)
=== RUN   TestMemorySetKernelMemoryTCP
--- PASS: TestMemorySetKernelMemoryTCP (0.00s)
=== RUN   TestMemorySetMemorySwappinessDefault
--- PASS: TestMemorySetMemorySwappinessDefault (0.00s)
=== RUN   TestMemoryStats
--- PASS: TestMemoryStats (0.00s)
=== RUN   TestMemoryStatsNoStatFile
--- PASS: TestMemoryStatsNoStatFile (0.00s)
=== RUN   TestMemoryStatsNoUsageFile
--- PASS: TestMemoryStatsNoUsageFile (0.00s)
=== RUN   TestMemoryStatsNoMaxUsageFile
--- PASS: TestMemoryStatsNoMaxUsageFile (0.00s)
=== RUN   TestMemoryStatsNoLimitInBytesFile
--- PASS: TestMemoryStatsNoLimitInBytesFile (0.00s)
=== RUN   TestMemoryStatsBadStatFile
--- PASS: TestMemoryStatsBadStatFile (0.00s)
=== RUN   TestMemoryStatsBadUsageFile
--- PASS: TestMemoryStatsBadUsageFile (0.00s)
=== RUN   TestMemoryStatsBadMaxUsageFile
--- PASS: TestMemoryStatsBadMaxUsageFile (0.00s)
=== RUN   TestMemoryStatsBadLimitInBytesFile
--- PASS: TestMemoryStatsBadLimitInBytesFile (0.00s)
=== RUN   TestMemorySetOomControl
--- PASS: TestMemorySetOomControl (0.00s)
=== RUN   TestNetClsSetClassid
--- PASS: TestNetClsSetClassid (0.01s)
=== RUN   TestNetPrioSetIfPrio
--- PASS: TestNetPrioSetIfPrio (0.00s)
=== RUN   TestPidsSetMax
--- PASS: TestPidsSetMax (0.00s)
=== RUN   TestPidsSetUnlimited
--- PASS: TestPidsSetUnlimited (0.00s)
=== RUN   TestPidsStats
--- PASS: TestPidsStats (0.00s)
=== RUN   TestPidsStatsUnlimited
--- PASS: TestPidsStatsUnlimited (0.00s)
=== RUN   TestGetCgroupParamsInt
--- PASS: TestGetCgroupParamsInt (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/cgroups/fs	0.032s
?   	github.com/nestybox/sysbox-runc/libcontainer/cgroups/systemd	[no test files]
=== RUN   TestRemoveNamespace
--- PASS: TestRemoveNamespace (0.00s)
=== RUN   TestHostRootUIDNoUSERNS
--- PASS: TestHostRootUIDNoUSERNS (0.00s)
=== RUN   TestHostRootUIDWithUSERNS
--- PASS: TestHostRootUIDWithUSERNS (0.00s)
=== RUN   TestHostRootGIDNoUSERNS
--- PASS: TestHostRootGIDNoUSERNS (0.00s)
=== RUN   TestHostRootGIDWithUSERNS
--- PASS: TestHostRootGIDWithUSERNS (0.00s)
=== RUN   TestUnmarshalHooks
--- PASS: TestUnmarshalHooks (0.00s)
=== RUN   TestUnmarshalHooksWithInvalidData
--- PASS: TestUnmarshalHooksWithInvalidData (0.00s)
=== RUN   TestMarshalHooks
--- PASS: TestMarshalHooks (0.00s)
=== RUN   TestMarshalUnmarshalHooks
--- PASS: TestMarshalUnmarshalHooks (0.00s)
=== RUN   TestMarshalHooksWithUnexpectedType
time="2020-02-02T21:08:29Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
--- PASS: TestMarshalHooksWithUnexpectedType (0.00s)
=== RUN   TestFuncHookRun
--- PASS: TestFuncHookRun (0.00s)
=== RUN   TestCommandHookRun
--- PASS: TestCommandHookRun (0.01s)
=== RUN   TestCommandHookRunTimeout
--- PASS: TestCommandHookRunTimeout (0.02s)
=== RUN   TestHelperProcess
Helper Process
ok  	github.com/nestybox/sysbox-runc/libcontainer/configs	0.041s
=== RUN   TestValidateRootlessEUID
--- PASS: TestValidateRootlessEUID (0.00s)
=== RUN   TestValidateRootlessEUIDUserns
--- PASS: TestValidateRootlessEUIDUserns (0.00s)
=== RUN   TestValidateRootlessEUIDMappingUid
--- PASS: TestValidateRootlessEUIDMappingUid (0.00s)
=== RUN   TestValidateNonZeroEUIDMappingGid
--- PASS: TestValidateNonZeroEUIDMappingGid (0.00s)
=== RUN   TestValidateRootlessEUIDMountUid
--- PASS: TestValidateRootlessEUIDMountUid (0.00s)
=== RUN   TestValidateRootlessEUIDMountGid
--- PASS: TestValidateRootlessEUIDMountGid (0.00s)
=== RUN   TestValidate
--- PASS: TestValidate (0.00s)
=== RUN   TestValidateWithInvalidRootfs
--- PASS: TestValidateWithInvalidRootfs (0.00s)
=== RUN   TestValidateNetworkWithoutNETNamespace
--- PASS: TestValidateNetworkWithoutNETNamespace (0.00s)
=== RUN   TestValidateNetworkRoutesWithoutNETNamespace
--- PASS: TestValidateNetworkRoutesWithoutNETNamespace (0.00s)
=== RUN   TestValidateHostname
--- PASS: TestValidateHostname (0.00s)
=== RUN   TestValidateHostnameWithoutUTSNamespace
--- PASS: TestValidateHostnameWithoutUTSNamespace (0.00s)
=== RUN   TestValidateSecurityWithMaskPaths
--- PASS: TestValidateSecurityWithMaskPaths (0.00s)
=== RUN   TestValidateSecurityWithROPaths
--- PASS: TestValidateSecurityWithROPaths (0.00s)
=== RUN   TestValidateSecurityWithoutNEWNS
--- PASS: TestValidateSecurityWithoutNEWNS (0.00s)
=== RUN   TestValidateUsernamespace
--- PASS: TestValidateUsernamespace (0.00s)
=== RUN   TestValidateUsernamespaceWithoutUserNS
--- PASS: TestValidateUsernamespaceWithoutUserNS (0.00s)
=== RUN   TestValidateSysctl
--- PASS: TestValidateSysctl (0.00s)
=== RUN   TestValidateValidSysctl
--- PASS: TestValidateValidSysctl (0.00s)
=== RUN   TestValidateSysctlWithSameNs
--- PASS: TestValidateSysctlWithSameNs (0.00s)
=== RUN   TestValidateSysctlWithoutNETNamespace
--- PASS: TestValidateSysctlWithoutNETNamespace (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/configs/validate	0.013s
=== RUN   TestDeviceFromPathLstatFailure
--- PASS: TestDeviceFromPathLstatFailure (0.00s)
=== RUN   TestHostDevicesIoutilReadDirFailure
--- PASS: TestHostDevicesIoutilReadDirFailure (0.00s)
=== RUN   TestHostDevicesIoutilReadDirDeepFailure
--- PASS: TestHostDevicesIoutilReadDirDeepFailure (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/devices	0.008s
=== RUN   TestExecPS
--- PASS: TestExecPS (0.14s)
=== RUN   TestIPCPrivate
--- PASS: TestIPCPrivate (0.09s)
=== RUN   TestIPCHost
--- PASS: TestIPCHost (0.10s)
=== RUN   TestIPCJoinPath
--- PASS: TestIPCJoinPath (0.12s)
=== RUN   TestIPCBadPath
--- PASS: TestIPCBadPath (0.02s)
=== RUN   TestRlimit
--- PASS: TestRlimit (0.12s)
=== RUN   TestUsernsRlimit
--- PASS: TestUsernsRlimit (0.11s)
=== RUN   TestEnter
--- PASS: TestEnter (0.11s)
=== RUN   TestProcessEnv
--- PASS: TestProcessEnv (0.10s)
=== RUN   TestProcessEmptyCaps
--- PASS: TestProcessEmptyCaps (0.12s)
=== RUN   TestProcessCaps
--- PASS: TestProcessCaps (0.09s)
=== RUN   TestAdditionalGroups
--- PASS: TestAdditionalGroups (0.09s)
=== RUN   TestFreeze
--- PASS: TestFreeze (0.10s)
=== RUN   TestSystemdFreeze
--- SKIP: TestSystemdFreeze (0.00s)
    exec_test.go:512: Systemd is unsupported
=== RUN   TestCpuShares
time="2020-02-02T21:08:32Z" level=warning msg="signal: killed"
--- PASS: TestCpuShares (0.05s)
=== RUN   TestCpuSharesSystemd
--- SKIP: TestCpuSharesSystemd (0.00s)
    exec_test.go:566: Systemd is unsupported
=== RUN   TestPids
--- PASS: TestPids (0.37s)
=== RUN   TestPidsSystemd
--- SKIP: TestPidsSystemd (0.00s)
    exec_test.go:597: Systemd is unsupported
=== RUN   TestRunWithKernelMemory
--- PASS: TestRunWithKernelMemory (0.13s)
=== RUN   TestRunWithKernelMemorySystemd
--- SKIP: TestRunWithKernelMemorySystemd (0.00s)
    exec_test.go:680: Systemd is unsupported
=== RUN   TestContainerState
--- PASS: TestContainerState (0.09s)
=== RUN   TestPassExtraFiles
--- PASS: TestPassExtraFiles (0.08s)
=== RUN   TestMountCmds
--- PASS: TestMountCmds (0.12s)
=== RUN   TestSysctl
--- PASS: TestSysctl (0.12s)
=== RUN   TestMountCgroupRO
--- PASS: TestMountCgroupRO (0.09s)
=== RUN   TestMountCgroupRW
--- PASS: TestMountCgroupRW (0.13s)
=== RUN   TestOomScoreAdj
--- PASS: TestOomScoreAdj (0.09s)
=== RUN   TestHook
time="2020-02-02T21:08:33Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T21:08:33Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T21:08:33Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T21:08:34Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T21:08:34Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T21:08:34Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T21:08:34Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T21:08:34Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T21:08:34Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
--- PASS: TestHook (0.10s)
=== RUN   TestSTDIOPermissions
--- PASS: TestSTDIOPermissions (0.10s)
=== RUN   TestRootfsPropagationSlaveMount
--- PASS: TestRootfsPropagationSlaveMount (0.16s)
=== RUN   TestRootfsPropagationSharedMount
--- PASS: TestRootfsPropagationSharedMount (0.14s)
=== RUN   TestPIDHost
--- SKIP: TestPIDHost (0.00s)
    exec_test.go:1498: not applicable
=== RUN   TestInitJoinPID
--- PASS: TestInitJoinPID (0.22s)
=== RUN   TestInitJoinNetworkAndUser
--- PASS: TestInitJoinNetworkAndUser (0.22s)
=== RUN   TestTmpfsCopyUp
--- PASS: TestTmpfsCopyUp (0.15s)
=== RUN   TestCGROUPPrivate
--- PASS: TestCGROUPPrivate (0.08s)
=== RUN   TestCGROUPHost
--- PASS: TestCGROUPHost (0.08s)
=== RUN   TestExecIn
--- PASS: TestExecIn (0.11s)
=== RUN   TestExecInUsernsRlimit
--- PASS: TestExecInUsernsRlimit (0.12s)
=== RUN   TestExecInRlimit
--- PASS: TestExecInRlimit (0.13s)
=== RUN   TestExecInAdditionalGroups
--- PASS: TestExecInAdditionalGroups (0.13s)
=== RUN   TestExecInError
--- PASS: TestExecInError (1.04s)
=== RUN   TestExecInTTY
--- PASS: TestExecInTTY (0.14s)
=== RUN   TestExecInEnvironment
--- PASS: TestExecInEnvironment (0.14s)
=== RUN   TestExecinPassExtraFiles
--- PASS: TestExecinPassExtraFiles (0.13s)
=== RUN   TestExecInOomScoreAdj
--- PASS: TestExecInOomScoreAdj (0.14s)
=== RUN   TestExecInUserns
--- PASS: TestExecInUserns (0.15s)
=== RUN   TestSeccompDenyGetcwd
--- PASS: TestSeccompDenyGetcwd (0.13s)
=== RUN   TestSeccompPermitWriteConditional
--- PASS: TestSeccompPermitWriteConditional (0.11s)
=== RUN   TestSeccompDenyWriteConditional
--- PASS: TestSeccompDenyWriteConditional (0.10s)
=== RUN   TestSeccompPermitWriteMultipleConditions
--- PASS: TestSeccompPermitWriteMultipleConditions (0.11s)
=== RUN   TestSeccompDenyWriteMultipleConditions
--- PASS: TestSeccompDenyWriteMultipleConditions (0.12s)
=== RUN   TestSeccompMultipleConditionSameArgDeniesStdout
--- PASS: TestSeccompMultipleConditionSameArgDeniesStdout (0.10s)
=== RUN   TestSeccompMultipleConditionSameArgDeniesStderr
--- PASS: TestSeccompMultipleConditionSameArgDeniesStderr (0.10s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/integration	6.841s
=== RUN   TestIntelRdtSetL3CacheSchema
--- PASS: TestIntelRdtSetL3CacheSchema (0.00s)
=== RUN   TestIntelRdtSetMemBwSchema
--- PASS: TestIntelRdtSetMemBwSchema (0.00s)
=== RUN   TestIntelRdtSetMemBwScSchema
--- PASS: TestIntelRdtSetMemBwScSchema (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/intelrdt	0.003s
?   	github.com/nestybox/sysbox-runc/libcontainer/keys	[no test files]
?   	github.com/nestybox/sysbox-runc/libcontainer/mount	[no test files]
=== RUN   TestNsenterValidPaths
--- PASS: TestNsenterValidPaths (0.04s)
=== RUN   TestNsenterInvalidPaths
--- PASS: TestNsenterInvalidPaths (0.02s)
=== RUN   TestNsenterIncorrectPathType
--- PASS: TestNsenterIncorrectPathType (0.02s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/nsenter	0.089s
=== RUN   TestParseStatusFile
--- PASS: TestParseStatusFile (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/seccomp	0.008s
=== RUN   TestCreateCommandHookTimeout
--- PASS: TestCreateCommandHookTimeout (0.00s)
=== RUN   TestCreateHooks
--- PASS: TestCreateHooks (0.00s)
=== RUN   TestSetupSeccomp
--- PASS: TestSetupSeccomp (0.00s)
=== RUN   TestLinuxCgroupWithMemoryResource
--- PASS: TestLinuxCgroupWithMemoryResource (0.00s)
=== RUN   TestLinuxCgroupSystemd
--- PASS: TestLinuxCgroupSystemd (0.00s)
=== RUN   TestLinuxCgroupSystemdWithEmptyPath
--- PASS: TestLinuxCgroupSystemdWithEmptyPath (0.00s)
=== RUN   TestLinuxCgroupSystemdWithInvalidPath
--- PASS: TestLinuxCgroupSystemdWithInvalidPath (0.00s)
=== RUN   TestLinuxCgroupsPathSpecified
--- PASS: TestLinuxCgroupsPathSpecified (0.00s)
=== RUN   TestLinuxCgroupsPathNotSpecified
--- PASS: TestLinuxCgroupsPathNotSpecified (0.00s)
=== RUN   TestSpecconvExampleValidate
--- PASS: TestSpecconvExampleValidate (0.00s)
=== RUN   TestDupNamespaces
--- PASS: TestDupNamespaces (0.00s)
=== RUN   TestNonZeroEUIDCompatibleSpecconvValidate
--- PASS: TestNonZeroEUIDCompatibleSpecconvValidate (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/specconv	0.005s
=== RUN   TestCaptureTestFunc
--- PASS: TestCaptureTestFunc (0.00s)
=== RUN   TestParsePackageName
--- PASS: TestParsePackageName (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/stacktrace	0.006s
=== RUN   TestUIDMapInUserNS
--- PASS: TestUIDMapInUserNS (0.00s)
=== RUN   TestParseStartTime
--- PASS: TestParseStartTime (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/system	0.005s
=== RUN   TestUserParseLine
--- PASS: TestUserParseLine (0.00s)
=== RUN   TestUserParsePasswd
--- PASS: TestUserParsePasswd (0.00s)
=== RUN   TestUserParseGroup
--- PASS: TestUserParseGroup (0.00s)
=== RUN   TestValidGetExecUser
--- PASS: TestValidGetExecUser (0.00s)
=== RUN   TestInvalidGetExecUser
--- PASS: TestInvalidGetExecUser (0.00s)
=== RUN   TestGetExecUserNilSources
--- PASS: TestGetExecUserNilSources (0.00s)
=== RUN   TestGetAdditionalGroups
--- PASS: TestGetAdditionalGroups (0.00s)
=== RUN   TestGetAdditionalGroupsNumeric
--- PASS: TestGetAdditionalGroupsNumeric (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/user	0.007s
=== RUN   TestSearchLabels
--- PASS: TestSearchLabels (0.00s)
=== RUN   TestResolveRootfs
--- PASS: TestResolveRootfs (0.00s)
=== RUN   TestResolveRootfsWithSymlink
--- PASS: TestResolveRootfsWithSymlink (0.00s)
=== RUN   TestResolveRootfsWithNonExistingDir
--- PASS: TestResolveRootfsWithNonExistingDir (0.00s)
=== RUN   TestExitStatus
--- PASS: TestExitStatus (0.00s)
=== RUN   TestExitStatusSignaled
--- PASS: TestExitStatusSignaled (0.00s)
=== RUN   TestWriteJSON
--- PASS: TestWriteJSON (0.00s)
=== RUN   TestCleanPath
--- PASS: TestCleanPath (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/utils	0.003s
?   	github.com/nestybox/sysbox-runc/libsysbox/shiftfs	[no test files]
?   	github.com/nestybox/sysbox-runc/libsysbox/sysbox	[no test files]
=== RUN   TestCfgSeccomp
--- PASS: TestCfgSeccomp (0.00s)
=== RUN   TestCfgLibModMount
--- PASS: TestCfgLibModMount (0.00s)
=== RUN   TestCfgMaskedPaths
--- PASS: TestCfgMaskedPaths (0.00s)
=== RUN   TestCfgReadonlyPaths
--- PASS: TestCfgReadonlyPaths (0.00s)
=== RUN   TestCfgSysboxFsMounts
--- PASS: TestCfgSysboxFsMounts (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libsysbox/syscont	0.009s
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localintegration TESTPATH=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
bats -t tests/integration
1..101
ok 1 runc update --kernel-memory (initialized)
ok 2 runc update --kernel-memory (uninitialized)
ok 3 runc create (no limits + no cgrouppath + no permission) succeeds
ok 4 # skip (test requires rootless) runc create (rootless + no limits + cgrouppath + no permission) fails with permission error
ok 5 # skip (test requires rootless) runc create (rootless + limits + no cgrouppath + no permission) fails with informative error
ok 6 runc create (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 7 runc exec (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 8 # skip (sysbox-runc unsupported feature) checkpoint and restore
ok 9 # skip (sysbox-runc unsupported feature) checkpoint --pre-dump and restore
ok 10 # skip (sysbox-runc unsupported feature) checkpoint --lazy-pages and restore
ok 11 # skip (sysbox-runc unsupported feature) checkpoint and restore in external network namespace
ok 12 # skip (sysbox-runc unsupported feature) checkpoint and restore with container specific CRIU config
ok 13 runc create
ok 14 runc create exec
ok 15 runc create --pid-file
ok 16 runc create --pid-file with new CWD
ok 17 global --debug
ok 18 global --debug to --log
ok 19 global --debug to --log --log-format 'text'
ok 20 global --debug to --log --log-format 'json'
ok 21 runc delete
ok 22 runc delete --force
ok 23 runc delete --force ignore not exist
ok 24 events --stats
ok 25 events --interval default
ok 26 events --interval 1s
ok 27 events --interval 100ms
ok 28 runc exec
ok 29 runc exec --pid-file
ok 30 runc exec --pid-file with new CWD
ok 31 runc exec ls -la
ok 32 runc exec ls -la with --cwd
ok 33 runc exec --env
ok 34 runc exec --user
ok 35 runc exec --additional-gids
ok 36 runc exec --preserve-fds
ok 37 runc -h
ok 38 runc command -h
ok 39 runc foo -h
ok 40 kill detached busybox
ok 41 list
ok 42 mask paths [file]
ok 43 mask paths [directory]
ok 44 bind mount
ok 45 bind mount above rootfs
ok 46 bind mount directly above rootfs
ok 47 bind mount below the rootfs
ok 48 rootfs on tmpfs
ok 49 bind mount on tmpfs
ok 50 runc pause and resume
ok 51 runc pause and resume with nonexist container
ok 52 ps
ok 53 ps -f json
ok 54 ps -e
ok 55 global --root
ok 56 spec generation cwd
ok 57 spec generation --bundle
ok 58 # skip (needs re-work due to migration to go-modules) spec validator
ok 59 # skip (not written yet) spec process validator
ok 60 # skip (not written yet) spec read-only path filtering
ok 61 # skip (not written yet) spec masked path filtering
ok 62 runc start
ok 63 runc run detached
ok 64 runc run detached ({u,g}id != 0)
ok 65 runc run detached --pid-file
ok 66 runc run detached --pid-file with new CWD
ok 67 runc run
ok 68 runc run ({u,g}id != 0)
ok 69 runc run with rootfs set to .
ok 70 runc run --pid-file
ok 71 state (kill + delete)
ok 72 state (pause + resume)
ok 73 syscont: root process caps
ok 74 syscont: exec root process caps
ok 75 syscont: exec non-root process caps
ok 76 syscont: exec non-root process caps
ok 77 syscont: cgroup mounts
ok 78 syscont: cgroup create
ok 79 # skip (wait until sysbox implements intercept of mount syscall) syscont: inner container procfs
ok 80 syscont: /lib/modules/<kernel-release> mount
ok 81 # skip (not written yet) syscont: disallowed mounts
ok 82 # skip (not written yet) syscont: sysbox-fs mounts
ok 83 # skip (wait until sysbox implements intercept of mount syscall) syscont: sysbox-fs can't be unmounted
ok 84 # skip (wait until sysbox implements intercept of umount syscall) syscont: procfs remount
ok 85 syscont: uses all namespaces
ok 86 syscont: unshare
ok 87 syscont: syscall: mount and umount
ok 88 syscont uid/gid mappings
ok 89 runc run [tty ptsname]
ok 90 runc run [tty owner]
ok 91 runc run [tty owner] ({u,g}id != 0)
ok 92 runc exec [tty ptsname]
ok 93 runc exec [tty owner]
ok 94 runc exec [tty owner] ({u,g}id != 0)
ok 95 runc exec [tty consolesize]
ok 96 runc create [terminal=false]
ok 97 runc run [terminal=false]
ok 98 runc run -d [terminal=false]
ok 99 update
ok 100 # skip (Test requires cgroups_rt) update rt period and runtime
ok 101 # skip (fails when git change is pending) runc version
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localintegration-shiftuid TESTPATH=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
SHIFT_UIDS=true bats -t tests/integration
1..101
ok 1 runc update --kernel-memory (initialized)
ok 2 runc update --kernel-memory (uninitialized)
ok 3 runc create (no limits + no cgrouppath + no permission) succeeds
ok 4 # skip (test requires rootless) runc create (rootless + no limits + cgrouppath + no permission) fails with permission error
ok 5 # skip (test requires rootless) runc create (rootless + limits + no cgrouppath + no permission) fails with informative error
ok 6 runc create (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 7 runc exec (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 8 # skip (sysbox-runc unsupported feature) checkpoint and restore
ok 9 # skip (sysbox-runc unsupported feature) checkpoint --pre-dump and restore
ok 10 # skip (sysbox-runc unsupported feature) checkpoint --lazy-pages and restore
ok 11 # skip (sysbox-runc unsupported feature) checkpoint and restore in external network namespace
ok 12 # skip (sysbox-runc unsupported feature) checkpoint and restore with container specific CRIU config
ok 13 runc create
ok 14 runc create exec
ok 15 runc create --pid-file
ok 16 runc create --pid-file with new CWD
ok 17 global --debug
ok 18 global --debug to --log
ok 19 global --debug to --log --log-format 'text'
ok 20 global --debug to --log --log-format 'json'
ok 21 runc delete
ok 22 runc delete --force
ok 23 runc delete --force ignore not exist
ok 24 events --stats
ok 25 events --interval default
ok 26 events --interval 1s
ok 27 events --interval 100ms
ok 28 runc exec
ok 29 runc exec --pid-file
ok 30 runc exec --pid-file with new CWD
ok 31 runc exec ls -la
ok 32 runc exec ls -la with --cwd
ok 33 runc exec --env
ok 34 runc exec --user
ok 35 runc exec --additional-gids
ok 36 runc exec --preserve-fds
ok 37 runc -h
ok 38 runc command -h
ok 39 runc foo -h
ok 40 kill detached busybox
ok 41 list
ok 42 mask paths [file]
ok 43 mask paths [directory]
ok 44 bind mount
ok 45 bind mount above rootfs
ok 46 bind mount directly above rootfs
ok 47 bind mount below the rootfs
ok 48 rootfs on tmpfs
ok 49 bind mount on tmpfs
ok 50 runc pause and resume
ok 51 runc pause and resume with nonexist container
ok 52 ps
ok 53 ps -f json
ok 54 ps -e
ok 55 global --root
ok 56 spec generation cwd
ok 57 spec generation --bundle
ok 58 # skip (needs re-work due to migration to go-modules) spec validator
ok 59 # skip (not written yet) spec process validator
ok 60 # skip (not written yet) spec read-only path filtering
ok 61 # skip (not written yet) spec masked path filtering
ok 62 runc start
ok 63 runc run detached
ok 64 runc run detached ({u,g}id != 0)
ok 65 runc run detached --pid-file
ok 66 runc run detached --pid-file with new CWD
ok 67 runc run
ok 68 runc run ({u,g}id != 0)
ok 69 runc run with rootfs set to .
ok 70 runc run --pid-file
ok 71 state (kill + delete)
ok 72 state (pause + resume)
ok 73 syscont: root process caps
ok 74 syscont: exec root process caps
ok 75 syscont: exec non-root process caps
ok 76 syscont: exec non-root process caps
ok 77 syscont: cgroup mounts
ok 78 syscont: cgroup create
ok 79 # skip (wait until sysbox implements intercept of mount syscall) syscont: inner container procfs
ok 80 syscont: /lib/modules/<kernel-release> mount
ok 81 # skip (not written yet) syscont: disallowed mounts
ok 82 # skip (not written yet) syscont: sysbox-fs mounts
ok 83 # skip (wait until sysbox implements intercept of mount syscall) syscont: sysbox-fs can't be unmounted
ok 84 # skip (wait until sysbox implements intercept of umount syscall) syscont: procfs remount
ok 85 syscont: uses all namespaces
ok 86 syscont: unshare
ok 87 syscont: syscall: mount and umount
ok 88 syscont uid/gid mappings
ok 89 runc run [tty ptsname]
ok 90 runc run [tty owner]
ok 91 runc run [tty owner] ({u,g}id != 0)
ok 92 runc exec [tty ptsname]
ok 93 runc exec [tty owner]
ok 94 runc exec [tty owner] ({u,g}id != 0)
ok 95 runc exec [tty consolesize]
ok 96 runc create [terminal=false]
ok 97 runc run [terminal=false]
ok 98 runc run -d [terminal=false]
ok 99 update
ok 100 # skip (Test requires cgroups_rt) update rt period and runtime
ok 101 # skip (fails when git change is pending) runc version
make[2]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'

** Running sysbox integration tests **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "testContainerInit && make test-sysbox-local TESTPATH="
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'sysbox-runc' is up to date.
make[1]: 'sysbox-fs' is up to date.
make[1]: 'sysbox-mgr' is up to date.
install -D -m0755 sysbox-fs/sysbox-fs /usr/local/sbin/sysbox-fs
install -D -m0755 sysbox-mgr/sysbox-mgr /usr/local/sbin/sysbox-mgr
install -D -m0755 sysbox-runc/sysbox-runc /usr/local/sbin/sysbox-runc
install -D -m0755 bin/sysbox /usr/local/sbin/sysbox
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 # skip (uid shifting disabled) uid alloc basic
ok 8 # skip (uid shifting disabled) uid exhaust
ok 9 # skip (uid shifting disabled) uid reuse
ok 10 # skip (needs UID shifting) shiftfsMgr basic
ok 11 # skip (needs UID shifting) shiftfsMgr multiple syscont
ok 12 # skip (needs UID shifting) shiftfsMgr skip shiftfs on bind-mount
ok 13 # skip (needs UID shifting) shiftfsMgr shiftfs file mount
ok 14 # skip (needs UID shifting) shiftfsMgr shiftfs no-exec on host
ok 15 # skip (needs UID shifting) shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic

** Running sysbox integration tests (with uid shifting) **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "export SHIFT_UIDS=true && testContainerInit && make test-sysbox-local TESTPATH="
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'sysbox-runc' is up to date.
make[1]: 'sysbox-fs' is up to date.
make[1]: 'sysbox-mgr' is up to date.
install -D -m0755 sysbox-fs/sysbox-fs /usr/local/sbin/sysbox-fs
install -D -m0755 sysbox-mgr/sysbox-mgr /usr/local/sbin/sysbox-mgr
install -D -m0755 sysbox-runc/sysbox-runc /usr/local/sbin/sysbox-runc
install -D -m0755 bin/sysbox /usr/local/sbin/sysbox
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 uid alloc basic
ok 8 uid exhaust
ok 9 uid reuse
ok 10 shiftfsMgr basic
ok 11 shiftfsMgr multiple syscont
ok 12 shiftfsMgr skip shiftfs on bind-mount
ok 13 shiftfsMgr shiftfs file mount
ok 14 shiftfsMgr shiftfs no-exec on host
ok 15 shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
vagrant@ubuntu-bionic-vm:~/wsp/v0.1.3/sysbox$

vagrant@ubuntu-bionic-vm:~/wsp/v0.1.3/sysbox$ make test-installer
make test-cntr-installer
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:bionic
 ---> ccc6e87d482b
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> 7e91a1c37b0d
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> ab7ddfc7d816
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> cb8638b35ab0
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> b40f5288036d
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> a4ae05e7e436
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 150360aed46c
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> f918722fa094
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> 1cdeef575cfe
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> 8f33c200fc07
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 84d80bbb5138
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> 1d541c366841
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         $(lsb_release -cs)         stable"
 ---> Using cache
 ---> ded4261f07ac
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> f5d72bccc7a4
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> a01a9f956720
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> dadac65d4758
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> 5ec714c89319
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> d65dadaccc3d
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> a9151907b73a
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> 6473eb1a2ac7
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> d1652d728076
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> f09d621e6778
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> ea586e0d26fe
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> b0911e349745
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> 615055a75b8d
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> cbca9bd910ea
Successfully built cbca9bd910ea
Successfully tagged sysbox-test:latest

** Building the test-installer container image**

Sending build context to Docker daemon  240.6kB
Step 1/5 : FROM sysbox-test:latest
 ---> cbca9bd910ea
Step 2/5 : RUN apt-get update &&                                apt-get install -y --no-install-recommends               systemd                                          systemd-sysv                                     libsystemd0                                      ca-certificates                                  dbus                                             iptables                                         iproute2                                         kmod                                             locales                                          sudo                                             udev &&                                                                                   echo "ReadKMsg=no" >> /etc/systemd/journald.conf &&                                                                                         systemctl mask getty@tty1.service getty-static.service &&                                                                                   apt-get clean -y &&                                                   rm -rf                                                                   /var/cache/debconf/*                                                  /var/lib/apt/lists/*                                                  /var/log/*                                                            /tmp/*                                                                /var/tmp/*                                                            /usr/share/doc/*                                                      /usr/share/man/*                                                      /usr/share/local/* &&                                                                                                                    useradd --create-home --shell /bin/bash admin && echo "admin:admin" |         chpasswd && adduser admin sudo
 ---> Using cache
 ---> 238379db5c27
Step 3/5 : STOPSIGNAL SIGRTMIN+3
 ---> Using cache
 ---> 16739503deb5
Step 4/5 : ENV container docker
 ---> Using cache
 ---> bc2afa1b11f4
Step 5/5 : ENTRYPOINT [ "/sbin/init" ]
 ---> Using cache
 ---> 5115cfff9684
Successfully built 5115cfff9684
Successfully tagged sysbox-installer-test:latest
docker run -d --rm --privileged --hostname sysbox-installer-test --name sysbox-installer-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod --mount type=tmpfs,destination=/run --mount type=tmpfs,destination=/run/lock --mount type=tmpfs,destination=/tmp sysbox-installer-test
90b9ca91622ed9fe4ad1330b920afe74fc20aba17af8f189322282d49898cb3f

** Installing sysbox deb package **

docker exec -it sysbox-installer-test /bin/bash -c "rm -rf /usr/sbin/policy-rc.d && \
	DEBIAN_FRONTEND=noninteractive dpkg -i image/deb/debbuild/ubuntu-bionic/sysbox_0.1.3-0.ubuntu-bionic_amd64.deb"
Selecting previously unselected package sysbox.
(Reading database ... 17743 files and directories currently installed.)
Preparing to unpack .../sysbox_0.1.3-0.ubuntu-bionic_amd64.deb ...
Unpacking sysbox (0.1.3-0.ubuntu-bionic) ...
Setting up sysbox (0.1.3-0.ubuntu-bionic) ...
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-fs.service → /lib/systemd/system/sysbox-fs.service.
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-mgr.service → /lib/systemd/system/sysbox-mgr.service.
Created symlink /etc/systemd/system/multi-user.target.wants/sysbox.service → /lib/systemd/system/sysbox.service.
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"default-runtime\": \"sysbox-runc\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Running sysbox integration tests **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker exec -it sysbox-installer-test make sysbox-runc-recvtty
make[1]: Entering directory '/root/nestybox/sysbox/sysbox-runc'
go build -buildmode=pie  -ldflags "-X main.gitCommit="6faf2581e728e442afa244508cbbed64bccaaadb" -X main.version=0.1.3 " -tags "seccomp" -o contrib/cmd/recvtty/recvtty ./contrib/cmd/recvtty
make[1]: Leaving directory '/root/nestybox/sysbox/sysbox-runc'
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"userns-remap\": \"sysbox\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
docker exec -it sysbox-installer-test /bin/bash -c "export SB_INSTALLER=true && \
	make test-sysbox-local TESTPATH="
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 # skip (uid shifting disabled) uid alloc basic
ok 8 # skip (uid shifting disabled) uid exhaust
ok 9 # skip (uid shifting disabled) uid reuse
ok 10 # skip (needs UID shifting) shiftfsMgr basic
ok 11 # skip (needs UID shifting) shiftfsMgr multiple syscont
ok 12 # skip (needs UID shifting) shiftfsMgr skip shiftfs on bind-mount
ok 13 # skip (needs UID shifting) shiftfsMgr shiftfs file mount
ok 14 # skip (needs UID shifting) shiftfsMgr shiftfs no-exec on host
ok 15 # skip (needs UID shifting) shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
docker stop sysbox-installer-test
sysbox-installer-test
make test-cntr-installer
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:bionic
 ---> ccc6e87d482b
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> 7e91a1c37b0d
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> ab7ddfc7d816
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> cb8638b35ab0
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> b40f5288036d
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> a4ae05e7e436
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 150360aed46c
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> f918722fa094
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> 1cdeef575cfe
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> 8f33c200fc07
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 84d80bbb5138
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> 1d541c366841
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         $(lsb_release -cs)         stable"
 ---> Using cache
 ---> ded4261f07ac
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> f5d72bccc7a4
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> a01a9f956720
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> dadac65d4758
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> 5ec714c89319
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> d65dadaccc3d
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> a9151907b73a
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> 6473eb1a2ac7
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> d1652d728076
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> f09d621e6778
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> ea586e0d26fe
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> b0911e349745
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> 615055a75b8d
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> cbca9bd910ea
Successfully built cbca9bd910ea
Successfully tagged sysbox-test:latest

** Building the test-installer container image**

Sending build context to Docker daemon  240.6kB
Step 1/5 : FROM sysbox-test:latest
 ---> cbca9bd910ea
Step 2/5 : RUN apt-get update &&                                apt-get install -y --no-install-recommends               systemd                                          systemd-sysv                                     libsystemd0                                      ca-certificates                                  dbus                                             iptables                                         iproute2                                         kmod                                             locales                                          sudo                                             udev &&                                                                                   echo "ReadKMsg=no" >> /etc/systemd/journald.conf &&                                                                                         systemctl mask getty@tty1.service getty-static.service &&                                                                                   apt-get clean -y &&                                                   rm -rf                                                                   /var/cache/debconf/*                                                  /var/lib/apt/lists/*                                                  /var/log/*                                                            /tmp/*                                                                /var/tmp/*                                                            /usr/share/doc/*                                                      /usr/share/man/*                                                      /usr/share/local/* &&                                                                                                                    useradd --create-home --shell /bin/bash admin && echo "admin:admin" |         chpasswd && adduser admin sudo
 ---> Using cache
 ---> 238379db5c27
Step 3/5 : STOPSIGNAL SIGRTMIN+3
 ---> Using cache
 ---> 16739503deb5
Step 4/5 : ENV container docker
 ---> Using cache
 ---> bc2afa1b11f4
Step 5/5 : ENTRYPOINT [ "/sbin/init" ]
 ---> Using cache
 ---> 5115cfff9684
Successfully built 5115cfff9684
Successfully tagged sysbox-installer-test:latest
docker run -d --rm --privileged --hostname sysbox-installer-test --name sysbox-installer-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod --mount type=tmpfs,destination=/run --mount type=tmpfs,destination=/run/lock --mount type=tmpfs,destination=/tmp sysbox-installer-test
8ab7c3f484be4f2de0582e72990c488f6cb80312ef0bc576908554cf3d184f71

** Installing sysbox deb package **

docker exec -it sysbox-installer-test /bin/bash -c "rm -rf /usr/sbin/policy-rc.d && \
	DEBIAN_FRONTEND=noninteractive dpkg -i image/deb/debbuild/ubuntu-bionic/sysbox_0.1.3-0.ubuntu-bionic_amd64.deb"
Selecting previously unselected package sysbox.
(Reading database ... 17743 files and directories currently installed.)
Preparing to unpack .../sysbox_0.1.3-0.ubuntu-bionic_amd64.deb ...
Unpacking sysbox (0.1.3-0.ubuntu-bionic) ...
Setting up sysbox (0.1.3-0.ubuntu-bionic) ...
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-fs.service → /lib/systemd/system/sysbox-fs.service.
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-mgr.service → /lib/systemd/system/sysbox-mgr.service.
Created symlink /etc/systemd/system/multi-user.target.wants/sysbox.service → /lib/systemd/system/sysbox.service.
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"default-runtime\": \"sysbox-runc\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Running sysbox-installer integration tests (with uid shifting) **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker exec -it sysbox-installer-test make sysbox-runc-recvtty
make[1]: Entering directory '/root/nestybox/sysbox/sysbox-runc'
make[1]: Nothing to be done for 'recvtty'.
make[1]: Leaving directory '/root/nestybox/sysbox/sysbox-runc'
docker exec -it sysbox-installer-test /bin/bash -c "export SB_INSTALLER=true SHIFT_UIDS=true && \
	make test-sysbox-local TESTPATH="
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 uid alloc basic
ok 8 uid exhaust
ok 9 uid reuse
ok 10 shiftfsMgr basic
ok 11 shiftfsMgr multiple syscont
ok 12 shiftfsMgr skip shiftfs on bind-mount
ok 13 shiftfsMgr shiftfs file mount
ok 14 shiftfsMgr shiftfs no-exec on host
ok 15 shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
docker stop sysbox-installer-test
sysbox-installer-test
vagrant@ubuntu-bionic-vm:~/wsp/v0.1.3/sysbox$
```


# Ubuntu Cosmic VM (uncompleted due to known not-sysbox-related issue)



```
vagrant@ubuntu-cosmic-vm:~/wsp/v0.1.3/sysbox$ make test

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:cosmic
 ---> 9dc19675e327
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> aae67b2eda82
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> 5dd8b58e48b2
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> eefffced289e
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> e2bbe1a4b413
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> a1faf9430853
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 49b1fc71c88d
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 266353fb54c2
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> f1ea925465f3
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> 65e78e90e29c
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 45c5f623b1fb
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> 4e9f7f75ec55
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         $(lsb_release -cs)         stable"
 ---> Using cache
 ---> 3fa93e83d821
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Running in 97da0e1c561d
Hit:1 http://security.ubuntu.com/ubuntu cosmic-security InRelease
Hit:2 http://archive.ubuntu.com/ubuntu cosmic InRelease
Hit:3 http://archive.ubuntu.com/ubuntu cosmic-updates InRelease
Hit:4 http://archive.ubuntu.com/ubuntu cosmic-backports InRelease
Hit:5 https://download.docker.com/linux/ubuntu cosmic InRelease
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  apparmor aufs-tools busybox-initramfs cgroupfs-mount cpio dmsetup
  gettext-base grub-common grub-gfxpayload-lists grub-pc grub-pc-bin
  grub2-common initramfs-tools initramfs-tools-bin initramfs-tools-core
  klibc-utils libdevmapper1.02.1 libfreetype6 libfuse2 libklibc libltdl7
  libpng16-16 linux-base linux-image-unsigned-5.0.0-1010-oem-osp1
  linux-modules-5.0.0-1010-oem-osp1 os-prober pigz udev
Suggested packages:
  apparmor-profiles-extra apparmor-utils libarchive1 multiboot-doc grub-emu
  xorriso desktop-base console-setup bash-completion fuse fdutils
  linux-oem-osp1-tools linux-headers-5.0.0-1010-oem-osp1
The following NEW packages will be installed:
  apparmor aufs-tools busybox-initramfs cgroupfs-mount containerd.io cpio
  dmsetup docker-ce docker-ce-cli gettext-base grub-common
  grub-gfxpayload-lists grub-pc grub-pc-bin grub2-common initramfs-tools
  initramfs-tools-bin initramfs-tools-core klibc-utils libdevmapper1.02.1
  libfreetype6 libfuse2 libklibc libltdl7 libpng16-16 linux-base
  linux-image-unsigned-5.0.0-1010-oem-osp1 linux-modules-5.0.0-1010-oem-osp1
  os-prober pigz udev
0 upgraded, 31 newly installed, 0 to remove and 0 not upgraded.
Need to get 150 MB of archives.
After this operation, 675 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu cosmic/universe amd64 pigz amd64 2.4-1 [57.4 kB]
Get:2 https://download.docker.com/linux/ubuntu cosmic/stable amd64 containerd.io amd64 1.2.6-3 [22.6 MB]
Get:3 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 busybox-initramfs amd64 1:1.27.2-2ubuntu4.1 [165 kB]
Get:4 http://archive.ubuntu.com/ubuntu cosmic/main amd64 cpio amd64 2.12+dfsg-6 [85.9 kB]
Get:5 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 libdevmapper1.02.1 amd64 2:1.02.145-4.1ubuntu3.18.10.1 [127 kB]
Get:6 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 dmsetup amd64 2:1.02.145-4.1ubuntu3.18.10.1 [74.5 kB]
Get:7 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 initramfs-tools-bin amd64 0.131ubuntu15.2 [10.3 kB]
Get:8 http://archive.ubuntu.com/ubuntu cosmic/main amd64 libklibc amd64 2.0.4-9ubuntu2 [41.5 kB]
Get:9 http://archive.ubuntu.com/ubuntu cosmic/main amd64 klibc-utils amd64 2.0.4-9ubuntu2 [110 kB]
Get:10 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 udev amd64 239-7ubuntu10.14 [1130 kB]
Get:11 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 initramfs-tools-core all 0.131ubuntu15.2 [45.8 kB]
Get:12 http://archive.ubuntu.com/ubuntu cosmic/main amd64 linux-base all 4.5ubuntu1 [18.1 kB]
Get:13 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 initramfs-tools all 0.131ubuntu15.2 [9676 B]
Get:14 http://archive.ubuntu.com/ubuntu cosmic/main amd64 apparmor amd64 2.12-4ubuntu8 [486 kB]
Get:15 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 gettext-base amd64 0.19.8.1-8ubuntu0.1 [50.2 kB]
Get:16 http://archive.ubuntu.com/ubuntu cosmic/main amd64 libfuse2 amd64 2.9.8-1ubuntu1 [81.6 kB]
Get:17 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 libpng16-16 amd64 1.6.34-2ubuntu0.1 [176 kB]
Get:18 http://archive.ubuntu.com/ubuntu cosmic/universe amd64 aufs-tools amd64 1:4.9+20170918-2 [104 kB]
Get:19 http://archive.ubuntu.com/ubuntu cosmic/universe amd64 cgroupfs-mount all 1.4 [6320 B]
Get:20 http://archive.ubuntu.com/ubuntu cosmic/main amd64 libfreetype6 amd64 2.8.1-2ubuntu2 [335 kB]
Get:21 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 grub-common amd64 2.02+dfsg1-5ubuntu8.3 [1782 kB]
Get:22 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 grub2-common amd64 2.02+dfsg1-5ubuntu8.3 [539 kB]
Get:23 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 grub-pc-bin amd64 2.02+dfsg1-5ubuntu8.3 [905 kB]
Get:24 https://download.docker.com/linux/ubuntu cosmic/stable amd64 docker-ce-cli amd64 5:19.03.5~3-0~ubuntu-cosmic [42.5 MB]
Get:25 http://archive.ubuntu.com/ubuntu cosmic-updates/main amd64 grub-pc amd64 2.02+dfsg1-5ubuntu8.3 [138 kB]
Get:26 http://archive.ubuntu.com/ubuntu cosmic/main amd64 grub-gfxpayload-lists amd64 0.7 [3658 B]
Get:27 http://archive.ubuntu.com/ubuntu cosmic/main amd64 libltdl7 amd64 2.4.6-4 [38.7 kB]
Get:28 http://archive.ubuntu.com/ubuntu cosmic-updates/universe amd64 linux-modules-5.0.0-1010-oem-osp1 amd64 5.0.0-1010.11 [46.9 MB]
Get:29 http://archive.ubuntu.com/ubuntu cosmic-updates/universe amd64 linux-image-unsigned-5.0.0-1010-oem-osp1 amd64 5.0.0-1010.11 [8390 kB]
Get:30 http://archive.ubuntu.com/ubuntu cosmic/main amd64 os-prober amd64 1.74ubuntu1 [19.8 kB]
Get:31 https://download.docker.com/linux/ubuntu cosmic/stable amd64 docker-ce amd64 5:19.03.5~3-0~ubuntu-cosmic [22.8 MB]
debconf: delaying package configuration, since apt-utils is not installed
Fetched 150 MB in 16s (9547 kB/s)
Selecting previously unselected package pigz.
(Reading database ... 14901 files and directories currently installed.)
Preparing to unpack .../00-pigz_2.4-1_amd64.deb ...
Unpacking pigz (2.4-1) ...
Selecting previously unselected package busybox-initramfs.
Preparing to unpack .../01-busybox-initramfs_1%3a1.27.2-2ubuntu4.1_amd64.deb ...
Unpacking busybox-initramfs (1:1.27.2-2ubuntu4.1) ...
Selecting previously unselected package cpio.
Preparing to unpack .../02-cpio_2.12+dfsg-6_amd64.deb ...
Unpacking cpio (2.12+dfsg-6) ...
Selecting previously unselected package libdevmapper1.02.1:amd64.
Preparing to unpack .../03-libdevmapper1.02.1_2%3a1.02.145-4.1ubuntu3.18.10.1_amd64.deb ...
Unpacking libdevmapper1.02.1:amd64 (2:1.02.145-4.1ubuntu3.18.10.1) ...
Selecting previously unselected package dmsetup.
Preparing to unpack .../04-dmsetup_2%3a1.02.145-4.1ubuntu3.18.10.1_amd64.deb ...
Unpacking dmsetup (2:1.02.145-4.1ubuntu3.18.10.1) ...
Selecting previously unselected package initramfs-tools-bin.
Preparing to unpack .../05-initramfs-tools-bin_0.131ubuntu15.2_amd64.deb ...
Unpacking initramfs-tools-bin (0.131ubuntu15.2) ...
Selecting previously unselected package libklibc.
Preparing to unpack .../06-libklibc_2.0.4-9ubuntu2_amd64.deb ...
Unpacking libklibc (2.0.4-9ubuntu2) ...
Selecting previously unselected package klibc-utils.
Preparing to unpack .../07-klibc-utils_2.0.4-9ubuntu2_amd64.deb ...
Adding 'diversion of /usr/share/initramfs-tools/hooks/klibc to /usr/share/initramfs-tools/hooks/klibc^i-t by klibc-utils'
Unpacking klibc-utils (2.0.4-9ubuntu2) ...
Selecting previously unselected package udev.
Preparing to unpack .../08-udev_239-7ubuntu10.14_amd64.deb ...
Unpacking udev (239-7ubuntu10.14) ...
Selecting previously unselected package initramfs-tools-core.
Preparing to unpack .../09-initramfs-tools-core_0.131ubuntu15.2_all.deb ...
Unpacking initramfs-tools-core (0.131ubuntu15.2) ...
Selecting previously unselected package linux-base.
Preparing to unpack .../10-linux-base_4.5ubuntu1_all.deb ...
Unpacking linux-base (4.5ubuntu1) ...
Selecting previously unselected package initramfs-tools.
Preparing to unpack .../11-initramfs-tools_0.131ubuntu15.2_all.deb ...
Unpacking initramfs-tools (0.131ubuntu15.2) ...
Selecting previously unselected package apparmor.
Preparing to unpack .../12-apparmor_2.12-4ubuntu8_amd64.deb ...
Unpacking apparmor (2.12-4ubuntu8) ...
Selecting previously unselected package gettext-base.
Preparing to unpack .../13-gettext-base_0.19.8.1-8ubuntu0.1_amd64.deb ...
Unpacking gettext-base (0.19.8.1-8ubuntu0.1) ...
Selecting previously unselected package libfuse2:amd64.
Preparing to unpack .../14-libfuse2_2.9.8-1ubuntu1_amd64.deb ...
Unpacking libfuse2:amd64 (2.9.8-1ubuntu1) ...
Selecting previously unselected package libpng16-16:amd64.
Preparing to unpack .../15-libpng16-16_1.6.34-2ubuntu0.1_amd64.deb ...
Unpacking libpng16-16:amd64 (1.6.34-2ubuntu0.1) ...
Selecting previously unselected package aufs-tools.
Preparing to unpack .../16-aufs-tools_1%3a4.9+20170918-2_amd64.deb ...
Unpacking aufs-tools (1:4.9+20170918-2) ...
Selecting previously unselected package cgroupfs-mount.
Preparing to unpack .../17-cgroupfs-mount_1.4_all.deb ...
Unpacking cgroupfs-mount (1.4) ...
Selecting previously unselected package containerd.io.
Preparing to unpack .../18-containerd.io_1.2.6-3_amd64.deb ...
Unpacking containerd.io (1.2.6-3) ...
Selecting previously unselected package docker-ce-cli.
Preparing to unpack .../19-docker-ce-cli_5%3a19.03.5~3-0~ubuntu-cosmic_amd64.deb ...
Unpacking docker-ce-cli (5:19.03.5~3-0~ubuntu-cosmic) ...
Selecting previously unselected package docker-ce.
Preparing to unpack .../20-docker-ce_5%3a19.03.5~3-0~ubuntu-cosmic_amd64.deb ...
Unpacking docker-ce (5:19.03.5~3-0~ubuntu-cosmic) ...
Selecting previously unselected package libfreetype6:amd64.
Preparing to unpack .../21-libfreetype6_2.8.1-2ubuntu2_amd64.deb ...
Unpacking libfreetype6:amd64 (2.8.1-2ubuntu2) ...
Selecting previously unselected package grub-common.
Preparing to unpack .../22-grub-common_2.02+dfsg1-5ubuntu8.3_amd64.deb ...
Unpacking grub-common (2.02+dfsg1-5ubuntu8.3) ...
Selecting previously unselected package grub2-common.
Preparing to unpack .../23-grub2-common_2.02+dfsg1-5ubuntu8.3_amd64.deb ...
Unpacking grub2-common (2.02+dfsg1-5ubuntu8.3) ...
Selecting previously unselected package grub-pc-bin.
Preparing to unpack .../24-grub-pc-bin_2.02+dfsg1-5ubuntu8.3_amd64.deb ...
Unpacking grub-pc-bin (2.02+dfsg1-5ubuntu8.3) ...
Selecting previously unselected package grub-pc.
Preparing to unpack .../25-grub-pc_2.02+dfsg1-5ubuntu8.3_amd64.deb ...
Unpacking grub-pc (2.02+dfsg1-5ubuntu8.3) ...
Selecting previously unselected package grub-gfxpayload-lists.
Preparing to unpack .../26-grub-gfxpayload-lists_0.7_amd64.deb ...
Unpacking grub-gfxpayload-lists (0.7) ...
Selecting previously unselected package libltdl7:amd64.
Preparing to unpack .../27-libltdl7_2.4.6-4_amd64.deb ...
Unpacking libltdl7:amd64 (2.4.6-4) ...
Selecting previously unselected package linux-modules-5.0.0-1010-oem-osp1.
Preparing to unpack .../28-linux-modules-5.0.0-1010-oem-osp1_5.0.0-1010.11_amd64.deb ...
Unpacking linux-modules-5.0.0-1010-oem-osp1 (5.0.0-1010.11) ...
Selecting previously unselected package linux-image-unsigned-5.0.0-1010-oem-osp1.
Preparing to unpack .../29-linux-image-unsigned-5.0.0-1010-oem-osp1_5.0.0-1010.11_amd64.deb ...
Unpacking linux-image-unsigned-5.0.0-1010-oem-osp1 (5.0.0-1010.11) ...
Selecting previously unselected package os-prober.
Preparing to unpack .../30-os-prober_1.74ubuntu1_amd64.deb ...
Unpacking os-prober (1.74ubuntu1) ...
Setting up aufs-tools (1:4.9+20170918-2) ...
Setting up cpio (2.12+dfsg-6) ...
update-alternatives: using /bin/mt-gnu to provide /bin/mt (mt) in auto mode
update-alternatives: warning: skip creation of /usr/share/man/man1/mt.1.gz because associated file /usr/share/man/man1/mt-gnu.1.gz (of link group mt) doesn't exist
Setting up linux-modules-5.0.0-1010-oem-osp1 (5.0.0-1010.11) ...
Setting up containerd.io (1.2.6-3) ...
Setting up libpng16-16:amd64 (1.6.34-2ubuntu0.1) ...
Setting up libklibc (2.0.4-9ubuntu2) ...
Setting up libfuse2:amd64 (2.9.8-1ubuntu1) ...
Setting up linux-base (4.5ubuntu1) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
Setting up apparmor (2.12-4ubuntu8) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
Setting up gettext-base (0.19.8.1-8ubuntu0.1) ...
Setting up libdevmapper1.02.1:amd64 (2:1.02.145-4.1ubuntu3.18.10.1) ...
Setting up cgroupfs-mount (1.4) ...
invoke-rc.d: could not determine current runlevel
invoke-rc.d: policy-rc.d denied execution of start.
Setting up libfreetype6:amd64 (2.8.1-2ubuntu2) ...
Setting up busybox-initramfs (1:1.27.2-2ubuntu4.1) ...
Processing triggers for libc-bin (2.28-0ubuntu1) ...
Setting up udev (239-7ubuntu10.14) ...
invoke-rc.d: could not determine current runlevel
invoke-rc.d: policy-rc.d denied execution of start.
Setting up grub-common (2.02+dfsg1-5ubuntu8.3) ...
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
invoke-rc.d: could not determine current runlevel
invoke-rc.d: policy-rc.d denied execution of start.
Setting up libltdl7:amd64 (2.4.6-4) ...
Setting up dmsetup (2:1.02.145-4.1ubuntu3.18.10.1) ...
update-initramfs: deferring update (trigger activated)
Setting up initramfs-tools-bin (0.131ubuntu15.2) ...
Setting up docker-ce-cli (5:19.03.5~3-0~ubuntu-cosmic) ...
Setting up pigz (2.4-1) ...
Setting up linux-image-unsigned-5.0.0-1010-oem-osp1 (5.0.0-1010.11) ...
I: /vmlinuz.old is now a symlink to boot/vmlinuz-5.0.0-1010-oem-osp1
I: /initrd.img.old is now a symlink to boot/initrd.img-5.0.0-1010-oem-osp1
I: /vmlinuz is now a symlink to boot/vmlinuz-5.0.0-1010-oem-osp1
I: /initrd.img is now a symlink to boot/initrd.img-5.0.0-1010-oem-osp1
Setting up docker-ce (5:19.03.5~3-0~ubuntu-cosmic) ...
invoke-rc.d: could not determine current runlevel
invoke-rc.d: policy-rc.d denied execution of start.
Setting up klibc-utils (2.0.4-9ubuntu2) ...
Setting up grub-pc-bin (2.02+dfsg1-5ubuntu8.3) ...
Setting up initramfs-tools-core (0.131ubuntu15.2) ...
Setting up grub2-common (2.02+dfsg1-5ubuntu8.3) ...
Setting up os-prober (1.74ubuntu1) ...
Setting up initramfs-tools (0.131ubuntu15.2) ...
update-initramfs: deferring update (trigger activated)
Setting up grub-pc (2.02+dfsg1-5ubuntu8.3) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline

Creating config file /etc/default/grub with new version
grub-probe: error: failed to get canonical path of `overlay'.
grub-probe: error: failed to get canonical path of `overlay'.
grub-probe: error: failed to get canonical path of `overlay'.
Configuring grub-pc
-------------------

You chose not to install GRUB to any devices. If you continue, the boot loader
may not be properly configured, and when this computer next starts up it will
use whatever was previously in the boot sector. If there is an earlier version
of GRUB 2 in the boot sector, it may be unable to load modules or handle the
current configuration file.

If you are already using a different boot loader and want to carry on doing so,
or if this is a special environment where you do not need a boot loader, then
you should continue anyway. Otherwise, you should install GRUB somewhere.

Continue without installing GRUB? [yes/no] no

```


# Ubuntu Disco VM



```
vagrant@ubuntu-disco-vm:~/wsp/v0.1.3/sysbox$ make test

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:disco
 ---> c88ac1f841b7
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> ba92a41dfe11
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> b6e2c49a22d8
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> 7f90fef39941
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> c4da22cf8bb1
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> c353a26a4189
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 19d0857dd517
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 15657850fa8a
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> bca09701920e
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> 4e8c7d937a13
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 86b024beee71
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> b061c925699f
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         $(lsb_release -cs)         stable"
 ---> Using cache
 ---> c6d81ab840db
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> 3edf90ca0190
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> 062c81587a95
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> cbb384ed996a
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> d26d6c658be9
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> 79c985208b1b
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> 93b93af86890
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> 7cc2896b1a43
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> 2c75eb054275
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> 586bd75cb66e
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> 846742d75dae
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> 5a85a2fabe3e
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> b70fcd6bda5b
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> bf9e3a058d23
Successfully built bf9e3a058d23
Successfully tagged sysbox-test:latest

** Running sysbox-fs unit tests **

docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "make --no-print-directory test-fs-local"
make[1]: 'protobuf.pb.go' is up to date.
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
cd sysbox-fs && go test -timeout 3m -v github.com/nestybox/sysbox-fs/cmd/sysbox-fs github.com/nestybox/sysbox-fs/domain github.com/nestybox/sysbox-fs/fuse github.com/nestybox/sysbox-fs/handler github.com/nestybox/sysbox-fs/handler/implementations github.com/nestybox/sysbox-fs/ipc github.com/nestybox/sysbox-fs/mocks github.com/nestybox/sysbox-fs/nsenter github.com/nestybox/sysbox-fs/state github.com/nestybox/sysbox-fs/sysio
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
=== RUN   Test_signalHandler
--- PASS: Test_signalHandler (0.00s)
=== RUN   Test_main
--- PASS: Test_main (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/cmd/sysbox-fs	0.009s
?   	github.com/nestybox/sysbox-fs/domain	[no test files]
=== RUN   TestNewFuseService
=== RUN   TestNewFuseService/1
=== RUN   TestNewFuseService/2
--- PASS: TestNewFuseService (0.00s)
    --- PASS: TestNewFuseService/1 (0.00s)
    --- PASS: TestNewFuseService/2 (0.00s)
=== RUN   Test_fuseService_Run
--- SKIP: Test_fuseService_Run (0.00s)
    server_test.go:75: Skipping fuseService.Runc() for now
=== RUN   Test_fuseService_Root
--- PASS: Test_fuseService_Root (0.00s)
=== RUN   Test_fuseService_MountPoint
--- PASS: Test_fuseService_MountPoint (0.00s)
=== RUN   Test_fuseService_Unmount
--- PASS: Test_fuseService_Unmount (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/fuse	0.005s
?   	github.com/nestybox/sysbox-fs/handler	[no test files]
=== RUN   TestCommonHandler_Lookup
=== RUN   TestCommonHandler_Lookup/1
=== RUN   TestCommonHandler_Lookup/2
=== RUN   TestCommonHandler_Lookup/3
--- PASS: TestCommonHandler_Lookup (0.00s)
    --- PASS: TestCommonHandler_Lookup/1 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Lookup/2 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Lookup/3 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_Getattr
=== RUN   TestCommonHandler_Getattr/1
=== RUN   TestCommonHandler_Getattr/2
--- PASS: TestCommonHandler_Getattr (0.00s)
    --- PASS: TestCommonHandler_Getattr/1 (0.00s)
    --- PASS: TestCommonHandler_Getattr/2 (0.00s)
=== RUN   TestCommonHandler_Read
=== RUN   TestCommonHandler_Read/1
=== RUN   TestCommonHandler_Read/2
=== RUN   TestCommonHandler_Read/3
--- PASS: TestCommonHandler_Read (0.00s)
    --- PASS: TestCommonHandler_Read/1 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Read/2 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Read/3 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_Write
=== RUN   TestCommonHandler_Write/1
=== RUN   TestCommonHandler_Write/2
=== RUN   TestCommonHandler_Write/3
--- PASS: TestCommonHandler_Write (0.00s)
    --- PASS: TestCommonHandler_Write/1 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Write/2 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Write/3 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_ReadDirAll
=== RUN   TestCommonHandler_ReadDirAll/1
=== RUN   TestCommonHandler_ReadDirAll/2
=== RUN   TestCommonHandler_ReadDirAll/3
--- PASS: TestCommonHandler_ReadDirAll (0.00s)
    --- PASS: TestCommonHandler_ReadDirAll/1 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_ReadDirAll/2 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_ReadDirAll/3 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_EmulatedFilesInfo
=== RUN   TestCommonHandler_EmulatedFilesInfo/1
--- PASS: TestCommonHandler_EmulatedFilesInfo (0.00s)
    --- PASS: TestCommonHandler_EmulatedFilesInfo/1 (0.00s)
=== RUN   TestCommonHandler_FetchFile
=== RUN   TestCommonHandler_FetchFile/1
--- PASS: TestCommonHandler_FetchFile (0.00s)
    --- PASS: TestCommonHandler_FetchFile/1 (0.00s)
        common_test.go:1097: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:1097: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:1097: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_PushFile
=== RUN   TestCommonHandler_PushFile/1
--- PASS: TestCommonHandler_PushFile (0.00s)
    --- PASS: TestCommonHandler_PushFile/1 (0.00s)
        common_test.go:1226: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:1226: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:1226: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_GetName
=== RUN   TestCommonHandler_GetName/1
--- PASS: TestCommonHandler_GetName (0.00s)
    --- PASS: TestCommonHandler_GetName/1 (0.00s)
=== RUN   TestCommonHandler_GetPath
=== RUN   TestCommonHandler_GetPath/1
--- PASS: TestCommonHandler_GetPath (0.00s)
    --- PASS: TestCommonHandler_GetPath/1 (0.00s)
=== RUN   TestCommonHandler_GetEnabled
=== RUN   TestCommonHandler_GetEnabled/1
--- PASS: TestCommonHandler_GetEnabled (0.00s)
    --- PASS: TestCommonHandler_GetEnabled/1 (0.00s)
=== RUN   TestCommonHandler_GetService
=== RUN   TestCommonHandler_GetService/1
--- PASS: TestCommonHandler_GetService (0.00s)
    --- PASS: TestCommonHandler_GetService/1 (0.00s)
=== RUN   TestCommonHandler_SetEnabled
=== RUN   TestCommonHandler_SetEnabled/1
--- PASS: TestCommonHandler_SetEnabled (0.00s)
    --- PASS: TestCommonHandler_SetEnabled/1 (0.00s)
=== RUN   TestCommonHandler_SetService
=== RUN   TestCommonHandler_SetService/1
--- PASS: TestCommonHandler_SetService (0.00s)
    --- PASS: TestCommonHandler_SetService/1 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Lookup
=== RUN   TestNfConntrackMaxHandler_Lookup/1
--- PASS: TestNfConntrackMaxHandler_Lookup (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Lookup/1 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Getattr
=== RUN   TestNfConntrackMaxHandler_Getattr/1
=== RUN   TestNfConntrackMaxHandler_Getattr/2
--- PASS: TestNfConntrackMaxHandler_Getattr (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Getattr/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Getattr/2 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Open
=== RUN   TestNfConntrackMaxHandler_Open/1
=== RUN   TestNfConntrackMaxHandler_Open/2
=== RUN   TestNfConntrackMaxHandler_Open/3
--- PASS: TestNfConntrackMaxHandler_Open (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/2 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/3 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Close
--- PASS: TestNfConntrackMaxHandler_Close (0.00s)
=== RUN   TestNfConntrackMaxHandler_Read
=== RUN   TestNfConntrackMaxHandler_Read/1
=== RUN   TestNfConntrackMaxHandler_Read/2
=== RUN   TestNfConntrackMaxHandler_Read/3
=== RUN   TestNfConntrackMaxHandler_Read/4
--- PASS: TestNfConntrackMaxHandler_Read (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/2 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/3 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/4 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Write
--- SKIP: TestNfConntrackMaxHandler_Write (0.00s)
    nfConntrackMax_test.go:542: Skipping write testcase temporarily
=== RUN   TestNfConntrackMaxHandler_ReadDirAll
--- PASS: TestNfConntrackMaxHandler_ReadDirAll (0.00s)
=== RUN   TestNfConntrackMaxHandler_FetchFile
--- PASS: TestNfConntrackMaxHandler_FetchFile (0.00s)
=== RUN   TestNfConntrackMaxHandler_PushFile
--- PASS: TestNfConntrackMaxHandler_PushFile (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetName
--- PASS: TestNfConntrackMaxHandler_GetName (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetPath
--- PASS: TestNfConntrackMaxHandler_GetPath (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetEnabled
--- PASS: TestNfConntrackMaxHandler_GetEnabled (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetService
--- PASS: TestNfConntrackMaxHandler_GetService (0.00s)
=== RUN   TestNfConntrackMaxHandler_SetEnabled
--- PASS: TestNfConntrackMaxHandler_SetEnabled (0.00s)
=== RUN   TestNfConntrackMaxHandler_SetService
--- PASS: TestNfConntrackMaxHandler_SetService (0.00s)
=== RUN   TestProcUptimeHandler_Lookup
=== RUN   TestProcUptimeHandler_Lookup/1
--- PASS: TestProcUptimeHandler_Lookup (0.00s)
    --- PASS: TestProcUptimeHandler_Lookup/1 (0.00s)
=== RUN   TestProcUptimeHandler_Getattr
=== RUN   TestProcUptimeHandler_Getattr/1
=== RUN   TestProcUptimeHandler_Getattr/2
--- PASS: TestProcUptimeHandler_Getattr (0.00s)
    --- PASS: TestProcUptimeHandler_Getattr/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Getattr/2 (0.00s)
=== RUN   TestProcUptimeHandler_Open
=== RUN   TestProcUptimeHandler_Open/1
=== RUN   TestProcUptimeHandler_Open/2
=== RUN   TestProcUptimeHandler_Open/3
--- PASS: TestProcUptimeHandler_Open (0.00s)
    --- PASS: TestProcUptimeHandler_Open/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Open/2 (0.00s)
    --- PASS: TestProcUptimeHandler_Open/3 (0.00s)
=== RUN   TestProcUptimeHandler_Read
=== RUN   TestProcUptimeHandler_Read/1
=== RUN   TestProcUptimeHandler_Read/2
=== RUN   TestProcUptimeHandler_Read/3
=== RUN   TestProcUptimeHandler_Read/4
--- PASS: TestProcUptimeHandler_Read (0.00s)
    --- PASS: TestProcUptimeHandler_Read/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/2 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/3 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/4 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/handler/implementations	0.031s
=== RUN   TestNewIpcService
--- PASS: TestNewIpcService (0.00s)
=== RUN   TestContainerRegister
=== RUN   TestContainerRegister/1
=== RUN   TestContainerRegister/2
=== RUN   TestContainerRegister/3
--- PASS: TestContainerRegister (0.00s)
    --- PASS: TestContainerRegister/1 (0.00s)
    --- PASS: TestContainerRegister/2 (0.00s)
    --- PASS: TestContainerRegister/3 (0.00s)
=== RUN   TestContainerUnregister
=== RUN   TestContainerUnregister/1
=== RUN   TestContainerUnregister/2
=== RUN   TestContainerUnregister/3
--- PASS: TestContainerUnregister (0.00s)
    --- PASS: TestContainerUnregister/1 (0.00s)
    --- PASS: TestContainerUnregister/2 (0.00s)
    --- PASS: TestContainerUnregister/3 (0.00s)
=== RUN   TestContainerUpdate
=== RUN   TestContainerUpdate/1
=== RUN   TestContainerUpdate/2
=== RUN   TestContainerUpdate/3
--- PASS: TestContainerUpdate (0.00s)
    --- PASS: TestContainerUpdate/1 (0.00s)
    --- PASS: TestContainerUpdate/2 (0.00s)
    --- PASS: TestContainerUpdate/3 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/ipc	0.011s
?   	github.com/nestybox/sysbox-fs/mocks	[no test files]
?   	github.com/nestybox/sysbox-fs/nsenter	[no test files]
=== RUN   TestNewContainerStateService
=== RUN   TestNewContainerStateService/1
--- PASS: TestNewContainerStateService (0.00s)
    --- PASS: TestNewContainerStateService/1 (0.00s)
=== RUN   Test_containerStateService_ContainerCreate
=== RUN   Test_containerStateService_ContainerCreate/1
--- PASS: Test_containerStateService_ContainerCreate (0.00s)
    --- PASS: Test_containerStateService_ContainerCreate/1 (0.00s)
=== RUN   Test_containerStateService_ContainerAdd
=== RUN   Test_containerStateService_ContainerAdd/1
=== RUN   Test_containerStateService_ContainerAdd/2
=== RUN   Test_containerStateService_ContainerAdd/3
--- PASS: Test_containerStateService_ContainerAdd (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/3 (0.00s)
=== RUN   Test_containerStateService_ContainerUpdate
=== RUN   Test_containerStateService_ContainerUpdate/1
=== RUN   Test_containerStateService_ContainerUpdate/2
=== RUN   Test_containerStateService_ContainerUpdate/3
--- PASS: Test_containerStateService_ContainerUpdate (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/3 (0.00s)
=== RUN   Test_containerStateService_ContainerDelete
=== RUN   Test_containerStateService_ContainerDelete/1
=== RUN   Test_containerStateService_ContainerDelete/2
=== RUN   Test_containerStateService_ContainerDelete/3
--- PASS: Test_containerStateService_ContainerDelete (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/3 (0.00s)
=== RUN   Test_containerStateService_ContainerLookupById
=== RUN   Test_containerStateService_ContainerLookupById/1
=== RUN   Test_containerStateService_ContainerLookupById/2
=== RUN   Test_containerStateService_ContainerLookupById/3
--- PASS: Test_containerStateService_ContainerLookupById (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/3 (0.00s)
=== RUN   Test_containerStateService_ContainerLookupByPid
=== RUN   Test_containerStateService_ContainerLookupByPid/1
=== RUN   Test_containerStateService_ContainerLookupByPid/2
=== RUN   Test_containerStateService_ContainerLookupByPid/3
--- PASS: Test_containerStateService_ContainerLookupByPid (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/3 (0.00s)
=== RUN   Test_container_ID
=== RUN   Test_container_ID/1
=== RUN   Test_container_ID/2
--- PASS: Test_container_ID (0.00s)
    --- PASS: Test_container_ID/1 (0.00s)
    --- PASS: Test_container_ID/2 (0.00s)
=== RUN   Test_container_InitPid
=== RUN   Test_container_InitPid/1
=== RUN   Test_container_InitPid/2
--- PASS: Test_container_InitPid (0.00s)
    --- PASS: Test_container_InitPid/1 (0.00s)
    --- PASS: Test_container_InitPid/2 (0.00s)
=== RUN   Test_container_Hostname
=== RUN   Test_container_Hostname/1
=== RUN   Test_container_Hostname/2
--- PASS: Test_container_Hostname (0.00s)
    --- PASS: Test_container_Hostname/1 (0.00s)
    --- PASS: Test_container_Hostname/2 (0.00s)
=== RUN   Test_container_Ctime
=== RUN   Test_container_Ctime/1
=== RUN   Test_container_Ctime/2
--- PASS: Test_container_Ctime (0.00s)
    --- PASS: Test_container_Ctime/1 (0.00s)
    --- PASS: Test_container_Ctime/2 (0.00s)
=== RUN   Test_container_PidInode
=== RUN   Test_container_PidInode/1
=== RUN   Test_container_PidInode/2
--- PASS: Test_container_PidInode (0.00s)
    --- PASS: Test_container_PidInode/1 (0.00s)
    --- PASS: Test_container_PidInode/2 (0.00s)
=== RUN   Test_container_Data
=== RUN   Test_container_Data/1
=== RUN   Test_container_Data/2
=== RUN   Test_container_Data/3
=== RUN   Test_container_Data/4
--- PASS: Test_container_Data (0.00s)
    --- PASS: Test_container_Data/1 (0.00s)
    --- PASS: Test_container_Data/2 (0.00s)
    --- PASS: Test_container_Data/3 (0.00s)
    --- PASS: Test_container_Data/4 (0.00s)
=== RUN   Test_container_String
=== RUN   Test_container_String/1
--- PASS: Test_container_String (0.00s)
    --- PASS: Test_container_String/1 (0.00s)
=== RUN   Test_container_SetCtime
=== RUN   Test_container_SetCtime/1
=== RUN   Test_container_SetCtime/2
--- PASS: Test_container_SetCtime (0.00s)
    --- PASS: Test_container_SetCtime/1 (0.00s)
    --- PASS: Test_container_SetCtime/2 (0.00s)
=== RUN   Test_container_SetData
=== RUN   Test_container_SetData/1
=== RUN   Test_container_SetData/2
=== RUN   Test_container_SetData/3
--- PASS: Test_container_SetData (0.00s)
    --- PASS: Test_container_SetData/1 (0.00s)
    --- PASS: Test_container_SetData/2 (0.00s)
    --- PASS: Test_container_SetData/3 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/state	0.006s
=== RUN   Test_ioFileService_NewIOnode
--- PASS: Test_ioFileService_NewIOnode (0.00s)
=== RUN   Test_ioFileService_OpenNode
=== RUN   Test_ioFileService_OpenNode/1
--- PASS: Test_ioFileService_OpenNode (0.00s)
    --- PASS: Test_ioFileService_OpenNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadNode
=== RUN   Test_ioFileService_ReadNode/1
--- PASS: Test_ioFileService_ReadNode (0.00s)
    --- PASS: Test_ioFileService_ReadNode/1 (0.00s)
=== RUN   Test_ioFileService_WriteNode
=== RUN   Test_ioFileService_WriteNode/1
--- PASS: Test_ioFileService_WriteNode (0.00s)
    --- PASS: Test_ioFileService_WriteNode/1 (0.00s)
=== RUN   Test_ioFileService_CloseNode
=== RUN   Test_ioFileService_CloseNode/1
--- PASS: Test_ioFileService_CloseNode (0.00s)
    --- PASS: Test_ioFileService_CloseNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadAtNode
=== RUN   Test_ioFileService_ReadAtNode/1
--- PASS: Test_ioFileService_ReadAtNode (0.00s)
    --- PASS: Test_ioFileService_ReadAtNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadDirAllNode
--- PASS: Test_ioFileService_ReadDirAllNode (0.00s)
=== RUN   Test_ioFileService_ReadLineNode
=== RUN   Test_ioFileService_ReadLineNode/1
--- PASS: Test_ioFileService_ReadLineNode (0.00s)
    --- PASS: Test_ioFileService_ReadLineNode/1 (0.00s)
=== RUN   Test_ioFileService_StatNode
=== RUN   Test_ioFileService_StatNode/1
--- PASS: Test_ioFileService_StatNode (0.00s)
    --- PASS: Test_ioFileService_StatNode/1 (0.00s)
=== RUN   Test_ioFileService_SeekResetNode
=== RUN   Test_ioFileService_SeekResetNode/1
--- PASS: Test_ioFileService_SeekResetNode (0.00s)
    --- PASS: Test_ioFileService_SeekResetNode/1 (0.00s)
=== RUN   Test_ioFileService_PidNsInode
--- SKIP: Test_ioFileService_PidNsInode (0.00s)
    ionodeFile_test.go:438: Skipping IOnodeService.PidNsInode() for now
=== RUN   Test_ioFileService_PathNode
=== RUN   Test_ioFileService_PathNode/1
--- PASS: Test_ioFileService_PathNode (0.00s)
    --- PASS: Test_ioFileService_PathNode/1 (0.00s)
=== RUN   TestIOnodeFile_Open
=== RUN   TestIOnodeFile_Open/1
=== RUN   TestIOnodeFile_Open/2
--- PASS: TestIOnodeFile_Open (0.00s)
    --- PASS: TestIOnodeFile_Open/1 (0.00s)
    --- PASS: TestIOnodeFile_Open/2 (0.00s)
=== RUN   TestIOnodeFile_Read
=== RUN   TestIOnodeFile_Read/1
=== RUN   TestIOnodeFile_Read/2
=== RUN   TestIOnodeFile_Read/3
=== RUN   TestIOnodeFile_Read/4
--- PASS: TestIOnodeFile_Read (0.00s)
    --- PASS: TestIOnodeFile_Read/1 (0.00s)
    --- PASS: TestIOnodeFile_Read/2 (0.00s)
    --- PASS: TestIOnodeFile_Read/3 (0.00s)
    --- PASS: TestIOnodeFile_Read/4 (0.00s)
=== RUN   TestIOnodeFile_Write
=== RUN   TestIOnodeFile_Write/1
=== RUN   TestIOnodeFile_Write/2
=== RUN   TestIOnodeFile_Write/3
--- PASS: TestIOnodeFile_Write (0.00s)
    --- PASS: TestIOnodeFile_Write/1 (0.00s)
    --- PASS: TestIOnodeFile_Write/2 (0.00s)
    --- PASS: TestIOnodeFile_Write/3 (0.00s)
=== RUN   TestIOnodeFile_Close
=== RUN   TestIOnodeFile_Close/1
=== RUN   TestIOnodeFile_Close/2
--- PASS: TestIOnodeFile_Close (0.00s)
    --- PASS: TestIOnodeFile_Close/1 (0.00s)
    --- PASS: TestIOnodeFile_Close/2 (0.00s)
=== RUN   TestIOnodeFile_ReadAt
=== RUN   TestIOnodeFile_ReadAt/1
=== RUN   TestIOnodeFile_ReadAt/2
=== RUN   TestIOnodeFile_ReadAt/3
=== RUN   TestIOnodeFile_ReadAt/4
--- PASS: TestIOnodeFile_ReadAt (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/2 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/3 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/4 (0.00s)
=== RUN   TestIOnodeFile_ReadDirAll
=== RUN   TestIOnodeFile_ReadDirAll/1
=== RUN   TestIOnodeFile_ReadDirAll/2
--- PASS: TestIOnodeFile_ReadDirAll (0.00s)
    --- PASS: TestIOnodeFile_ReadDirAll/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadDirAll/2 (0.00s)
=== RUN   TestIOnodeFile_ReadLine
=== RUN   TestIOnodeFile_ReadLine/1
=== RUN   TestIOnodeFile_ReadLine/2
=== RUN   TestIOnodeFile_ReadLine/3
=== RUN   TestIOnodeFile_ReadLine/4
--- PASS: TestIOnodeFile_ReadLine (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/2 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/3 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/4 (0.00s)
=== RUN   TestIOnodeFile_Stat
=== RUN   TestIOnodeFile_Stat/1
=== RUN   TestIOnodeFile_Stat/2
--- PASS: TestIOnodeFile_Stat (0.00s)
    --- PASS: TestIOnodeFile_Stat/1 (0.00s)
    --- PASS: TestIOnodeFile_Stat/2 (0.00s)
=== RUN   TestIOnodeFile_SeekReset
=== RUN   TestIOnodeFile_SeekReset/1
=== RUN   TestIOnodeFile_SeekReset/2
--- PASS: TestIOnodeFile_SeekReset (0.00s)
    --- PASS: TestIOnodeFile_SeekReset/1 (0.00s)
    --- PASS: TestIOnodeFile_SeekReset/2 (0.00s)
=== RUN   TestIOnodeFile_PidNsInode
=== RUN   TestIOnodeFile_PidNsInode/1
--- PASS: TestIOnodeFile_PidNsInode (0.00s)
    --- PASS: TestIOnodeFile_PidNsInode/1 (0.00s)
=== RUN   TestIOnodeFile_Name
=== RUN   TestIOnodeFile_Name/1
--- PASS: TestIOnodeFile_Name (0.00s)
    --- PASS: TestIOnodeFile_Name/1 (0.00s)
=== RUN   TestIOnodeFile_Path
=== RUN   TestIOnodeFile_Path/1
--- PASS: TestIOnodeFile_Path (0.00s)
    --- PASS: TestIOnodeFile_Path/1 (0.00s)
=== RUN   TestIOnodeFile_OpenFlags
=== RUN   TestIOnodeFile_OpenFlags/1
=== RUN   TestIOnodeFile_OpenFlags/2
--- PASS: TestIOnodeFile_OpenFlags (0.00s)
    --- PASS: TestIOnodeFile_OpenFlags/1 (0.00s)
    --- PASS: TestIOnodeFile_OpenFlags/2 (0.00s)
=== RUN   TestIOnodeFile_SetOpenFlags
=== RUN   TestIOnodeFile_SetOpenFlags/1
=== RUN   TestIOnodeFile_SetOpenFlags/2
--- PASS: TestIOnodeFile_SetOpenFlags (0.00s)
    --- PASS: TestIOnodeFile_SetOpenFlags/1 (0.00s)
    --- PASS: TestIOnodeFile_SetOpenFlags/2 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/sysio	0.008s

** Running sysbox-mgr unit tests **

docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "make --no-print-directory test-mgr-local"
make[1]: 'protobuf.pb.go' is up to date.
cd sysbox-mgr && go test -timeout 3m -v github.com/nestybox/sysbox-mgr github.com/nestybox/sysbox-mgr/dsVolMgr github.com/nestybox/sysbox-mgr/intf github.com/nestybox/sysbox-mgr/lib/buddyAlloc github.com/nestybox/sysbox-mgr/lib/dockerUtils github.com/nestybox/sysbox-mgr/shiftfsMgr github.com/nestybox/sysbox-mgr/subidAlloc
=== RUN   TestAllocSubidRange
--- PASS: TestAllocSubidRange (0.00s)
=== RUN   TestConfigSubidRange
--- PASS: TestConfigSubidRange (0.00s)
=== RUN   TestGetSubidLimits
--- PASS: TestGetSubidLimits (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr	0.012s
=== RUN   TestCreateVol
--- PASS: TestCreateVol (0.00s)
=== RUN   TestDestroyVol
--- PASS: TestDestroyVol (0.00s)
=== RUN   TestSyncIn
--- PASS: TestSyncIn (0.02s)
=== RUN   TestSyncInUidShift
--- PASS: TestSyncInUidShift (0.01s)
=== RUN   TestSyncOut
--- PASS: TestSyncOut (0.02s)
=== RUN   TestSyncOutUidShift
--- PASS: TestSyncOutUidShift (0.01s)
=== RUN   TestSyncInSkip
--- PASS: TestSyncInSkip (0.00s)
=== RUN   TestSyncOutSkip
--- PASS: TestSyncOutSkip (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/dsVolMgr	0.069s
?   	github.com/nestybox/sysbox-mgr/intf	[no test files]
=== RUN   TestGetBlkSize
--- PASS: TestGetBlkSize (0.00s)
=== RUN   TestGetOrder
--- PASS: TestGetOrder (0.00s)
=== RUN   TestBuddyLimits
--- PASS: TestBuddyLimits (0.00s)
=== RUN   TestMaxRange
--- PASS: TestMaxRange (0.00s)
=== RUN   TestAllocBasic
--- PASS: TestAllocBasic (0.00s)
=== RUN   TestAllocExhausted
--- PASS: TestAllocExhausted (0.00s)
=== RUN   TestRealloc
--- PASS: TestRealloc (0.00s)
=== RUN   TestFree
--- PASS: TestFree (0.00s)
=== RUN   TestFreeEmpty
--- PASS: TestFreeEmpty (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/lib/buddyAlloc	0.002s
=== RUN   TestParseDataRoot
--- PASS: TestParseDataRoot (0.00s)
=== RUN   TestIsDockerContainer
--- PASS: TestIsDockerContainer (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/lib/dockerUtils	0.002s
=== RUN   TestShiftfsMgrBasic
--- PASS: TestShiftfsMgrBasic (0.01s)
=== RUN   TestShiftfsMgrErrors
--- PASS: TestShiftfsMgrErrors (0.01s)
PASS
ok  	github.com/nestybox/sysbox-mgr/shiftfsMgr	0.035s
=== RUN   TestAllocBasic
--- PASS: TestAllocBasic (0.00s)
=== RUN   TestAllocRangeLimit
--- PASS: TestAllocRangeLimit (0.00s)
=== RUN   TestAllocReuse
--- PASS: TestAllocReuse (0.00s)
=== RUN   TestAllocNoReuse
--- PASS: TestAllocNoReuse (0.00s)
=== RUN   TestAllocErrors
--- PASS: TestAllocErrors (0.00s)
=== RUN   TestFreeBasic
--- PASS: TestFreeBasic (0.00s)
=== RUN   TestFreeErrors
--- PASS: TestFreeErrors (0.00s)
=== RUN   TestAllocInvalidUser
--- PASS: TestAllocInvalidUser (0.00s)
=== RUN   TestConcurrency
--- PASS: TestConcurrency (0.00s)
=== RUN   TestAllocLimits
--- PASS: TestAllocLimits (0.00s)
=== RUN   TestAllocMultiRange
--- PASS: TestAllocMultiRange (0.00s)
=== RUN   TestGetCommonRanges
--- PASS: TestGetCommonRanges (0.00s)
=== RUN   TestAllocCommonRange
--- PASS: TestAllocCommonRange (0.00s)
=== RUN   TestIdentityMode
--- PASS: TestIdentityMode (0.00s)
=== RUN   TestExclusiveModeOverride
--- PASS: TestExclusiveModeOverride (0.00s)
=== RUN   TestIdentityModeOverride
--- PASS: TestIdentityModeOverride (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/subidAlloc	0.006s
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxFsGrpc/protobuf'
make[1]: 'protobuf.pb.go' is up to date.
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxFsGrpc/protobuf'
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxMgrGrpc/protobuf'
make[1]: 'protobuf.pb.go' is up to date.
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxMgrGrpc/protobuf'

** Running sysbox-runc unit & integration tests **

cd sysbox-runc && make clean && make BUILDTAGS="seccomp apparmor" test
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
rm -f sysbox-runc sysbox-runc-*
rm -f contrib/cmd/recvtty/recvtty
rm -rf /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/release
rm -rf /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/man/man8
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make unittest integration integration-shiftuid
make[2]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
docker build  -t runc_dev:HEAD .
Sending build context to Docker daemon  1.373MB
Step 1/13 : FROM golang:1.13.0-buster
 ---> c4d6fdf2260a
Step 2/13 : RUN dpkg --add-architecture armel     && dpkg --add-architecture armhf     && dpkg --add-architecture arm64     && dpkg --add-architecture ppc64el     && apt-get update && apt-get install -y     build-essential     curl     sudo     gawk     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libprotobuf-c-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     crossbuild-essential-armel crossbuild-essential-armhf crossbuild-essential-arm64 crossbuild-essential-ppc64el     libseccomp-dev:armel libseccomp-dev:armhf libseccomp-dev:arm64 libseccomp-dev:ppc64el     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> e9d30f8dff01
Step 3/13 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 46a7d91ab379
Step 4/13 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 77035685b561
Step 5/13 : ENV CRIU_VERSION v3.11
 ---> Using cache
 ---> 95dd7a848481
Step 6/13 : RUN mkdir -p /usr/src/criu     && curl -sSL https://github.com/checkpoint-restore/criu/archive/${CRIU_VERSION}.tar.gz | tar -v -C /usr/src/criu/ -xz --strip-components=1     && cd /usr/src/criu     && curl https://github.com/checkpoint-restore/criu/commit/bb0b2f2635d71e549851b7c626a1464e42a3b5c7.patch | patch -p1     && make install-criu     && rm -rf /usr/src/criu
 ---> Using cache
 ---> 83a869af0c25
Step 7/13 : ENV ROOTFS /busybox
 ---> Using cache
 ---> e4fb7c6b09e7
Step 8/13 : RUN mkdir -p ${ROOTFS}
 ---> Using cache
 ---> 7944c2a8929e
Step 9/13 : COPY script/tmpmount /
 ---> Using cache
 ---> 36a9d4de6a38
Step 10/13 : WORKDIR /root/nestybox/sysbox-runc
 ---> Using cache
 ---> 51ffb108304e
Step 11/13 : ENTRYPOINT ["/tmpmount"]
 ---> Using cache
 ---> 66d2dec2a88c
Step 12/13 : ADD . /root/nestybox/sysbox-runc
 ---> Using cache
 ---> ba4ce4ecada9
Step 13/13 : RUN . tests/integration/multi-arch.bash     && curl -o- -sSL `get_busybox` | tar xfJC - ${ROOTFS}
 ---> Using cache
 ---> 63f738a74721
Successfully built 63f738a74721
Successfully tagged runc_dev:HEAD
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localunittest TESTFLAGS=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
go build -buildmode=pie  -ldflags "-X main.gitCommit="" -X main.version= " -tags "seccomp" -o contrib/cmd/recvtty/recvtty ./contrib/cmd/recvtty
go build -buildmode=pie  -ldflags '-X main.version= -X main.commitId= -X "main.builtAt=" -X main.builtBy=' -tags "seccomp" \
	-o sysbox-runc .
go: finding github.com/vishvananda/netns latest
go: finding github.com/coreos/pkg latest
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/coreos/pkg latest
go: finding github.com/vishvananda/netns latest
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
go test -timeout 3m -tags "seccomp"  -v github.com/nestybox/sysbox-runc github.com/nestybox/sysbox-runc/contrib/cmd/recvtty github.com/nestybox/sysbox-runc/libcontainer github.com/nestybox/sysbox-runc/libcontainer/apparmor github.com/nestybox/sysbox-runc/libcontainer/cgroups github.com/nestybox/sysbox-runc/libcontainer/cgroups/fs github.com/nestybox/sysbox-runc/libcontainer/cgroups/systemd github.com/nestybox/sysbox-runc/libcontainer/configs github.com/nestybox/sysbox-runc/libcontainer/configs/validate github.com/nestybox/sysbox-runc/libcontainer/devices github.com/nestybox/sysbox-runc/libcontainer/integration github.com/nestybox/sysbox-runc/libcontainer/intelrdt github.com/nestybox/sysbox-runc/libcontainer/keys github.com/nestybox/sysbox-runc/libcontainer/mount github.com/nestybox/sysbox-runc/libcontainer/nsenter github.com/nestybox/sysbox-runc/libcontainer/seccomp github.com/nestybox/sysbox-runc/libcontainer/specconv github.com/nestybox/sysbox-runc/libcontainer/stacktrace github.com/nestybox/sysbox-runc/libcontainer/system github.com/nestybox/sysbox-runc/libcontainer/user github.com/nestybox/sysbox-runc/libcontainer/utils github.com/nestybox/sysbox-runc/libsysbox/shiftfs github.com/nestybox/sysbox-runc/libsysbox/sysbox github.com/nestybox/sysbox-runc/libsysbox/syscont
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
?   	github.com/nestybox/sysbox-runc	[no test files]
?   	github.com/nestybox/sysbox-runc/contrib/cmd/recvtty	[no test files]
=== RUN   TestGetContainerPids
--- PASS: TestGetContainerPids (0.00s)
=== RUN   TestGetContainerStats
--- PASS: TestGetContainerStats (0.00s)
=== RUN   TestGetContainerState
--- PASS: TestGetContainerState (0.00s)
=== RUN   TestGetContainerStateAfterUpdate
--- PASS: TestGetContainerStateAfterUpdate (0.00s)
=== RUN   TestErrorCode
--- PASS: TestErrorCode (0.00s)
=== RUN   TestFactoryNew
--- PASS: TestFactoryNew (0.00s)
=== RUN   TestFactoryNewIntelRdt
--- PASS: TestFactoryNewIntelRdt (0.00s)
=== RUN   TestFactoryNewTmpfs
--- PASS: TestFactoryNewTmpfs (0.01s)
=== RUN   TestFactoryLoadNotExists
--- PASS: TestFactoryLoadNotExists (0.00s)
=== RUN   TestFactoryLoadContainer
time="2020-02-02T22:07:31Z" level=warning msg="cannot serialize hook of type libcontainer.unserializableHook, skipping"
--- PASS: TestFactoryLoadContainer (0.00s)
=== RUN   TestErrorDetail
--- PASS: TestErrorDetail (0.00s)
=== RUN   TestErrorWithCode
--- PASS: TestErrorWithCode (0.00s)
=== RUN   TestErrorWithError
--- PASS: TestErrorWithError (0.00s)
=== RUN   TestNotifyOnOOM
--- PASS: TestNotifyOnOOM (0.00s)
=== RUN   TestNotifyMemoryPressure
--- PASS: TestNotifyMemoryPressure (0.00s)
=== RUN   TestNeedsSetupDev
--- PASS: TestNeedsSetupDev (0.00s)
=== RUN   TestNeedsSetupDevStrangeSource
--- PASS: TestNeedsSetupDevStrangeSource (0.00s)
=== RUN   TestNeedsSetupDevStrangeDest
--- PASS: TestNeedsSetupDevStrangeDest (0.00s)
=== RUN   TestNeedsSetupDevStrangeSourceDest
--- PASS: TestNeedsSetupDevStrangeSourceDest (0.00s)
=== RUN   TestStateStatus
--- PASS: TestStateStatus (0.00s)
=== RUN   TestStoppedStateTransition
=== RUN   TestStoppedStateTransition/stopped
=== RUN   TestStoppedStateTransition/running
=== RUN   TestStoppedStateTransition/running#01
=== RUN   TestStoppedStateTransition/created
=== RUN   TestStoppedStateTransition/paused
=== RUN   TestStoppedStateTransition/running#02
--- PASS: TestStoppedStateTransition (0.00s)
    --- PASS: TestStoppedStateTransition/stopped (0.00s)
    --- PASS: TestStoppedStateTransition/running (0.00s)
    --- PASS: TestStoppedStateTransition/running#01 (0.00s)
    --- PASS: TestStoppedStateTransition/created (0.00s)
    --- PASS: TestStoppedStateTransition/paused (0.00s)
    --- PASS: TestStoppedStateTransition/running#02 (0.00s)
=== RUN   TestPausedStateTransition
=== RUN   TestPausedStateTransition/paused
=== RUN   TestPausedStateTransition/running
=== RUN   TestPausedStateTransition/stopped
=== RUN   TestPausedStateTransition/created
=== RUN   TestPausedStateTransition/running#01
=== RUN   TestPausedStateTransition/running#02
--- PASS: TestPausedStateTransition (0.00s)
    --- PASS: TestPausedStateTransition/paused (0.00s)
    --- PASS: TestPausedStateTransition/running (0.00s)
    --- PASS: TestPausedStateTransition/stopped (0.00s)
    --- PASS: TestPausedStateTransition/created (0.00s)
    --- PASS: TestPausedStateTransition/running#01 (0.00s)
    --- PASS: TestPausedStateTransition/running#02 (0.00s)
=== RUN   TestRestoredStateTransition
=== RUN   TestRestoredStateTransition/stopped
=== RUN   TestRestoredStateTransition/running
=== RUN   TestRestoredStateTransition/running#01
=== RUN   TestRestoredStateTransition/paused
=== RUN   TestRestoredStateTransition/running#02
=== RUN   TestRestoredStateTransition/created
--- PASS: TestRestoredStateTransition (0.00s)
    --- PASS: TestRestoredStateTransition/stopped (0.00s)
    --- PASS: TestRestoredStateTransition/running (0.00s)
    --- PASS: TestRestoredStateTransition/running#01 (0.00s)
    --- PASS: TestRestoredStateTransition/paused (0.00s)
    --- PASS: TestRestoredStateTransition/running#02 (0.00s)
    --- PASS: TestRestoredStateTransition/created (0.00s)
=== RUN   TestRunningStateTransition
=== RUN   TestRunningStateTransition/stopped
=== RUN   TestRunningStateTransition/paused
=== RUN   TestRunningStateTransition/running
=== RUN   TestRunningStateTransition/running#01
=== RUN   TestRunningStateTransition/created
=== RUN   TestRunningStateTransition/running#02
--- PASS: TestRunningStateTransition (0.00s)
    --- PASS: TestRunningStateTransition/stopped (0.00s)
    --- PASS: TestRunningStateTransition/paused (0.00s)
    --- PASS: TestRunningStateTransition/running (0.00s)
    --- PASS: TestRunningStateTransition/running#01 (0.00s)
    --- PASS: TestRunningStateTransition/created (0.00s)
    --- PASS: TestRunningStateTransition/running#02 (0.00s)
=== RUN   TestCreatedStateTransition
=== RUN   TestCreatedStateTransition/stopped
=== RUN   TestCreatedStateTransition/paused
=== RUN   TestCreatedStateTransition/running
=== RUN   TestCreatedStateTransition/created
=== RUN   TestCreatedStateTransition/running#01
=== RUN   TestCreatedStateTransition/running#02
--- PASS: TestCreatedStateTransition (0.00s)
    --- PASS: TestCreatedStateTransition/stopped (0.00s)
    --- PASS: TestCreatedStateTransition/paused (0.00s)
    --- PASS: TestCreatedStateTransition/running (0.00s)
    --- PASS: TestCreatedStateTransition/created (0.00s)
    --- PASS: TestCreatedStateTransition/running#01 (0.00s)
    --- PASS: TestCreatedStateTransition/running#02 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer	0.024s
?   	github.com/nestybox/sysbox-runc/libcontainer/apparmor	[no test files]
=== RUN   TestParseCgroups
--- PASS: TestParseCgroups (0.00s)
=== RUN   TestGetCgroupMounts
--- PASS: TestGetCgroupMounts (0.00s)
=== RUN   TestParseCgroupString
--- PASS: TestParseCgroupString (0.00s)
=== RUN   TestIgnoreCgroup2Mount
--- PASS: TestIgnoreCgroup2Mount (0.00s)
=== RUN   TestGetClosestMountpointAncestor
--- PASS: TestGetClosestMountpointAncestor (0.00s)
=== RUN   TestFindCgroupMountpointAndRoot
--- PASS: TestFindCgroupMountpointAndRoot (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/cgroups	0.007s
=== RUN   TestInvalidCgroupPath
--- PASS: TestInvalidCgroupPath (0.00s)
=== RUN   TestInvalidAbsoluteCgroupPath
--- PASS: TestInvalidAbsoluteCgroupPath (0.00s)
=== RUN   TestInvalidCgroupParent
--- PASS: TestInvalidCgroupParent (0.00s)
=== RUN   TestInvalidAbsoluteCgroupParent
--- PASS: TestInvalidAbsoluteCgroupParent (0.00s)
=== RUN   TestInvalidCgroupName
--- PASS: TestInvalidCgroupName (0.00s)
=== RUN   TestInvalidAbsoluteCgroupName
--- PASS: TestInvalidAbsoluteCgroupName (0.00s)
=== RUN   TestInvalidCgroupNameAndParent
--- PASS: TestInvalidCgroupNameAndParent (0.00s)
=== RUN   TestInvalidAbsoluteCgroupNameAndParent
--- PASS: TestInvalidAbsoluteCgroupNameAndParent (0.00s)
=== RUN   TestBlkioSetWeight
--- PASS: TestBlkioSetWeight (0.00s)
=== RUN   TestBlkioSetWeightDevice
--- PASS: TestBlkioSetWeightDevice (0.00s)
=== RUN   TestBlkioSetMultipleWeightDevice
--- PASS: TestBlkioSetMultipleWeightDevice (0.00s)
=== RUN   TestBlkioStats
--- PASS: TestBlkioStats (0.00s)
=== RUN   TestBlkioStatsNoSectorsFile
--- PASS: TestBlkioStatsNoSectorsFile (0.00s)
=== RUN   TestBlkioStatsNoServiceBytesFile
--- PASS: TestBlkioStatsNoServiceBytesFile (0.00s)
=== RUN   TestBlkioStatsNoServicedFile
--- PASS: TestBlkioStatsNoServicedFile (0.00s)
=== RUN   TestBlkioStatsNoQueuedFile
--- PASS: TestBlkioStatsNoQueuedFile (0.00s)
=== RUN   TestBlkioStatsNoServiceTimeFile
--- PASS: TestBlkioStatsNoServiceTimeFile (0.00s)
=== RUN   TestBlkioStatsNoWaitTimeFile
--- PASS: TestBlkioStatsNoWaitTimeFile (0.00s)
=== RUN   TestBlkioStatsNoMergedFile
--- PASS: TestBlkioStatsNoMergedFile (0.00s)
=== RUN   TestBlkioStatsNoTimeFile
--- PASS: TestBlkioStatsNoTimeFile (0.00s)
=== RUN   TestBlkioStatsUnexpectedNumberOfFields
--- PASS: TestBlkioStatsUnexpectedNumberOfFields (0.00s)
=== RUN   TestBlkioStatsUnexpectedFieldType
--- PASS: TestBlkioStatsUnexpectedFieldType (0.00s)
=== RUN   TestNonCFQBlkioStats
--- PASS: TestNonCFQBlkioStats (0.00s)
=== RUN   TestBlkioSetThrottleReadBpsDevice
--- PASS: TestBlkioSetThrottleReadBpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleWriteBpsDevice
--- PASS: TestBlkioSetThrottleWriteBpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleReadIOpsDevice
--- PASS: TestBlkioSetThrottleReadIOpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleWriteIOpsDevice
--- PASS: TestBlkioSetThrottleWriteIOpsDevice (0.00s)
=== RUN   TestCpuSetShares
--- PASS: TestCpuSetShares (0.00s)
=== RUN   TestCpuSetBandWidth
--- PASS: TestCpuSetBandWidth (0.00s)
=== RUN   TestCpuStats
--- PASS: TestCpuStats (0.00s)
=== RUN   TestNoCpuStatFile
--- PASS: TestNoCpuStatFile (0.00s)
=== RUN   TestInvalidCpuStat
--- PASS: TestInvalidCpuStat (0.00s)
=== RUN   TestCpuSetRtSchedAtApply
--- PASS: TestCpuSetRtSchedAtApply (0.00s)
=== RUN   TestCpusetSetCpus
--- PASS: TestCpusetSetCpus (0.00s)
=== RUN   TestCpusetSetMems
--- PASS: TestCpusetSetMems (0.00s)
=== RUN   TestDevicesSetAllow
--- PASS: TestDevicesSetAllow (0.00s)
=== RUN   TestDevicesSetDeny
--- PASS: TestDevicesSetDeny (0.00s)
=== RUN   TestFreezerSetState
--- PASS: TestFreezerSetState (0.00s)
=== RUN   TestFreezerSetInvalidState
--- PASS: TestFreezerSetInvalidState (0.00s)
=== RUN   TestHugetlbSetHugetlb
--- PASS: TestHugetlbSetHugetlb (0.00s)
=== RUN   TestHugetlbStats
--- PASS: TestHugetlbStats (0.00s)
=== RUN   TestHugetlbStatsNoUsageFile
--- PASS: TestHugetlbStatsNoUsageFile (0.00s)
=== RUN   TestHugetlbStatsNoMaxUsageFile
--- PASS: TestHugetlbStatsNoMaxUsageFile (0.00s)
=== RUN   TestHugetlbStatsBadUsageFile
--- PASS: TestHugetlbStatsBadUsageFile (0.00s)
=== RUN   TestHugetlbStatsBadMaxUsageFile
--- PASS: TestHugetlbStatsBadMaxUsageFile (0.00s)
=== RUN   TestMemorySetMemory
--- PASS: TestMemorySetMemory (0.00s)
=== RUN   TestMemorySetMemoryswap
--- PASS: TestMemorySetMemoryswap (0.00s)
=== RUN   TestMemorySetMemoryLargerThanSwap
--- PASS: TestMemorySetMemoryLargerThanSwap (0.00s)
=== RUN   TestMemorySetSwapSmallerThanMemory
--- PASS: TestMemorySetSwapSmallerThanMemory (0.00s)
=== RUN   TestMemorySetKernelMemory
--- PASS: TestMemorySetKernelMemory (0.00s)
=== RUN   TestMemorySetKernelMemoryTCP
--- PASS: TestMemorySetKernelMemoryTCP (0.00s)
=== RUN   TestMemorySetMemorySwappinessDefault
--- PASS: TestMemorySetMemorySwappinessDefault (0.00s)
=== RUN   TestMemoryStats
--- PASS: TestMemoryStats (0.00s)
=== RUN   TestMemoryStatsNoStatFile
--- PASS: TestMemoryStatsNoStatFile (0.00s)
=== RUN   TestMemoryStatsNoUsageFile
--- PASS: TestMemoryStatsNoUsageFile (0.00s)
=== RUN   TestMemoryStatsNoMaxUsageFile
--- PASS: TestMemoryStatsNoMaxUsageFile (0.00s)
=== RUN   TestMemoryStatsNoLimitInBytesFile
--- PASS: TestMemoryStatsNoLimitInBytesFile (0.00s)
=== RUN   TestMemoryStatsBadStatFile
--- PASS: TestMemoryStatsBadStatFile (0.00s)
=== RUN   TestMemoryStatsBadUsageFile
--- PASS: TestMemoryStatsBadUsageFile (0.00s)
=== RUN   TestMemoryStatsBadMaxUsageFile
--- PASS: TestMemoryStatsBadMaxUsageFile (0.00s)
=== RUN   TestMemoryStatsBadLimitInBytesFile
--- PASS: TestMemoryStatsBadLimitInBytesFile (0.00s)
=== RUN   TestMemorySetOomControl
--- PASS: TestMemorySetOomControl (0.00s)
=== RUN   TestNetClsSetClassid
--- PASS: TestNetClsSetClassid (0.00s)
=== RUN   TestNetPrioSetIfPrio
--- PASS: TestNetPrioSetIfPrio (0.00s)
=== RUN   TestPidsSetMax
--- PASS: TestPidsSetMax (0.00s)
=== RUN   TestPidsSetUnlimited
--- PASS: TestPidsSetUnlimited (0.00s)
=== RUN   TestPidsStats
--- PASS: TestPidsStats (0.00s)
=== RUN   TestPidsStatsUnlimited
--- PASS: TestPidsStatsUnlimited (0.00s)
=== RUN   TestGetCgroupParamsInt
--- PASS: TestGetCgroupParamsInt (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/cgroups/fs	0.027s
?   	github.com/nestybox/sysbox-runc/libcontainer/cgroups/systemd	[no test files]
=== RUN   TestRemoveNamespace
--- PASS: TestRemoveNamespace (0.00s)
=== RUN   TestHostRootUIDNoUSERNS
--- PASS: TestHostRootUIDNoUSERNS (0.00s)
=== RUN   TestHostRootUIDWithUSERNS
--- PASS: TestHostRootUIDWithUSERNS (0.00s)
=== RUN   TestHostRootGIDNoUSERNS
--- PASS: TestHostRootGIDNoUSERNS (0.00s)
=== RUN   TestHostRootGIDWithUSERNS
--- PASS: TestHostRootGIDWithUSERNS (0.00s)
=== RUN   TestUnmarshalHooks
--- PASS: TestUnmarshalHooks (0.00s)
=== RUN   TestUnmarshalHooksWithInvalidData
--- PASS: TestUnmarshalHooksWithInvalidData (0.00s)
=== RUN   TestMarshalHooks
--- PASS: TestMarshalHooks (0.00s)
=== RUN   TestMarshalUnmarshalHooks
--- PASS: TestMarshalUnmarshalHooks (0.00s)
=== RUN   TestMarshalHooksWithUnexpectedType
time="2020-02-02T22:07:32Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
--- PASS: TestMarshalHooksWithUnexpectedType (0.00s)
=== RUN   TestFuncHookRun
--- PASS: TestFuncHookRun (0.00s)
=== RUN   TestCommandHookRun
--- PASS: TestCommandHookRun (0.01s)
=== RUN   TestCommandHookRunTimeout
--- PASS: TestCommandHookRunTimeout (0.01s)
=== RUN   TestHelperProcess
Helper Process
ok  	github.com/nestybox/sysbox-runc/libcontainer/configs	0.027s
=== RUN   TestValidateRootlessEUID
--- PASS: TestValidateRootlessEUID (0.00s)
=== RUN   TestValidateRootlessEUIDUserns
--- PASS: TestValidateRootlessEUIDUserns (0.00s)
=== RUN   TestValidateRootlessEUIDMappingUid
--- PASS: TestValidateRootlessEUIDMappingUid (0.00s)
=== RUN   TestValidateNonZeroEUIDMappingGid
--- PASS: TestValidateNonZeroEUIDMappingGid (0.00s)
=== RUN   TestValidateRootlessEUIDMountUid
--- PASS: TestValidateRootlessEUIDMountUid (0.00s)
=== RUN   TestValidateRootlessEUIDMountGid
--- PASS: TestValidateRootlessEUIDMountGid (0.00s)
=== RUN   TestValidate
--- PASS: TestValidate (0.00s)
=== RUN   TestValidateWithInvalidRootfs
--- PASS: TestValidateWithInvalidRootfs (0.00s)
=== RUN   TestValidateNetworkWithoutNETNamespace
--- PASS: TestValidateNetworkWithoutNETNamespace (0.00s)
=== RUN   TestValidateNetworkRoutesWithoutNETNamespace
--- PASS: TestValidateNetworkRoutesWithoutNETNamespace (0.00s)
=== RUN   TestValidateHostname
--- PASS: TestValidateHostname (0.00s)
=== RUN   TestValidateHostnameWithoutUTSNamespace
--- PASS: TestValidateHostnameWithoutUTSNamespace (0.00s)
=== RUN   TestValidateSecurityWithMaskPaths
--- PASS: TestValidateSecurityWithMaskPaths (0.00s)
=== RUN   TestValidateSecurityWithROPaths
--- PASS: TestValidateSecurityWithROPaths (0.00s)
=== RUN   TestValidateSecurityWithoutNEWNS
--- PASS: TestValidateSecurityWithoutNEWNS (0.00s)
=== RUN   TestValidateUsernamespace
--- PASS: TestValidateUsernamespace (0.00s)
=== RUN   TestValidateUsernamespaceWithoutUserNS
--- PASS: TestValidateUsernamespaceWithoutUserNS (0.00s)
=== RUN   TestValidateSysctl
--- PASS: TestValidateSysctl (0.00s)
=== RUN   TestValidateValidSysctl
--- PASS: TestValidateValidSysctl (0.00s)
=== RUN   TestValidateSysctlWithSameNs
--- PASS: TestValidateSysctlWithSameNs (0.00s)
=== RUN   TestValidateSysctlWithoutNETNamespace
--- PASS: TestValidateSysctlWithoutNETNamespace (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/configs/validate	0.003s
=== RUN   TestDeviceFromPathLstatFailure
--- PASS: TestDeviceFromPathLstatFailure (0.00s)
=== RUN   TestHostDevicesIoutilReadDirFailure
--- PASS: TestHostDevicesIoutilReadDirFailure (0.00s)
=== RUN   TestHostDevicesIoutilReadDirDeepFailure
--- PASS: TestHostDevicesIoutilReadDirDeepFailure (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/devices	0.003s
=== RUN   TestExecPS
--- PASS: TestExecPS (0.12s)
=== RUN   TestIPCPrivate
--- PASS: TestIPCPrivate (0.09s)
=== RUN   TestIPCHost
--- PASS: TestIPCHost (0.06s)
=== RUN   TestIPCJoinPath
--- PASS: TestIPCJoinPath (0.07s)
=== RUN   TestIPCBadPath
--- PASS: TestIPCBadPath (0.02s)
=== RUN   TestRlimit
--- PASS: TestRlimit (0.10s)
=== RUN   TestUsernsRlimit
--- PASS: TestUsernsRlimit (0.09s)
=== RUN   TestEnter
--- PASS: TestEnter (0.10s)
=== RUN   TestProcessEnv
--- PASS: TestProcessEnv (0.08s)
=== RUN   TestProcessEmptyCaps
--- PASS: TestProcessEmptyCaps (0.10s)
=== RUN   TestProcessCaps
--- PASS: TestProcessCaps (0.09s)
=== RUN   TestAdditionalGroups
--- PASS: TestAdditionalGroups (0.07s)
=== RUN   TestFreeze
--- PASS: TestFreeze (0.08s)
=== RUN   TestSystemdFreeze
--- SKIP: TestSystemdFreeze (0.00s)
    exec_test.go:512: Systemd is unsupported
=== RUN   TestCpuShares
time="2020-02-02T22:07:36Z" level=warning msg="exit status 4"
--- PASS: TestCpuShares (0.04s)
=== RUN   TestCpuSharesSystemd
--- SKIP: TestCpuSharesSystemd (0.00s)
    exec_test.go:566: Systemd is unsupported
=== RUN   TestPids
--- PASS: TestPids (0.33s)
=== RUN   TestPidsSystemd
--- SKIP: TestPidsSystemd (0.00s)
    exec_test.go:597: Systemd is unsupported
=== RUN   TestRunWithKernelMemory
--- PASS: TestRunWithKernelMemory (0.10s)
=== RUN   TestRunWithKernelMemorySystemd
--- SKIP: TestRunWithKernelMemorySystemd (0.00s)
    exec_test.go:680: Systemd is unsupported
=== RUN   TestContainerState
--- PASS: TestContainerState (0.08s)
=== RUN   TestPassExtraFiles
--- PASS: TestPassExtraFiles (0.09s)
=== RUN   TestMountCmds
--- PASS: TestMountCmds (0.12s)
=== RUN   TestSysctl
--- PASS: TestSysctl (0.08s)
=== RUN   TestMountCgroupRO
--- PASS: TestMountCgroupRO (0.09s)
=== RUN   TestMountCgroupRW
--- PASS: TestMountCgroupRW (0.08s)
=== RUN   TestOomScoreAdj
--- PASS: TestOomScoreAdj (0.07s)
=== RUN   TestHook
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:37Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
--- PASS: TestHook (0.11s)
=== RUN   TestSTDIOPermissions
--- PASS: TestSTDIOPermissions (0.08s)
=== RUN   TestRootfsPropagationSlaveMount
--- PASS: TestRootfsPropagationSlaveMount (0.09s)
=== RUN   TestRootfsPropagationSharedMount
--- PASS: TestRootfsPropagationSharedMount (0.15s)
=== RUN   TestPIDHost
--- SKIP: TestPIDHost (0.00s)
    exec_test.go:1498: not applicable
=== RUN   TestInitJoinPID
--- PASS: TestInitJoinPID (0.18s)
=== RUN   TestInitJoinNetworkAndUser
--- PASS: TestInitJoinNetworkAndUser (0.17s)
=== RUN   TestTmpfsCopyUp
--- PASS: TestTmpfsCopyUp (0.09s)
=== RUN   TestCGROUPPrivate
--- PASS: TestCGROUPPrivate (0.08s)
=== RUN   TestCGROUPHost
--- PASS: TestCGROUPHost (0.07s)
=== RUN   TestExecIn
--- PASS: TestExecIn (0.12s)
=== RUN   TestExecInUsernsRlimit
--- PASS: TestExecInUsernsRlimit (0.12s)
=== RUN   TestExecInRlimit
--- PASS: TestExecInRlimit (0.14s)
=== RUN   TestExecInAdditionalGroups
--- PASS: TestExecInAdditionalGroups (0.12s)
=== RUN   TestExecInError
--- PASS: TestExecInError (1.11s)
=== RUN   TestExecInTTY
--- PASS: TestExecInTTY (0.13s)
=== RUN   TestExecInEnvironment
--- PASS: TestExecInEnvironment (0.11s)
=== RUN   TestExecinPassExtraFiles
--- PASS: TestExecinPassExtraFiles (0.12s)
=== RUN   TestExecInOomScoreAdj
--- PASS: TestExecInOomScoreAdj (0.11s)
=== RUN   TestExecInUserns
--- PASS: TestExecInUserns (0.12s)
=== RUN   TestSeccompDenyGetcwd
--- PASS: TestSeccompDenyGetcwd (0.08s)
=== RUN   TestSeccompPermitWriteConditional
--- PASS: TestSeccompPermitWriteConditional (0.10s)
=== RUN   TestSeccompDenyWriteConditional
--- PASS: TestSeccompDenyWriteConditional (0.09s)
=== RUN   TestSeccompPermitWriteMultipleConditions
--- PASS: TestSeccompPermitWriteMultipleConditions (0.09s)
=== RUN   TestSeccompDenyWriteMultipleConditions
--- PASS: TestSeccompDenyWriteMultipleConditions (0.10s)
=== RUN   TestSeccompMultipleConditionSameArgDeniesStdout
--- PASS: TestSeccompMultipleConditionSameArgDeniesStdout (0.09s)
=== RUN   TestSeccompMultipleConditionSameArgDeniesStderr
--- PASS: TestSeccompMultipleConditionSameArgDeniesStderr (0.07s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/integration	6.027s
=== RUN   TestIntelRdtSetL3CacheSchema
--- PASS: TestIntelRdtSetL3CacheSchema (0.00s)
=== RUN   TestIntelRdtSetMemBwSchema
--- PASS: TestIntelRdtSetMemBwSchema (0.00s)
=== RUN   TestIntelRdtSetMemBwScSchema
--- PASS: TestIntelRdtSetMemBwScSchema (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/intelrdt	0.005s
?   	github.com/nestybox/sysbox-runc/libcontainer/keys	[no test files]
?   	github.com/nestybox/sysbox-runc/libcontainer/mount	[no test files]
=== RUN   TestNsenterValidPaths
--- PASS: TestNsenterValidPaths (0.03s)
=== RUN   TestNsenterInvalidPaths
--- PASS: TestNsenterInvalidPaths (0.02s)
=== RUN   TestNsenterIncorrectPathType
--- PASS: TestNsenterIncorrectPathType (0.01s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/nsenter	0.064s
=== RUN   TestParseStatusFile
--- PASS: TestParseStatusFile (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/seccomp	0.017s
=== RUN   TestCreateCommandHookTimeout
--- PASS: TestCreateCommandHookTimeout (0.00s)
=== RUN   TestCreateHooks
--- PASS: TestCreateHooks (0.00s)
=== RUN   TestSetupSeccomp
--- PASS: TestSetupSeccomp (0.00s)
=== RUN   TestLinuxCgroupWithMemoryResource
--- PASS: TestLinuxCgroupWithMemoryResource (0.00s)
=== RUN   TestLinuxCgroupSystemd
--- PASS: TestLinuxCgroupSystemd (0.00s)
=== RUN   TestLinuxCgroupSystemdWithEmptyPath
--- PASS: TestLinuxCgroupSystemdWithEmptyPath (0.00s)
=== RUN   TestLinuxCgroupSystemdWithInvalidPath
--- PASS: TestLinuxCgroupSystemdWithInvalidPath (0.00s)
=== RUN   TestLinuxCgroupsPathSpecified
--- PASS: TestLinuxCgroupsPathSpecified (0.00s)
=== RUN   TestLinuxCgroupsPathNotSpecified
--- PASS: TestLinuxCgroupsPathNotSpecified (0.00s)
=== RUN   TestSpecconvExampleValidate
--- PASS: TestSpecconvExampleValidate (0.00s)
=== RUN   TestDupNamespaces
--- PASS: TestDupNamespaces (0.00s)
=== RUN   TestNonZeroEUIDCompatibleSpecconvValidate
--- PASS: TestNonZeroEUIDCompatibleSpecconvValidate (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/specconv	0.015s
=== RUN   TestCaptureTestFunc
--- PASS: TestCaptureTestFunc (0.00s)
=== RUN   TestParsePackageName
--- PASS: TestParsePackageName (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/stacktrace	0.007s
=== RUN   TestUIDMapInUserNS
--- PASS: TestUIDMapInUserNS (0.00s)
=== RUN   TestParseStartTime
--- PASS: TestParseStartTime (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/system	0.005s
=== RUN   TestUserParseLine
--- PASS: TestUserParseLine (0.00s)
=== RUN   TestUserParsePasswd
--- PASS: TestUserParsePasswd (0.00s)
=== RUN   TestUserParseGroup
--- PASS: TestUserParseGroup (0.00s)
=== RUN   TestValidGetExecUser
--- PASS: TestValidGetExecUser (0.00s)
=== RUN   TestInvalidGetExecUser
--- PASS: TestInvalidGetExecUser (0.00s)
=== RUN   TestGetExecUserNilSources
--- PASS: TestGetExecUserNilSources (0.00s)
=== RUN   TestGetAdditionalGroups
--- PASS: TestGetAdditionalGroups (0.00s)
=== RUN   TestGetAdditionalGroupsNumeric
--- PASS: TestGetAdditionalGroupsNumeric (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/user	0.009s
=== RUN   TestSearchLabels
--- PASS: TestSearchLabels (0.00s)
=== RUN   TestResolveRootfs
--- PASS: TestResolveRootfs (0.00s)
=== RUN   TestResolveRootfsWithSymlink
--- PASS: TestResolveRootfsWithSymlink (0.00s)
=== RUN   TestResolveRootfsWithNonExistingDir
--- PASS: TestResolveRootfsWithNonExistingDir (0.00s)
=== RUN   TestExitStatus
--- PASS: TestExitStatus (0.00s)
=== RUN   TestExitStatusSignaled
--- PASS: TestExitStatusSignaled (0.00s)
=== RUN   TestWriteJSON
--- PASS: TestWriteJSON (0.00s)
=== RUN   TestCleanPath
--- PASS: TestCleanPath (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/utils	0.013s
?   	github.com/nestybox/sysbox-runc/libsysbox/shiftfs	[no test files]
?   	github.com/nestybox/sysbox-runc/libsysbox/sysbox	[no test files]
=== RUN   TestCfgSeccomp
--- PASS: TestCfgSeccomp (0.00s)
=== RUN   TestCfgLibModMount
--- PASS: TestCfgLibModMount (0.00s)
=== RUN   TestCfgMaskedPaths
--- PASS: TestCfgMaskedPaths (0.00s)
=== RUN   TestCfgReadonlyPaths
--- PASS: TestCfgReadonlyPaths (0.00s)
=== RUN   TestCfgSysboxFsMounts
--- PASS: TestCfgSysboxFsMounts (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libsysbox/syscont	0.010s
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localintegration TESTPATH=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
bats -t tests/integration
1..101
ok 1 runc update --kernel-memory (initialized)
ok 2 runc update --kernel-memory (uninitialized)
ok 3 runc create (no limits + no cgrouppath + no permission) succeeds
ok 4 # skip (test requires rootless) runc create (rootless + no limits + cgrouppath + no permission) fails with permission error
ok 5 # skip (test requires rootless) runc create (rootless + limits + no cgrouppath + no permission) fails with informative error
ok 6 runc create (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 7 runc exec (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 8 # skip (sysbox-runc unsupported feature) checkpoint and restore
ok 9 # skip (sysbox-runc unsupported feature) checkpoint --pre-dump and restore
ok 10 # skip (sysbox-runc unsupported feature) checkpoint --lazy-pages and restore
ok 11 # skip (sysbox-runc unsupported feature) checkpoint and restore in external network namespace
ok 12 # skip (sysbox-runc unsupported feature) checkpoint and restore with container specific CRIU config
ok 13 runc create
ok 14 runc create exec
ok 15 runc create --pid-file
ok 16 runc create --pid-file with new CWD
ok 17 global --debug
ok 18 global --debug to --log
ok 19 global --debug to --log --log-format 'text'
ok 20 global --debug to --log --log-format 'json'
ok 21 runc delete
ok 22 runc delete --force
ok 23 runc delete --force ignore not exist
ok 24 events --stats
ok 25 events --interval default
ok 26 events --interval 1s
ok 27 events --interval 100ms
ok 28 runc exec
ok 29 runc exec --pid-file
ok 30 runc exec --pid-file with new CWD
ok 31 runc exec ls -la
ok 32 runc exec ls -la with --cwd
ok 33 runc exec --env
ok 34 runc exec --user
ok 35 runc exec --additional-gids
ok 36 runc exec --preserve-fds
ok 37 runc -h
ok 38 runc command -h
ok 39 runc foo -h
ok 40 kill detached busybox
ok 41 list
ok 42 mask paths [file]
ok 43 mask paths [directory]
ok 44 bind mount
ok 45 bind mount above rootfs
ok 46 bind mount directly above rootfs
ok 47 bind mount below the rootfs
ok 48 rootfs on tmpfs
ok 49 bind mount on tmpfs
ok 50 runc pause and resume
ok 51 runc pause and resume with nonexist container
ok 52 ps
ok 53 ps -f json
ok 54 ps -e
ok 55 global --root
ok 56 spec generation cwd
ok 57 spec generation --bundle
ok 58 # skip (needs re-work due to migration to go-modules) spec validator
ok 59 # skip (not written yet) spec process validator
ok 60 # skip (not written yet) spec read-only path filtering
ok 61 # skip (not written yet) spec masked path filtering
ok 62 runc start
ok 63 runc run detached
ok 64 runc run detached ({u,g}id != 0)
ok 65 runc run detached --pid-file
ok 66 runc run detached --pid-file with new CWD
ok 67 runc run
ok 68 runc run ({u,g}id != 0)
ok 69 runc run with rootfs set to .
ok 70 runc run --pid-file
ok 71 state (kill + delete)
ok 72 state (pause + resume)
ok 73 syscont: root process caps
ok 74 syscont: exec root process caps
ok 75 syscont: exec non-root process caps
ok 76 syscont: exec non-root process caps
ok 77 syscont: cgroup mounts
ok 78 syscont: cgroup create
ok 79 # skip (wait until sysbox implements intercept of mount syscall) syscont: inner container procfs
ok 80 syscont: /lib/modules/<kernel-release> mount
ok 81 # skip (not written yet) syscont: disallowed mounts
ok 82 # skip (not written yet) syscont: sysbox-fs mounts
ok 83 # skip (wait until sysbox implements intercept of mount syscall) syscont: sysbox-fs can't be unmounted
ok 84 # skip (wait until sysbox implements intercept of umount syscall) syscont: procfs remount
ok 85 syscont: uses all namespaces
ok 86 syscont: unshare
ok 87 syscont: syscall: mount and umount
ok 88 syscont uid/gid mappings
ok 89 runc run [tty ptsname]
ok 90 runc run [tty owner]
ok 91 runc run [tty owner] ({u,g}id != 0)
ok 92 runc exec [tty ptsname]
ok 93 runc exec [tty owner]
ok 94 runc exec [tty owner] ({u,g}id != 0)
ok 95 runc exec [tty consolesize]
ok 96 runc create [terminal=false]
ok 97 runc run [terminal=false]
ok 98 runc run -d [terminal=false]
ok 99 update
ok 100 # skip (Test requires cgroups_rt) update rt period and runtime
ok 101 # skip (fails when git change is pending) runc version
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localintegration-shiftuid TESTPATH=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
SHIFT_UIDS=true bats -t tests/integration
1..101
ok 1 runc update --kernel-memory (initialized)
ok 2 runc update --kernel-memory (uninitialized)
ok 3 runc create (no limits + no cgrouppath + no permission) succeeds
ok 4 # skip (test requires rootless) runc create (rootless + no limits + cgrouppath + no permission) fails with permission error
ok 5 # skip (test requires rootless) runc create (rootless + limits + no cgrouppath + no permission) fails with informative error
ok 6 runc create (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 7 runc exec (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 8 # skip (sysbox-runc unsupported feature) checkpoint and restore
ok 9 # skip (sysbox-runc unsupported feature) checkpoint --pre-dump and restore
ok 10 # skip (sysbox-runc unsupported feature) checkpoint --lazy-pages and restore
ok 11 # skip (sysbox-runc unsupported feature) checkpoint and restore in external network namespace
ok 12 # skip (sysbox-runc unsupported feature) checkpoint and restore with container specific CRIU config
ok 13 runc create
ok 14 runc create exec
ok 15 runc create --pid-file
ok 16 runc create --pid-file with new CWD
ok 17 global --debug
ok 18 global --debug to --log
ok 19 global --debug to --log --log-format 'text'
ok 20 global --debug to --log --log-format 'json'
ok 21 runc delete
ok 22 runc delete --force
ok 23 runc delete --force ignore not exist
ok 24 events --stats
ok 25 events --interval default
ok 26 events --interval 1s
ok 27 events --interval 100ms
ok 28 runc exec
ok 29 runc exec --pid-file
ok 30 runc exec --pid-file with new CWD
ok 31 runc exec ls -la
ok 32 runc exec ls -la with --cwd
ok 33 runc exec --env
ok 34 runc exec --user
ok 35 runc exec --additional-gids
ok 36 runc exec --preserve-fds
ok 37 runc -h
ok 38 runc command -h
ok 39 runc foo -h
ok 40 kill detached busybox
ok 41 list
ok 42 mask paths [file]
ok 43 mask paths [directory]
ok 44 bind mount
ok 45 bind mount above rootfs
ok 46 bind mount directly above rootfs
ok 47 bind mount below the rootfs
ok 48 rootfs on tmpfs
ok 49 bind mount on tmpfs
ok 50 runc pause and resume
ok 51 runc pause and resume with nonexist container
ok 52 ps
ok 53 ps -f json
ok 54 ps -e
ok 55 global --root
ok 56 spec generation cwd
ok 57 spec generation --bundle
ok 58 # skip (needs re-work due to migration to go-modules) spec validator
ok 59 # skip (not written yet) spec process validator
ok 60 # skip (not written yet) spec read-only path filtering
ok 61 # skip (not written yet) spec masked path filtering
ok 62 runc start
ok 63 runc run detached
ok 64 runc run detached ({u,g}id != 0)
ok 65 runc run detached --pid-file
ok 66 runc run detached --pid-file with new CWD
ok 67 runc run
ok 68 runc run ({u,g}id != 0)
ok 69 runc run with rootfs set to .
ok 70 runc run --pid-file
ok 71 state (kill + delete)
ok 72 state (pause + resume)
ok 73 syscont: root process caps
ok 74 syscont: exec root process caps
ok 75 syscont: exec non-root process caps
ok 76 syscont: exec non-root process caps
ok 77 syscont: cgroup mounts
ok 78 syscont: cgroup create
ok 79 # skip (wait until sysbox implements intercept of mount syscall) syscont: inner container procfs
ok 80 syscont: /lib/modules/<kernel-release> mount
ok 81 # skip (not written yet) syscont: disallowed mounts
ok 82 # skip (not written yet) syscont: sysbox-fs mounts
ok 83 # skip (wait until sysbox implements intercept of mount syscall) syscont: sysbox-fs can't be unmounted
ok 84 # skip (wait until sysbox implements intercept of umount syscall) syscont: procfs remount
ok 85 syscont: uses all namespaces
ok 86 syscont: unshare
ok 87 syscont: syscall: mount and umount
ok 88 syscont uid/gid mappings
ok 89 runc run [tty ptsname]
ok 90 runc run [tty owner]
ok 91 runc run [tty owner] ({u,g}id != 0)
ok 92 runc exec [tty ptsname]
ok 93 runc exec [tty owner]
ok 94 runc exec [tty owner] ({u,g}id != 0)
ok 95 runc exec [tty consolesize]
ok 96 runc create [terminal=false]
ok 97 runc run [terminal=false]
ok 98 runc run -d [terminal=false]
ok 99 update
ok 100 # skip (Test requires cgroups_rt) update rt period and runtime
ok 101 # skip (fails when git change is pending) runc version
make[2]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'

** Running sysbox integration tests **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "testContainerInit && make test-sysbox-local TESTPATH="
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'sysbox-runc' is up to date.
make[1]: 'sysbox-fs' is up to date.
make[1]: 'sysbox-mgr' is up to date.
install -D -m0755 sysbox-fs/sysbox-fs /usr/local/sbin/sysbox-fs
install -D -m0755 sysbox-mgr/sysbox-mgr /usr/local/sbin/sysbox-mgr
install -D -m0755 sysbox-runc/sysbox-runc /usr/local/sbin/sysbox-runc
install -D -m0755 bin/sysbox /usr/local/sbin/sysbox
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 # skip (uid shifting disabled) uid alloc basic
ok 8 # skip (uid shifting disabled) uid exhaust
ok 9 # skip (uid shifting disabled) uid reuse
ok 10 # skip (needs UID shifting) shiftfsMgr basic
ok 11 # skip (needs UID shifting) shiftfsMgr multiple syscont
ok 12 # skip (needs UID shifting) shiftfsMgr skip shiftfs on bind-mount
ok 13 # skip (needs UID shifting) shiftfsMgr shiftfs file mount
ok 14 # skip (needs UID shifting) shiftfsMgr shiftfs no-exec on host
ok 15 # skip (needs UID shifting) shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic

** Running sysbox integration tests (with uid shifting) **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "export SHIFT_UIDS=true && testContainerInit && make test-sysbox-local TESTPATH="
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'sysbox-runc' is up to date.
make[1]: 'sysbox-fs' is up to date.
make[1]: 'sysbox-mgr' is up to date.
install -D -m0755 sysbox-fs/sysbox-fs /usr/local/sbin/sysbox-fs
install -D -m0755 sysbox-mgr/sysbox-mgr /usr/local/sbin/sysbox-mgr
install -D -m0755 sysbox-runc/sysbox-runc /usr/local/sbin/sysbox-runc
install -D -m0755 bin/sysbox /usr/local/sbin/sysbox
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 uid alloc basic
ok 8 uid exhaust
ok 9 uid reuse
ok 10 shiftfsMgr basic
ok 11 shiftfsMgr multiple syscont
ok 12 shiftfsMgr skip shiftfs on bind-mount
ok 13 shiftfsMgr shiftfs file mount
ok 14 shiftfsMgr shiftfs no-exec on host
ok 15 shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
vagrant@ubuntu-disco-vm:~/wsp/v0.1.3/sysbox$



vagrant@ubuntu-disco-vm:~/wsp/v0.1.3/sysbox$ make test-installer
make test-cntr-installer
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:disco
 ---> c88ac1f841b7
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> ba92a41dfe11
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> b6e2c49a22d8
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> 7f90fef39941
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> c4da22cf8bb1
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> c353a26a4189
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 19d0857dd517
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 15657850fa8a
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> bca09701920e
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> 4e8c7d937a13
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 86b024beee71
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> b061c925699f
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         $(lsb_release -cs)         stable"
 ---> Using cache
 ---> c6d81ab840db
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> 3edf90ca0190
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> 062c81587a95
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> cbb384ed996a
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> d26d6c658be9
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> 79c985208b1b
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> 93b93af86890
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> 7cc2896b1a43
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> 2c75eb054275
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> 586bd75cb66e
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> 846742d75dae
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> 5a85a2fabe3e
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> b70fcd6bda5b
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> bf9e3a058d23
Successfully built bf9e3a058d23
Successfully tagged sysbox-test:latest

** Building the test-installer container image**

Sending build context to Docker daemon  240.6kB
Step 1/5 : FROM sysbox-test:latest
 ---> bf9e3a058d23
Step 2/5 : RUN apt-get update &&                                apt-get install -y --no-install-recommends               systemd                                          systemd-sysv                                     libsystemd0                                      ca-certificates                                  dbus                                             iptables                                         iproute2                                         kmod                                             locales                                          sudo                                             udev &&                                                                                   echo "ReadKMsg=no" >> /etc/systemd/journald.conf &&                                                                                         systemctl mask getty@tty1.service getty-static.service &&                                                                                   apt-get clean -y &&                                                   rm -rf                                                                   /var/cache/debconf/*                                                  /var/lib/apt/lists/*                                                  /var/log/*                                                            /tmp/*                                                                /var/tmp/*                                                            /usr/share/doc/*                                                      /usr/share/man/*                                                      /usr/share/local/* &&                                                                                                                    useradd --create-home --shell /bin/bash admin && echo "admin:admin" |         chpasswd && adduser admin sudo
 ---> Using cache
 ---> d31df00714af
Step 3/5 : STOPSIGNAL SIGRTMIN+3
 ---> Using cache
 ---> 63b084cd2333
Step 4/5 : ENV container docker
 ---> Using cache
 ---> e881c3f810f8
Step 5/5 : ENTRYPOINT [ "/sbin/init" ]
 ---> Using cache
 ---> bdb376e50d68
Successfully built bdb376e50d68
Successfully tagged sysbox-installer-test:latest
docker run -d --rm --privileged --hostname sysbox-installer-test --name sysbox-installer-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod --mount type=tmpfs,destination=/run --mount type=tmpfs,destination=/run/lock --mount type=tmpfs,destination=/tmp sysbox-installer-test
5bc8ee0479e467ae845a80c6df5f9c0f76fe0642dcde6212fa7828e3ead38fba

** Installing sysbox deb package **

docker exec -it sysbox-installer-test /bin/bash -c "rm -rf /usr/sbin/policy-rc.d && \
	DEBIAN_FRONTEND=noninteractive dpkg -i image/deb/debbuild/ubuntu-disco/sysbox_0.1.3-0.ubuntu-disco_amd64.deb"
Selecting previously unselected package sysbox.
(Reading database ... 25084 files and directories currently installed.)
Preparing to unpack .../sysbox_0.1.3-0.ubuntu-disco_amd64.deb ...
Unpacking sysbox (0.1.3-0.ubuntu-disco) ...
Setting up sysbox (0.1.3-0.ubuntu-disco) ...
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-fs.service → /lib/systemd/system/sysbox-fs.service.
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-mgr.service → /lib/systemd/system/sysbox-mgr.service.
Created symlink /etc/systemd/system/multi-user.target.wants/sysbox.service → /lib/systemd/system/sysbox.service.
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"default-runtime\": \"sysbox-runc\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Running sysbox integration tests **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker exec -it sysbox-installer-test make sysbox-runc-recvtty
make[1]: Entering directory '/root/nestybox/sysbox/sysbox-runc'
go build -buildmode=pie  -ldflags "-X main.gitCommit="6faf2581e728e442afa244508cbbed64bccaaadb" -X main.version=0.1.3 " -tags "seccomp" -o contrib/cmd/recvtty/recvtty ./contrib/cmd/recvtty
make[1]: Leaving directory '/root/nestybox/sysbox/sysbox-runc'
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"userns-remap\": \"sysbox\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
docker exec -it sysbox-installer-test /bin/bash -c "export SB_INSTALLER=true && \
	make test-sysbox-local TESTPATH="
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 # skip (uid shifting disabled) uid alloc basic
ok 8 # skip (uid shifting disabled) uid exhaust
ok 9 # skip (uid shifting disabled) uid reuse
ok 10 # skip (needs UID shifting) shiftfsMgr basic
ok 11 # skip (needs UID shifting) shiftfsMgr multiple syscont
ok 12 # skip (needs UID shifting) shiftfsMgr skip shiftfs on bind-mount
ok 13 # skip (needs UID shifting) shiftfsMgr shiftfs file mount
ok 14 # skip (needs UID shifting) shiftfsMgr shiftfs no-exec on host
ok 15 # skip (needs UID shifting) shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
docker stop sysbox-installer-test
sysbox-installer-test
make test-cntr-installer
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:disco
 ---> c88ac1f841b7
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> ba92a41dfe11
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> b6e2c49a22d8
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> 7f90fef39941
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> c4da22cf8bb1
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> c353a26a4189
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 19d0857dd517
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 15657850fa8a
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> bca09701920e
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> 4e8c7d937a13
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 86b024beee71
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> b061c925699f
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         $(lsb_release -cs)         stable"
 ---> Using cache
 ---> c6d81ab840db
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> 3edf90ca0190
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> 062c81587a95
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> cbb384ed996a
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> d26d6c658be9
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> 79c985208b1b
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> 93b93af86890
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> 7cc2896b1a43
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> 2c75eb054275
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> 586bd75cb66e
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> 846742d75dae
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> 5a85a2fabe3e
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> b70fcd6bda5b
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> bf9e3a058d23
Successfully built bf9e3a058d23
Successfully tagged sysbox-test:latest

** Building the test-installer container image**

Sending build context to Docker daemon  240.6kB
Step 1/5 : FROM sysbox-test:latest
 ---> bf9e3a058d23
Step 2/5 : RUN apt-get update &&                                apt-get install -y --no-install-recommends               systemd                                          systemd-sysv                                     libsystemd0                                      ca-certificates                                  dbus                                             iptables                                         iproute2                                         kmod                                             locales                                          sudo                                             udev &&                                                                                   echo "ReadKMsg=no" >> /etc/systemd/journald.conf &&                                                                                         systemctl mask getty@tty1.service getty-static.service &&                                                                                   apt-get clean -y &&                                                   rm -rf                                                                   /var/cache/debconf/*                                                  /var/lib/apt/lists/*                                                  /var/log/*                                                            /tmp/*                                                                /var/tmp/*                                                            /usr/share/doc/*                                                      /usr/share/man/*                                                      /usr/share/local/* &&                                                                                                                    useradd --create-home --shell /bin/bash admin && echo "admin:admin" |         chpasswd && adduser admin sudo
 ---> Using cache
 ---> d31df00714af
Step 3/5 : STOPSIGNAL SIGRTMIN+3
 ---> Using cache
 ---> 63b084cd2333
Step 4/5 : ENV container docker
 ---> Using cache
 ---> e881c3f810f8
Step 5/5 : ENTRYPOINT [ "/sbin/init" ]
 ---> Using cache
 ---> bdb376e50d68
Successfully built bdb376e50d68
Successfully tagged sysbox-installer-test:latest
docker run -d --rm --privileged --hostname sysbox-installer-test --name sysbox-installer-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod --mount type=tmpfs,destination=/run --mount type=tmpfs,destination=/run/lock --mount type=tmpfs,destination=/tmp sysbox-installer-test
0d86e8335e691fe879ff5817d3045c7ca37fad24352dc17719f5c587d2b8fbda

** Installing sysbox deb package **

docker exec -it sysbox-installer-test /bin/bash -c "rm -rf /usr/sbin/policy-rc.d && \
	DEBIAN_FRONTEND=noninteractive dpkg -i image/deb/debbuild/ubuntu-disco/sysbox_0.1.3-0.ubuntu-disco_amd64.deb"
Selecting previously unselected package sysbox.
(Reading database ... 25084 files and directories currently installed.)
Preparing to unpack .../sysbox_0.1.3-0.ubuntu-disco_amd64.deb ...
Unpacking sysbox (0.1.3-0.ubuntu-disco) ...
Setting up sysbox (0.1.3-0.ubuntu-disco) ...
/var/lib/dpkg/info/sysbox.postinst: line 83: kill: (218) - No such process
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-fs.service → /lib/systemd/system/sysbox-fs.service.
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-mgr.service → /lib/systemd/system/sysbox-mgr.service.
Created symlink /etc/systemd/system/multi-user.target.wants/sysbox.service → /lib/systemd/system/sysbox.service.
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"default-runtime\": \"sysbox-runc\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Running sysbox-installer integration tests (with uid shifting) **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker exec -it sysbox-installer-test make sysbox-runc-recvtty
make[1]: Entering directory '/root/nestybox/sysbox/sysbox-runc'
make[1]: Nothing to be done for 'recvtty'.
make[1]: Leaving directory '/root/nestybox/sysbox/sysbox-runc'
docker exec -it sysbox-installer-test /bin/bash -c "export SB_INSTALLER=true SHIFT_UIDS=true && \
	make test-sysbox-local TESTPATH="
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 uid alloc basic
ok 8 uid exhaust
ok 9 uid reuse
ok 10 shiftfsMgr basic
ok 11 shiftfsMgr multiple syscont
ok 12 shiftfsMgr skip shiftfs on bind-mount
ok 13 shiftfsMgr shiftfs file mount
ok 14 shiftfsMgr shiftfs no-exec on host
ok 15 shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
docker stop sysbox-installer-test
sysbox-installer-test
vagrant@ubuntu-disco-vm:~/wsp/v0.1.3/sysbox$
```


# Ubuntu Eoan VM



```
vagrant@ubuntu-eoan-vm:~/wsp/v0.1.3/sysbox$ make test

** Building the test container **

Sending build context to Docker daemon  245.8kB
Step 1/26 : FROM ubuntu:eoan
 ---> dcbcfdcd50bb
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> 662940f2e4c3
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> 4f9cfc74b920
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> de8b002c44e6
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> d2703149a986
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> 3e3cfb7fba24
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 3dc7695c9435
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 7f39d1d03298
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> 10aab5648b7e
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> a8ac58f28b67
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> e8f573ed7a91
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> fbc6391dd33f
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         disco         stable"
 ---> Using cache
 ---> 86a4f1b76eed
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> d87251dff46b
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> 5abd4ea04272
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> 68c181f436b6
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> 78ed9f0263fe
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> 956aa722aa92
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> 6347f0b6c5df
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> b1a3440e8b4f
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> 2a6dc283d723
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> e42576e2e4dc
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> 7aac62aa9043
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> cba8c36f67fe
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> 98902c113e1e
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> a2fdee663281
Successfully built a2fdee663281
Successfully tagged sysbox-test:latest

** Running sysbox-fs unit tests **

docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "make --no-print-directory test-fs-local"
make[1]: 'protobuf.pb.go' is up to date.
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
cd sysbox-fs && go test -timeout 3m -v github.com/nestybox/sysbox-fs/cmd/sysbox-fs github.com/nestybox/sysbox-fs/domain github.com/nestybox/sysbox-fs/fuse github.com/nestybox/sysbox-fs/handler github.com/nestybox/sysbox-fs/handler/implementations github.com/nestybox/sysbox-fs/ipc github.com/nestybox/sysbox-fs/mocks github.com/nestybox/sysbox-fs/nsenter github.com/nestybox/sysbox-fs/state github.com/nestybox/sysbox-fs/sysio
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
=== RUN   Test_signalHandler
--- PASS: Test_signalHandler (0.00s)
=== RUN   Test_main
--- PASS: Test_main (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/cmd/sysbox-fs	0.005s
?   	github.com/nestybox/sysbox-fs/domain	[no test files]
=== RUN   TestNewFuseService
=== RUN   TestNewFuseService/1
=== RUN   TestNewFuseService/2
--- PASS: TestNewFuseService (0.00s)
    --- PASS: TestNewFuseService/1 (0.00s)
    --- PASS: TestNewFuseService/2 (0.00s)
=== RUN   Test_fuseService_Run
--- SKIP: Test_fuseService_Run (0.00s)
    server_test.go:75: Skipping fuseService.Runc() for now
=== RUN   Test_fuseService_Root
--- PASS: Test_fuseService_Root (0.00s)
=== RUN   Test_fuseService_MountPoint
--- PASS: Test_fuseService_MountPoint (0.00s)
=== RUN   Test_fuseService_Unmount
--- PASS: Test_fuseService_Unmount (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/fuse	0.013s
?   	github.com/nestybox/sysbox-fs/handler	[no test files]
=== RUN   TestCommonHandler_Lookup
=== RUN   TestCommonHandler_Lookup/1
=== RUN   TestCommonHandler_Lookup/2
=== RUN   TestCommonHandler_Lookup/3
--- PASS: TestCommonHandler_Lookup (0.00s)
    --- PASS: TestCommonHandler_Lookup/1 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Lookup/2 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Lookup/3 (0.00s)
        common_test.go:198: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:198: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:198: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_Getattr
=== RUN   TestCommonHandler_Getattr/1
=== RUN   TestCommonHandler_Getattr/2
--- PASS: TestCommonHandler_Getattr (0.00s)
    --- PASS: TestCommonHandler_Getattr/1 (0.00s)
    --- PASS: TestCommonHandler_Getattr/2 (0.00s)
=== RUN   TestCommonHandler_Read
=== RUN   TestCommonHandler_Read/1
=== RUN   TestCommonHandler_Read/2
=== RUN   TestCommonHandler_Read/3
--- PASS: TestCommonHandler_Read (0.00s)
    --- PASS: TestCommonHandler_Read/1 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Read/2 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Read/3 (0.00s)
        common_test.go:508: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:508: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:508: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_Write
=== RUN   TestCommonHandler_Write/1
=== RUN   TestCommonHandler_Write/2
=== RUN   TestCommonHandler_Write/3
--- PASS: TestCommonHandler_Write (0.00s)
    --- PASS: TestCommonHandler_Write/1 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Write/2 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_Write/3 (0.00s)
        common_test.go:677: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:677: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:677: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_ReadDirAll
=== RUN   TestCommonHandler_ReadDirAll/1
=== RUN   TestCommonHandler_ReadDirAll/2
=== RUN   TestCommonHandler_ReadDirAll/3
--- PASS: TestCommonHandler_ReadDirAll (0.00s)
    --- PASS: TestCommonHandler_ReadDirAll/1 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_ReadDirAll/2 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
    --- PASS: TestCommonHandler_ReadDirAll/3 (0.00s)
        common_test.go:875: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:875: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:875: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_EmulatedFilesInfo
=== RUN   TestCommonHandler_EmulatedFilesInfo/1
--- PASS: TestCommonHandler_EmulatedFilesInfo (0.00s)
    --- PASS: TestCommonHandler_EmulatedFilesInfo/1 (0.00s)
=== RUN   TestCommonHandler_FetchFile
=== RUN   TestCommonHandler_FetchFile/1
--- PASS: TestCommonHandler_FetchFile (0.00s)
    --- PASS: TestCommonHandler_FetchFile/1 (0.00s)
        common_test.go:1097: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:1097: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:1097: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_PushFile
=== RUN   TestCommonHandler_PushFile/1
--- PASS: TestCommonHandler_PushFile (0.00s)
    --- PASS: TestCommonHandler_PushFile/1 (0.00s)
        common_test.go:1226: PASS:	NewEvent(string,uint32,[]string,*domain.NSenterMessage,*domain.NSenterMessage)
        common_test.go:1226: PASS:	LaunchEvent(*nsenter.NSenterEvent)
        common_test.go:1226: PASS:	ResponseEvent(*nsenter.NSenterEvent)
=== RUN   TestCommonHandler_GetName
=== RUN   TestCommonHandler_GetName/1
--- PASS: TestCommonHandler_GetName (0.00s)
    --- PASS: TestCommonHandler_GetName/1 (0.00s)
=== RUN   TestCommonHandler_GetPath
=== RUN   TestCommonHandler_GetPath/1
--- PASS: TestCommonHandler_GetPath (0.00s)
    --- PASS: TestCommonHandler_GetPath/1 (0.00s)
=== RUN   TestCommonHandler_GetEnabled
=== RUN   TestCommonHandler_GetEnabled/1
--- PASS: TestCommonHandler_GetEnabled (0.00s)
    --- PASS: TestCommonHandler_GetEnabled/1 (0.00s)
=== RUN   TestCommonHandler_GetService
=== RUN   TestCommonHandler_GetService/1
--- PASS: TestCommonHandler_GetService (0.00s)
    --- PASS: TestCommonHandler_GetService/1 (0.00s)
=== RUN   TestCommonHandler_SetEnabled
=== RUN   TestCommonHandler_SetEnabled/1
--- PASS: TestCommonHandler_SetEnabled (0.00s)
    --- PASS: TestCommonHandler_SetEnabled/1 (0.00s)
=== RUN   TestCommonHandler_SetService
=== RUN   TestCommonHandler_SetService/1
--- PASS: TestCommonHandler_SetService (0.00s)
    --- PASS: TestCommonHandler_SetService/1 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Lookup
=== RUN   TestNfConntrackMaxHandler_Lookup/1
--- PASS: TestNfConntrackMaxHandler_Lookup (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Lookup/1 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Getattr
=== RUN   TestNfConntrackMaxHandler_Getattr/1
=== RUN   TestNfConntrackMaxHandler_Getattr/2
--- PASS: TestNfConntrackMaxHandler_Getattr (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Getattr/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Getattr/2 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Open
=== RUN   TestNfConntrackMaxHandler_Open/1
=== RUN   TestNfConntrackMaxHandler_Open/2
=== RUN   TestNfConntrackMaxHandler_Open/3
--- PASS: TestNfConntrackMaxHandler_Open (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/2 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Open/3 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Close
--- PASS: TestNfConntrackMaxHandler_Close (0.00s)
=== RUN   TestNfConntrackMaxHandler_Read
=== RUN   TestNfConntrackMaxHandler_Read/1
=== RUN   TestNfConntrackMaxHandler_Read/2
=== RUN   TestNfConntrackMaxHandler_Read/3
=== RUN   TestNfConntrackMaxHandler_Read/4
--- PASS: TestNfConntrackMaxHandler_Read (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/1 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/2 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/3 (0.00s)
    --- PASS: TestNfConntrackMaxHandler_Read/4 (0.00s)
=== RUN   TestNfConntrackMaxHandler_Write
--- SKIP: TestNfConntrackMaxHandler_Write (0.00s)
    nfConntrackMax_test.go:542: Skipping write testcase temporarily
=== RUN   TestNfConntrackMaxHandler_ReadDirAll
--- PASS: TestNfConntrackMaxHandler_ReadDirAll (0.00s)
=== RUN   TestNfConntrackMaxHandler_FetchFile
--- PASS: TestNfConntrackMaxHandler_FetchFile (0.00s)
=== RUN   TestNfConntrackMaxHandler_PushFile
--- PASS: TestNfConntrackMaxHandler_PushFile (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetName
--- PASS: TestNfConntrackMaxHandler_GetName (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetPath
--- PASS: TestNfConntrackMaxHandler_GetPath (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetEnabled
--- PASS: TestNfConntrackMaxHandler_GetEnabled (0.00s)
=== RUN   TestNfConntrackMaxHandler_GetService
--- PASS: TestNfConntrackMaxHandler_GetService (0.00s)
=== RUN   TestNfConntrackMaxHandler_SetEnabled
--- PASS: TestNfConntrackMaxHandler_SetEnabled (0.00s)
=== RUN   TestNfConntrackMaxHandler_SetService
--- PASS: TestNfConntrackMaxHandler_SetService (0.00s)
=== RUN   TestProcUptimeHandler_Lookup
=== RUN   TestProcUptimeHandler_Lookup/1
--- PASS: TestProcUptimeHandler_Lookup (0.00s)
    --- PASS: TestProcUptimeHandler_Lookup/1 (0.00s)
=== RUN   TestProcUptimeHandler_Getattr
=== RUN   TestProcUptimeHandler_Getattr/1
=== RUN   TestProcUptimeHandler_Getattr/2
--- PASS: TestProcUptimeHandler_Getattr (0.00s)
    --- PASS: TestProcUptimeHandler_Getattr/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Getattr/2 (0.00s)
=== RUN   TestProcUptimeHandler_Open
=== RUN   TestProcUptimeHandler_Open/1
=== RUN   TestProcUptimeHandler_Open/2
=== RUN   TestProcUptimeHandler_Open/3
--- PASS: TestProcUptimeHandler_Open (0.00s)
    --- PASS: TestProcUptimeHandler_Open/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Open/2 (0.00s)
    --- PASS: TestProcUptimeHandler_Open/3 (0.00s)
=== RUN   TestProcUptimeHandler_Read
=== RUN   TestProcUptimeHandler_Read/1
=== RUN   TestProcUptimeHandler_Read/2
=== RUN   TestProcUptimeHandler_Read/3
=== RUN   TestProcUptimeHandler_Read/4
--- PASS: TestProcUptimeHandler_Read (0.00s)
    --- PASS: TestProcUptimeHandler_Read/1 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/2 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/3 (0.00s)
    --- PASS: TestProcUptimeHandler_Read/4 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/handler/implementations	0.010s
=== RUN   TestNewIpcService
--- PASS: TestNewIpcService (0.00s)
=== RUN   TestContainerRegister
=== RUN   TestContainerRegister/1
=== RUN   TestContainerRegister/2
=== RUN   TestContainerRegister/3
--- PASS: TestContainerRegister (0.00s)
    --- PASS: TestContainerRegister/1 (0.00s)
    --- PASS: TestContainerRegister/2 (0.00s)
    --- PASS: TestContainerRegister/3 (0.00s)
=== RUN   TestContainerUnregister
=== RUN   TestContainerUnregister/1
=== RUN   TestContainerUnregister/2
=== RUN   TestContainerUnregister/3
--- PASS: TestContainerUnregister (0.00s)
    --- PASS: TestContainerUnregister/1 (0.00s)
    --- PASS: TestContainerUnregister/2 (0.00s)
    --- PASS: TestContainerUnregister/3 (0.00s)
=== RUN   TestContainerUpdate
=== RUN   TestContainerUpdate/1
=== RUN   TestContainerUpdate/2
=== RUN   TestContainerUpdate/3
--- PASS: TestContainerUpdate (0.00s)
    --- PASS: TestContainerUpdate/1 (0.00s)
    --- PASS: TestContainerUpdate/2 (0.00s)
    --- PASS: TestContainerUpdate/3 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/ipc	0.004s
?   	github.com/nestybox/sysbox-fs/mocks	[no test files]
?   	github.com/nestybox/sysbox-fs/nsenter	[no test files]
=== RUN   TestNewContainerStateService
=== RUN   TestNewContainerStateService/1
--- PASS: TestNewContainerStateService (0.00s)
    --- PASS: TestNewContainerStateService/1 (0.00s)
=== RUN   Test_containerStateService_ContainerCreate
=== RUN   Test_containerStateService_ContainerCreate/1
--- PASS: Test_containerStateService_ContainerCreate (0.00s)
    --- PASS: Test_containerStateService_ContainerCreate/1 (0.00s)
=== RUN   Test_containerStateService_ContainerAdd
=== RUN   Test_containerStateService_ContainerAdd/1
=== RUN   Test_containerStateService_ContainerAdd/2
=== RUN   Test_containerStateService_ContainerAdd/3
--- PASS: Test_containerStateService_ContainerAdd (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerAdd/3 (0.00s)
=== RUN   Test_containerStateService_ContainerUpdate
=== RUN   Test_containerStateService_ContainerUpdate/1
=== RUN   Test_containerStateService_ContainerUpdate/2
=== RUN   Test_containerStateService_ContainerUpdate/3
--- PASS: Test_containerStateService_ContainerUpdate (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerUpdate/3 (0.00s)
=== RUN   Test_containerStateService_ContainerDelete
=== RUN   Test_containerStateService_ContainerDelete/1
=== RUN   Test_containerStateService_ContainerDelete/2
=== RUN   Test_containerStateService_ContainerDelete/3
--- PASS: Test_containerStateService_ContainerDelete (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerDelete/3 (0.00s)
=== RUN   Test_containerStateService_ContainerLookupById
=== RUN   Test_containerStateService_ContainerLookupById/1
=== RUN   Test_containerStateService_ContainerLookupById/2
=== RUN   Test_containerStateService_ContainerLookupById/3
--- PASS: Test_containerStateService_ContainerLookupById (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupById/3 (0.00s)
=== RUN   Test_containerStateService_ContainerLookupByPid
=== RUN   Test_containerStateService_ContainerLookupByPid/1
=== RUN   Test_containerStateService_ContainerLookupByPid/2
=== RUN   Test_containerStateService_ContainerLookupByPid/3
--- PASS: Test_containerStateService_ContainerLookupByPid (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/1 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/2 (0.00s)
    --- PASS: Test_containerStateService_ContainerLookupByPid/3 (0.00s)
=== RUN   Test_container_ID
=== RUN   Test_container_ID/1
=== RUN   Test_container_ID/2
--- PASS: Test_container_ID (0.00s)
    --- PASS: Test_container_ID/1 (0.00s)
    --- PASS: Test_container_ID/2 (0.00s)
=== RUN   Test_container_InitPid
=== RUN   Test_container_InitPid/1
=== RUN   Test_container_InitPid/2
--- PASS: Test_container_InitPid (0.00s)
    --- PASS: Test_container_InitPid/1 (0.00s)
    --- PASS: Test_container_InitPid/2 (0.00s)
=== RUN   Test_container_Hostname
=== RUN   Test_container_Hostname/1
=== RUN   Test_container_Hostname/2
--- PASS: Test_container_Hostname (0.00s)
    --- PASS: Test_container_Hostname/1 (0.00s)
    --- PASS: Test_container_Hostname/2 (0.00s)
=== RUN   Test_container_Ctime
=== RUN   Test_container_Ctime/1
=== RUN   Test_container_Ctime/2
--- PASS: Test_container_Ctime (0.00s)
    --- PASS: Test_container_Ctime/1 (0.00s)
    --- PASS: Test_container_Ctime/2 (0.00s)
=== RUN   Test_container_PidInode
=== RUN   Test_container_PidInode/1
=== RUN   Test_container_PidInode/2
--- PASS: Test_container_PidInode (0.00s)
    --- PASS: Test_container_PidInode/1 (0.00s)
    --- PASS: Test_container_PidInode/2 (0.00s)
=== RUN   Test_container_Data
=== RUN   Test_container_Data/1
=== RUN   Test_container_Data/2
=== RUN   Test_container_Data/3
=== RUN   Test_container_Data/4
--- PASS: Test_container_Data (0.00s)
    --- PASS: Test_container_Data/1 (0.00s)
    --- PASS: Test_container_Data/2 (0.00s)
    --- PASS: Test_container_Data/3 (0.00s)
    --- PASS: Test_container_Data/4 (0.00s)
=== RUN   Test_container_String
=== RUN   Test_container_String/1
--- PASS: Test_container_String (0.00s)
    --- PASS: Test_container_String/1 (0.00s)
=== RUN   Test_container_SetCtime
=== RUN   Test_container_SetCtime/1
=== RUN   Test_container_SetCtime/2
--- PASS: Test_container_SetCtime (0.00s)
    --- PASS: Test_container_SetCtime/1 (0.00s)
    --- PASS: Test_container_SetCtime/2 (0.00s)
=== RUN   Test_container_SetData
=== RUN   Test_container_SetData/1
=== RUN   Test_container_SetData/2
=== RUN   Test_container_SetData/3
--- PASS: Test_container_SetData (0.00s)
    --- PASS: Test_container_SetData/1 (0.00s)
    --- PASS: Test_container_SetData/2 (0.00s)
    --- PASS: Test_container_SetData/3 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/state	0.004s
=== RUN   Test_ioFileService_NewIOnode
--- PASS: Test_ioFileService_NewIOnode (0.00s)
=== RUN   Test_ioFileService_OpenNode
=== RUN   Test_ioFileService_OpenNode/1
--- PASS: Test_ioFileService_OpenNode (0.00s)
    --- PASS: Test_ioFileService_OpenNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadNode
=== RUN   Test_ioFileService_ReadNode/1
--- PASS: Test_ioFileService_ReadNode (0.00s)
    --- PASS: Test_ioFileService_ReadNode/1 (0.00s)
=== RUN   Test_ioFileService_WriteNode
=== RUN   Test_ioFileService_WriteNode/1
--- PASS: Test_ioFileService_WriteNode (0.00s)
    --- PASS: Test_ioFileService_WriteNode/1 (0.00s)
=== RUN   Test_ioFileService_CloseNode
=== RUN   Test_ioFileService_CloseNode/1
--- PASS: Test_ioFileService_CloseNode (0.00s)
    --- PASS: Test_ioFileService_CloseNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadAtNode
=== RUN   Test_ioFileService_ReadAtNode/1
--- PASS: Test_ioFileService_ReadAtNode (0.00s)
    --- PASS: Test_ioFileService_ReadAtNode/1 (0.00s)
=== RUN   Test_ioFileService_ReadDirAllNode
--- PASS: Test_ioFileService_ReadDirAllNode (0.00s)
=== RUN   Test_ioFileService_ReadLineNode
=== RUN   Test_ioFileService_ReadLineNode/1
--- PASS: Test_ioFileService_ReadLineNode (0.00s)
    --- PASS: Test_ioFileService_ReadLineNode/1 (0.00s)
=== RUN   Test_ioFileService_StatNode
=== RUN   Test_ioFileService_StatNode/1
--- PASS: Test_ioFileService_StatNode (0.00s)
    --- PASS: Test_ioFileService_StatNode/1 (0.00s)
=== RUN   Test_ioFileService_SeekResetNode
=== RUN   Test_ioFileService_SeekResetNode/1
--- PASS: Test_ioFileService_SeekResetNode (0.00s)
    --- PASS: Test_ioFileService_SeekResetNode/1 (0.00s)
=== RUN   Test_ioFileService_PidNsInode
--- SKIP: Test_ioFileService_PidNsInode (0.00s)
    ionodeFile_test.go:438: Skipping IOnodeService.PidNsInode() for now
=== RUN   Test_ioFileService_PathNode
=== RUN   Test_ioFileService_PathNode/1
--- PASS: Test_ioFileService_PathNode (0.00s)
    --- PASS: Test_ioFileService_PathNode/1 (0.00s)
=== RUN   TestIOnodeFile_Open
=== RUN   TestIOnodeFile_Open/1
=== RUN   TestIOnodeFile_Open/2
--- PASS: TestIOnodeFile_Open (0.00s)
    --- PASS: TestIOnodeFile_Open/1 (0.00s)
    --- PASS: TestIOnodeFile_Open/2 (0.00s)
=== RUN   TestIOnodeFile_Read
=== RUN   TestIOnodeFile_Read/1
=== RUN   TestIOnodeFile_Read/2
=== RUN   TestIOnodeFile_Read/3
=== RUN   TestIOnodeFile_Read/4
--- PASS: TestIOnodeFile_Read (0.00s)
    --- PASS: TestIOnodeFile_Read/1 (0.00s)
    --- PASS: TestIOnodeFile_Read/2 (0.00s)
    --- PASS: TestIOnodeFile_Read/3 (0.00s)
    --- PASS: TestIOnodeFile_Read/4 (0.00s)
=== RUN   TestIOnodeFile_Write
=== RUN   TestIOnodeFile_Write/1
=== RUN   TestIOnodeFile_Write/2
=== RUN   TestIOnodeFile_Write/3
--- PASS: TestIOnodeFile_Write (0.00s)
    --- PASS: TestIOnodeFile_Write/1 (0.00s)
    --- PASS: TestIOnodeFile_Write/2 (0.00s)
    --- PASS: TestIOnodeFile_Write/3 (0.00s)
=== RUN   TestIOnodeFile_Close
=== RUN   TestIOnodeFile_Close/1
=== RUN   TestIOnodeFile_Close/2
--- PASS: TestIOnodeFile_Close (0.00s)
    --- PASS: TestIOnodeFile_Close/1 (0.00s)
    --- PASS: TestIOnodeFile_Close/2 (0.00s)
=== RUN   TestIOnodeFile_ReadAt
=== RUN   TestIOnodeFile_ReadAt/1
=== RUN   TestIOnodeFile_ReadAt/2
=== RUN   TestIOnodeFile_ReadAt/3
=== RUN   TestIOnodeFile_ReadAt/4
--- PASS: TestIOnodeFile_ReadAt (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/2 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/3 (0.00s)
    --- PASS: TestIOnodeFile_ReadAt/4 (0.00s)
=== RUN   TestIOnodeFile_ReadDirAll
=== RUN   TestIOnodeFile_ReadDirAll/1
=== RUN   TestIOnodeFile_ReadDirAll/2
--- PASS: TestIOnodeFile_ReadDirAll (0.00s)
    --- PASS: TestIOnodeFile_ReadDirAll/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadDirAll/2 (0.00s)
=== RUN   TestIOnodeFile_ReadLine
=== RUN   TestIOnodeFile_ReadLine/1
=== RUN   TestIOnodeFile_ReadLine/2
=== RUN   TestIOnodeFile_ReadLine/3
=== RUN   TestIOnodeFile_ReadLine/4
--- PASS: TestIOnodeFile_ReadLine (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/1 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/2 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/3 (0.00s)
    --- PASS: TestIOnodeFile_ReadLine/4 (0.00s)
=== RUN   TestIOnodeFile_Stat
=== RUN   TestIOnodeFile_Stat/1
=== RUN   TestIOnodeFile_Stat/2
--- PASS: TestIOnodeFile_Stat (0.00s)
    --- PASS: TestIOnodeFile_Stat/1 (0.00s)
    --- PASS: TestIOnodeFile_Stat/2 (0.00s)
=== RUN   TestIOnodeFile_SeekReset
=== RUN   TestIOnodeFile_SeekReset/1
=== RUN   TestIOnodeFile_SeekReset/2
--- PASS: TestIOnodeFile_SeekReset (0.00s)
    --- PASS: TestIOnodeFile_SeekReset/1 (0.00s)
    --- PASS: TestIOnodeFile_SeekReset/2 (0.00s)
=== RUN   TestIOnodeFile_PidNsInode
=== RUN   TestIOnodeFile_PidNsInode/1
--- PASS: TestIOnodeFile_PidNsInode (0.00s)
    --- PASS: TestIOnodeFile_PidNsInode/1 (0.00s)
=== RUN   TestIOnodeFile_Name
=== RUN   TestIOnodeFile_Name/1
--- PASS: TestIOnodeFile_Name (0.00s)
    --- PASS: TestIOnodeFile_Name/1 (0.00s)
=== RUN   TestIOnodeFile_Path
=== RUN   TestIOnodeFile_Path/1
--- PASS: TestIOnodeFile_Path (0.00s)
    --- PASS: TestIOnodeFile_Path/1 (0.00s)
=== RUN   TestIOnodeFile_OpenFlags
=== RUN   TestIOnodeFile_OpenFlags/1
=== RUN   TestIOnodeFile_OpenFlags/2
--- PASS: TestIOnodeFile_OpenFlags (0.00s)
    --- PASS: TestIOnodeFile_OpenFlags/1 (0.00s)
    --- PASS: TestIOnodeFile_OpenFlags/2 (0.00s)
=== RUN   TestIOnodeFile_SetOpenFlags
=== RUN   TestIOnodeFile_SetOpenFlags/1
=== RUN   TestIOnodeFile_SetOpenFlags/2
--- PASS: TestIOnodeFile_SetOpenFlags (0.00s)
    --- PASS: TestIOnodeFile_SetOpenFlags/1 (0.00s)
    --- PASS: TestIOnodeFile_SetOpenFlags/2 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-fs/sysio	0.011s

** Running sysbox-mgr unit tests **

docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "make --no-print-directory test-mgr-local"
make[1]: 'protobuf.pb.go' is up to date.
cd sysbox-mgr && go test -timeout 3m -v github.com/nestybox/sysbox-mgr github.com/nestybox/sysbox-mgr/dsVolMgr github.com/nestybox/sysbox-mgr/intf github.com/nestybox/sysbox-mgr/lib/buddyAlloc github.com/nestybox/sysbox-mgr/lib/dockerUtils github.com/nestybox/sysbox-mgr/shiftfsMgr github.com/nestybox/sysbox-mgr/subidAlloc
=== RUN   TestAllocSubidRange
--- PASS: TestAllocSubidRange (0.00s)
=== RUN   TestConfigSubidRange
--- PASS: TestConfigSubidRange (0.00s)
=== RUN   TestGetSubidLimits
--- PASS: TestGetSubidLimits (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr	0.007s
=== RUN   TestCreateVol
--- PASS: TestCreateVol (0.00s)
=== RUN   TestDestroyVol
--- PASS: TestDestroyVol (0.00s)
=== RUN   TestSyncIn
--- PASS: TestSyncIn (0.01s)
=== RUN   TestSyncInUidShift
--- PASS: TestSyncInUidShift (0.01s)
=== RUN   TestSyncOut
--- PASS: TestSyncOut (0.03s)
=== RUN   TestSyncOutUidShift
--- PASS: TestSyncOutUidShift (0.01s)
=== RUN   TestSyncInSkip
--- PASS: TestSyncInSkip (0.00s)
=== RUN   TestSyncOutSkip
--- PASS: TestSyncOutSkip (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/dsVolMgr	0.055s
?   	github.com/nestybox/sysbox-mgr/intf	[no test files]
=== RUN   TestGetBlkSize
--- PASS: TestGetBlkSize (0.00s)
=== RUN   TestGetOrder
--- PASS: TestGetOrder (0.00s)
=== RUN   TestBuddyLimits
--- PASS: TestBuddyLimits (0.00s)
=== RUN   TestMaxRange
--- PASS: TestMaxRange (0.00s)
=== RUN   TestAllocBasic
--- PASS: TestAllocBasic (0.00s)
=== RUN   TestAllocExhausted
--- PASS: TestAllocExhausted (0.00s)
=== RUN   TestRealloc
--- PASS: TestRealloc (0.00s)
=== RUN   TestFree
--- PASS: TestFree (0.00s)
=== RUN   TestFreeEmpty
--- PASS: TestFreeEmpty (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/lib/buddyAlloc	0.002s
=== RUN   TestParseDataRoot
--- PASS: TestParseDataRoot (0.00s)
=== RUN   TestIsDockerContainer
--- PASS: TestIsDockerContainer (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/lib/dockerUtils	0.013s
=== RUN   TestShiftfsMgrBasic
--- PASS: TestShiftfsMgrBasic (0.02s)
=== RUN   TestShiftfsMgrErrors
--- PASS: TestShiftfsMgrErrors (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/shiftfsMgr	0.025s
=== RUN   TestAllocBasic
--- PASS: TestAllocBasic (0.00s)
=== RUN   TestAllocRangeLimit
--- PASS: TestAllocRangeLimit (0.00s)
=== RUN   TestAllocReuse
--- PASS: TestAllocReuse (0.00s)
=== RUN   TestAllocNoReuse
--- PASS: TestAllocNoReuse (0.00s)
=== RUN   TestAllocErrors
--- PASS: TestAllocErrors (0.00s)
=== RUN   TestFreeBasic
--- PASS: TestFreeBasic (0.00s)
=== RUN   TestFreeErrors
--- PASS: TestFreeErrors (0.00s)
=== RUN   TestAllocInvalidUser
--- PASS: TestAllocInvalidUser (0.00s)
=== RUN   TestConcurrency
--- PASS: TestConcurrency (0.00s)
=== RUN   TestAllocLimits
--- PASS: TestAllocLimits (0.00s)
=== RUN   TestAllocMultiRange
--- PASS: TestAllocMultiRange (0.00s)
=== RUN   TestGetCommonRanges
--- PASS: TestGetCommonRanges (0.00s)
=== RUN   TestAllocCommonRange
--- PASS: TestAllocCommonRange (0.00s)
=== RUN   TestIdentityMode
--- PASS: TestIdentityMode (0.00s)
=== RUN   TestExclusiveModeOverride
--- PASS: TestExclusiveModeOverride (0.00s)
=== RUN   TestIdentityModeOverride
--- PASS: TestIdentityModeOverride (0.00s)
PASS
ok  	github.com/nestybox/sysbox-mgr/subidAlloc	0.005s
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxFsGrpc/protobuf'
make[1]: 'protobuf.pb.go' is up to date.
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxFsGrpc/protobuf'
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxMgrGrpc/protobuf'
make[1]: 'protobuf.pb.go' is up to date.
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-ipc/sysboxMgrGrpc/protobuf'

** Running sysbox-runc unit & integration tests **

cd sysbox-runc && make clean && make BUILDTAGS="seccomp apparmor" test
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
rm -f sysbox-runc sysbox-runc-*
rm -f contrib/cmd/recvtty/recvtty
rm -rf /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/release
rm -rf /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/man/man8
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make unittest integration integration-shiftuid
make[2]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
docker build  -t runc_dev:HEAD .
Sending build context to Docker daemon  1.373MB
Step 1/13 : FROM golang:1.13.0-buster
 ---> c4d6fdf2260a
Step 2/13 : RUN dpkg --add-architecture armel     && dpkg --add-architecture armhf     && dpkg --add-architecture arm64     && dpkg --add-architecture ppc64el     && apt-get update && apt-get install -y     build-essential     curl     sudo     gawk     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libprotobuf-c-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     crossbuild-essential-armel crossbuild-essential-armhf crossbuild-essential-arm64 crossbuild-essential-ppc64el     libseccomp-dev:armel libseccomp-dev:armhf libseccomp-dev:arm64 libseccomp-dev:ppc64el     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> d2c060935350
Step 3/13 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 781e7873acd7
Step 4/13 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> 4751a1d10bdb
Step 5/13 : ENV CRIU_VERSION v3.11
 ---> Using cache
 ---> daab9f62317e
Step 6/13 : RUN mkdir -p /usr/src/criu     && curl -sSL https://github.com/checkpoint-restore/criu/archive/${CRIU_VERSION}.tar.gz | tar -v -C /usr/src/criu/ -xz --strip-components=1     && cd /usr/src/criu     && curl https://github.com/checkpoint-restore/criu/commit/bb0b2f2635d71e549851b7c626a1464e42a3b5c7.patch | patch -p1     && make install-criu     && rm -rf /usr/src/criu
 ---> Using cache
 ---> 3341c305bf7b
Step 7/13 : ENV ROOTFS /busybox
 ---> Using cache
 ---> a13fae59be6b
Step 8/13 : RUN mkdir -p ${ROOTFS}
 ---> Using cache
 ---> 2532317b7c06
Step 9/13 : COPY script/tmpmount /
 ---> Using cache
 ---> b5fe28cae673
Step 10/13 : WORKDIR /root/nestybox/sysbox-runc
 ---> Using cache
 ---> a1b7b1867d40
Step 11/13 : ENTRYPOINT ["/tmpmount"]
 ---> Using cache
 ---> fc5e313c4ceb
Step 12/13 : ADD . /root/nestybox/sysbox-runc
 ---> Using cache
 ---> 74d07d51ebba
Step 13/13 : RUN . tests/integration/multi-arch.bash     && curl -o- -sSL `get_busybox` | tar xfJC - ${ROOTFS}
 ---> Using cache
 ---> fc190b245cdb
Successfully built fc190b245cdb
Successfully tagged runc_dev:HEAD
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localunittest TESTFLAGS=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
go build -buildmode=pie  -ldflags "-X main.gitCommit="" -X main.version= " -tags "seccomp" -o contrib/cmd/recvtty/recvtty ./contrib/cmd/recvtty
go build -buildmode=pie  -ldflags '-X main.version= -X main.commitId= -X "main.builtAt=" -X main.builtBy=' -tags "seccomp" \
	-o sysbox-runc .
go: finding github.com/coreos/pkg latest
go: finding github.com/vishvananda/netns latest
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/coreos/pkg latest
go: finding github.com/vishvananda/netns latest
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
go test -timeout 3m -tags "seccomp"  -v github.com/nestybox/sysbox-runc github.com/nestybox/sysbox-runc/contrib/cmd/recvtty github.com/nestybox/sysbox-runc/libcontainer github.com/nestybox/sysbox-runc/libcontainer/apparmor github.com/nestybox/sysbox-runc/libcontainer/cgroups github.com/nestybox/sysbox-runc/libcontainer/cgroups/fs github.com/nestybox/sysbox-runc/libcontainer/cgroups/systemd github.com/nestybox/sysbox-runc/libcontainer/configs github.com/nestybox/sysbox-runc/libcontainer/configs/validate github.com/nestybox/sysbox-runc/libcontainer/devices github.com/nestybox/sysbox-runc/libcontainer/integration github.com/nestybox/sysbox-runc/libcontainer/intelrdt github.com/nestybox/sysbox-runc/libcontainer/keys github.com/nestybox/sysbox-runc/libcontainer/mount github.com/nestybox/sysbox-runc/libcontainer/nsenter github.com/nestybox/sysbox-runc/libcontainer/seccomp github.com/nestybox/sysbox-runc/libcontainer/specconv github.com/nestybox/sysbox-runc/libcontainer/stacktrace github.com/nestybox/sysbox-runc/libcontainer/system github.com/nestybox/sysbox-runc/libcontainer/user github.com/nestybox/sysbox-runc/libcontainer/utils github.com/nestybox/sysbox-runc/libsysbox/shiftfs github.com/nestybox/sysbox-runc/libsysbox/sysbox github.com/nestybox/sysbox-runc/libsysbox/syscont
go: finding github.com/godbus/dbus v5.0.0+incompatible
go: finding github.com/godbus/dbus v5.0.0+incompatible
?   	github.com/nestybox/sysbox-runc	[no test files]
?   	github.com/nestybox/sysbox-runc/contrib/cmd/recvtty	[no test files]
=== RUN   TestGetContainerPids
--- PASS: TestGetContainerPids (0.00s)
=== RUN   TestGetContainerStats
--- PASS: TestGetContainerStats (0.00s)
=== RUN   TestGetContainerState
--- PASS: TestGetContainerState (0.00s)
=== RUN   TestGetContainerStateAfterUpdate
--- PASS: TestGetContainerStateAfterUpdate (0.00s)
=== RUN   TestErrorCode
--- PASS: TestErrorCode (0.00s)
=== RUN   TestFactoryNew
--- PASS: TestFactoryNew (0.00s)
=== RUN   TestFactoryNewIntelRdt
--- PASS: TestFactoryNewIntelRdt (0.00s)
=== RUN   TestFactoryNewTmpfs
--- PASS: TestFactoryNewTmpfs (0.00s)
=== RUN   TestFactoryLoadNotExists
--- PASS: TestFactoryLoadNotExists (0.00s)
=== RUN   TestFactoryLoadContainer
time="2020-02-02T22:07:14Z" level=warning msg="cannot serialize hook of type libcontainer.unserializableHook, skipping"
--- PASS: TestFactoryLoadContainer (0.00s)
=== RUN   TestErrorDetail
--- PASS: TestErrorDetail (0.00s)
=== RUN   TestErrorWithCode
--- PASS: TestErrorWithCode (0.00s)
=== RUN   TestErrorWithError
--- PASS: TestErrorWithError (0.00s)
=== RUN   TestNotifyOnOOM
--- PASS: TestNotifyOnOOM (0.00s)
=== RUN   TestNotifyMemoryPressure
--- PASS: TestNotifyMemoryPressure (0.00s)
=== RUN   TestNeedsSetupDev
--- PASS: TestNeedsSetupDev (0.00s)
=== RUN   TestNeedsSetupDevStrangeSource
--- PASS: TestNeedsSetupDevStrangeSource (0.00s)
=== RUN   TestNeedsSetupDevStrangeDest
--- PASS: TestNeedsSetupDevStrangeDest (0.00s)
=== RUN   TestNeedsSetupDevStrangeSourceDest
--- PASS: TestNeedsSetupDevStrangeSourceDest (0.00s)
=== RUN   TestStateStatus
--- PASS: TestStateStatus (0.00s)
=== RUN   TestStoppedStateTransition
=== RUN   TestStoppedStateTransition/stopped
=== RUN   TestStoppedStateTransition/running
=== RUN   TestStoppedStateTransition/running#01
=== RUN   TestStoppedStateTransition/created
=== RUN   TestStoppedStateTransition/paused
=== RUN   TestStoppedStateTransition/running#02
--- PASS: TestStoppedStateTransition (0.00s)
    --- PASS: TestStoppedStateTransition/stopped (0.00s)
    --- PASS: TestStoppedStateTransition/running (0.00s)
    --- PASS: TestStoppedStateTransition/running#01 (0.00s)
    --- PASS: TestStoppedStateTransition/created (0.00s)
    --- PASS: TestStoppedStateTransition/paused (0.00s)
    --- PASS: TestStoppedStateTransition/running#02 (0.00s)
=== RUN   TestPausedStateTransition
=== RUN   TestPausedStateTransition/paused
=== RUN   TestPausedStateTransition/running
=== RUN   TestPausedStateTransition/stopped
=== RUN   TestPausedStateTransition/running#01
=== RUN   TestPausedStateTransition/running#02
=== RUN   TestPausedStateTransition/created
--- PASS: TestPausedStateTransition (0.00s)
    --- PASS: TestPausedStateTransition/paused (0.00s)
    --- PASS: TestPausedStateTransition/running (0.00s)
    --- PASS: TestPausedStateTransition/stopped (0.00s)
    --- PASS: TestPausedStateTransition/running#01 (0.00s)
    --- PASS: TestPausedStateTransition/running#02 (0.00s)
    --- PASS: TestPausedStateTransition/created (0.00s)
=== RUN   TestRestoredStateTransition
=== RUN   TestRestoredStateTransition/stopped
=== RUN   TestRestoredStateTransition/running
=== RUN   TestRestoredStateTransition/running#01
=== RUN   TestRestoredStateTransition/paused
=== RUN   TestRestoredStateTransition/running#02
=== RUN   TestRestoredStateTransition/created
--- PASS: TestRestoredStateTransition (0.00s)
    --- PASS: TestRestoredStateTransition/stopped (0.00s)
    --- PASS: TestRestoredStateTransition/running (0.00s)
    --- PASS: TestRestoredStateTransition/running#01 (0.00s)
    --- PASS: TestRestoredStateTransition/paused (0.00s)
    --- PASS: TestRestoredStateTransition/running#02 (0.00s)
    --- PASS: TestRestoredStateTransition/created (0.00s)
=== RUN   TestRunningStateTransition
=== RUN   TestRunningStateTransition/stopped
=== RUN   TestRunningStateTransition/paused
=== RUN   TestRunningStateTransition/running
=== RUN   TestRunningStateTransition/running#01
=== RUN   TestRunningStateTransition/running#02
=== RUN   TestRunningStateTransition/created
--- PASS: TestRunningStateTransition (0.00s)
    --- PASS: TestRunningStateTransition/stopped (0.00s)
    --- PASS: TestRunningStateTransition/paused (0.00s)
    --- PASS: TestRunningStateTransition/running (0.00s)
    --- PASS: TestRunningStateTransition/running#01 (0.00s)
    --- PASS: TestRunningStateTransition/running#02 (0.00s)
    --- PASS: TestRunningStateTransition/created (0.00s)
=== RUN   TestCreatedStateTransition
=== RUN   TestCreatedStateTransition/stopped
=== RUN   TestCreatedStateTransition/paused
=== RUN   TestCreatedStateTransition/running
=== RUN   TestCreatedStateTransition/created
=== RUN   TestCreatedStateTransition/running#01
=== RUN   TestCreatedStateTransition/running#02
--- PASS: TestCreatedStateTransition (0.00s)
    --- PASS: TestCreatedStateTransition/stopped (0.00s)
    --- PASS: TestCreatedStateTransition/paused (0.00s)
    --- PASS: TestCreatedStateTransition/running (0.00s)
    --- PASS: TestCreatedStateTransition/created (0.00s)
    --- PASS: TestCreatedStateTransition/running#01 (0.00s)
    --- PASS: TestCreatedStateTransition/running#02 (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer	0.012s
?   	github.com/nestybox/sysbox-runc/libcontainer/apparmor	[no test files]
=== RUN   TestParseCgroups
--- PASS: TestParseCgroups (0.00s)
=== RUN   TestGetCgroupMounts
--- PASS: TestGetCgroupMounts (0.00s)
=== RUN   TestParseCgroupString
--- PASS: TestParseCgroupString (0.00s)
=== RUN   TestIgnoreCgroup2Mount
--- PASS: TestIgnoreCgroup2Mount (0.00s)
=== RUN   TestGetClosestMountpointAncestor
--- PASS: TestGetClosestMountpointAncestor (0.00s)
=== RUN   TestFindCgroupMountpointAndRoot
--- PASS: TestFindCgroupMountpointAndRoot (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/cgroups	0.003s
=== RUN   TestInvalidCgroupPath
--- PASS: TestInvalidCgroupPath (0.00s)
=== RUN   TestInvalidAbsoluteCgroupPath
--- PASS: TestInvalidAbsoluteCgroupPath (0.00s)
=== RUN   TestInvalidCgroupParent
--- PASS: TestInvalidCgroupParent (0.00s)
=== RUN   TestInvalidAbsoluteCgroupParent
--- PASS: TestInvalidAbsoluteCgroupParent (0.00s)
=== RUN   TestInvalidCgroupName
--- PASS: TestInvalidCgroupName (0.00s)
=== RUN   TestInvalidAbsoluteCgroupName
--- PASS: TestInvalidAbsoluteCgroupName (0.00s)
=== RUN   TestInvalidCgroupNameAndParent
--- PASS: TestInvalidCgroupNameAndParent (0.00s)
=== RUN   TestInvalidAbsoluteCgroupNameAndParent
--- PASS: TestInvalidAbsoluteCgroupNameAndParent (0.00s)
=== RUN   TestBlkioSetWeight
--- PASS: TestBlkioSetWeight (0.00s)
=== RUN   TestBlkioSetWeightDevice
--- PASS: TestBlkioSetWeightDevice (0.00s)
=== RUN   TestBlkioSetMultipleWeightDevice
--- PASS: TestBlkioSetMultipleWeightDevice (0.00s)
=== RUN   TestBlkioStats
--- PASS: TestBlkioStats (0.00s)
=== RUN   TestBlkioStatsNoSectorsFile
--- PASS: TestBlkioStatsNoSectorsFile (0.00s)
=== RUN   TestBlkioStatsNoServiceBytesFile
--- PASS: TestBlkioStatsNoServiceBytesFile (0.00s)
=== RUN   TestBlkioStatsNoServicedFile
--- PASS: TestBlkioStatsNoServicedFile (0.00s)
=== RUN   TestBlkioStatsNoQueuedFile
--- PASS: TestBlkioStatsNoQueuedFile (0.00s)
=== RUN   TestBlkioStatsNoServiceTimeFile
--- PASS: TestBlkioStatsNoServiceTimeFile (0.00s)
=== RUN   TestBlkioStatsNoWaitTimeFile
--- PASS: TestBlkioStatsNoWaitTimeFile (0.00s)
=== RUN   TestBlkioStatsNoMergedFile
--- PASS: TestBlkioStatsNoMergedFile (0.00s)
=== RUN   TestBlkioStatsNoTimeFile
--- PASS: TestBlkioStatsNoTimeFile (0.00s)
=== RUN   TestBlkioStatsUnexpectedNumberOfFields
--- PASS: TestBlkioStatsUnexpectedNumberOfFields (0.00s)
=== RUN   TestBlkioStatsUnexpectedFieldType
--- PASS: TestBlkioStatsUnexpectedFieldType (0.00s)
=== RUN   TestNonCFQBlkioStats
--- PASS: TestNonCFQBlkioStats (0.00s)
=== RUN   TestBlkioSetThrottleReadBpsDevice
--- PASS: TestBlkioSetThrottleReadBpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleWriteBpsDevice
--- PASS: TestBlkioSetThrottleWriteBpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleReadIOpsDevice
--- PASS: TestBlkioSetThrottleReadIOpsDevice (0.00s)
=== RUN   TestBlkioSetThrottleWriteIOpsDevice
--- PASS: TestBlkioSetThrottleWriteIOpsDevice (0.00s)
=== RUN   TestCpuSetShares
--- PASS: TestCpuSetShares (0.00s)
=== RUN   TestCpuSetBandWidth
--- PASS: TestCpuSetBandWidth (0.00s)
=== RUN   TestCpuStats
--- PASS: TestCpuStats (0.00s)
=== RUN   TestNoCpuStatFile
--- PASS: TestNoCpuStatFile (0.00s)
=== RUN   TestInvalidCpuStat
--- PASS: TestInvalidCpuStat (0.00s)
=== RUN   TestCpuSetRtSchedAtApply
--- PASS: TestCpuSetRtSchedAtApply (0.00s)
=== RUN   TestCpusetSetCpus
--- PASS: TestCpusetSetCpus (0.00s)
=== RUN   TestCpusetSetMems
--- PASS: TestCpusetSetMems (0.00s)
=== RUN   TestDevicesSetAllow
--- PASS: TestDevicesSetAllow (0.00s)
=== RUN   TestDevicesSetDeny
--- PASS: TestDevicesSetDeny (0.00s)
=== RUN   TestFreezerSetState
--- PASS: TestFreezerSetState (0.00s)
=== RUN   TestFreezerSetInvalidState
--- PASS: TestFreezerSetInvalidState (0.00s)
=== RUN   TestHugetlbSetHugetlb
--- PASS: TestHugetlbSetHugetlb (0.00s)
=== RUN   TestHugetlbStats
--- PASS: TestHugetlbStats (0.00s)
=== RUN   TestHugetlbStatsNoUsageFile
--- PASS: TestHugetlbStatsNoUsageFile (0.00s)
=== RUN   TestHugetlbStatsNoMaxUsageFile
--- PASS: TestHugetlbStatsNoMaxUsageFile (0.00s)
=== RUN   TestHugetlbStatsBadUsageFile
--- PASS: TestHugetlbStatsBadUsageFile (0.00s)
=== RUN   TestHugetlbStatsBadMaxUsageFile
--- PASS: TestHugetlbStatsBadMaxUsageFile (0.00s)
=== RUN   TestMemorySetMemory
--- PASS: TestMemorySetMemory (0.00s)
=== RUN   TestMemorySetMemoryswap
--- PASS: TestMemorySetMemoryswap (0.00s)
=== RUN   TestMemorySetMemoryLargerThanSwap
--- PASS: TestMemorySetMemoryLargerThanSwap (0.00s)
=== RUN   TestMemorySetSwapSmallerThanMemory
--- PASS: TestMemorySetSwapSmallerThanMemory (0.00s)
=== RUN   TestMemorySetKernelMemory
--- PASS: TestMemorySetKernelMemory (0.00s)
=== RUN   TestMemorySetKernelMemoryTCP
--- PASS: TestMemorySetKernelMemoryTCP (0.00s)
=== RUN   TestMemorySetMemorySwappinessDefault
--- PASS: TestMemorySetMemorySwappinessDefault (0.00s)
=== RUN   TestMemoryStats
--- PASS: TestMemoryStats (0.00s)
=== RUN   TestMemoryStatsNoStatFile
--- PASS: TestMemoryStatsNoStatFile (0.00s)
=== RUN   TestMemoryStatsNoUsageFile
--- PASS: TestMemoryStatsNoUsageFile (0.00s)
=== RUN   TestMemoryStatsNoMaxUsageFile
--- PASS: TestMemoryStatsNoMaxUsageFile (0.00s)
=== RUN   TestMemoryStatsNoLimitInBytesFile
--- PASS: TestMemoryStatsNoLimitInBytesFile (0.00s)
=== RUN   TestMemoryStatsBadStatFile
--- PASS: TestMemoryStatsBadStatFile (0.00s)
=== RUN   TestMemoryStatsBadUsageFile
--- PASS: TestMemoryStatsBadUsageFile (0.00s)
=== RUN   TestMemoryStatsBadMaxUsageFile
--- PASS: TestMemoryStatsBadMaxUsageFile (0.00s)
=== RUN   TestMemoryStatsBadLimitInBytesFile
--- PASS: TestMemoryStatsBadLimitInBytesFile (0.00s)
=== RUN   TestMemorySetOomControl
--- PASS: TestMemorySetOomControl (0.00s)
=== RUN   TestNetClsSetClassid
--- PASS: TestNetClsSetClassid (0.00s)
=== RUN   TestNetPrioSetIfPrio
--- PASS: TestNetPrioSetIfPrio (0.00s)
=== RUN   TestPidsSetMax
--- PASS: TestPidsSetMax (0.00s)
=== RUN   TestPidsSetUnlimited
--- PASS: TestPidsSetUnlimited (0.00s)
=== RUN   TestPidsStats
--- PASS: TestPidsStats (0.00s)
=== RUN   TestPidsStatsUnlimited
--- PASS: TestPidsStatsUnlimited (0.00s)
=== RUN   TestGetCgroupParamsInt
--- PASS: TestGetCgroupParamsInt (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/cgroups/fs	0.020s
?   	github.com/nestybox/sysbox-runc/libcontainer/cgroups/systemd	[no test files]
=== RUN   TestRemoveNamespace
--- PASS: TestRemoveNamespace (0.00s)
=== RUN   TestHostRootUIDNoUSERNS
--- PASS: TestHostRootUIDNoUSERNS (0.00s)
=== RUN   TestHostRootUIDWithUSERNS
--- PASS: TestHostRootUIDWithUSERNS (0.00s)
=== RUN   TestHostRootGIDNoUSERNS
--- PASS: TestHostRootGIDNoUSERNS (0.00s)
=== RUN   TestHostRootGIDWithUSERNS
--- PASS: TestHostRootGIDWithUSERNS (0.00s)
=== RUN   TestUnmarshalHooks
--- PASS: TestUnmarshalHooks (0.00s)
=== RUN   TestUnmarshalHooksWithInvalidData
--- PASS: TestUnmarshalHooksWithInvalidData (0.00s)
=== RUN   TestMarshalHooks
--- PASS: TestMarshalHooks (0.00s)
=== RUN   TestMarshalUnmarshalHooks
--- PASS: TestMarshalUnmarshalHooks (0.00s)
=== RUN   TestMarshalHooksWithUnexpectedType
time="2020-02-02T22:07:15Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
--- PASS: TestMarshalHooksWithUnexpectedType (0.00s)
=== RUN   TestFuncHookRun
--- PASS: TestFuncHookRun (0.00s)
=== RUN   TestCommandHookRun
--- PASS: TestCommandHookRun (0.00s)
=== RUN   TestCommandHookRunTimeout
--- PASS: TestCommandHookRunTimeout (0.01s)
=== RUN   TestHelperProcess
Helper Process
ok  	github.com/nestybox/sysbox-runc/libcontainer/configs	0.016s
=== RUN   TestValidateRootlessEUID
--- PASS: TestValidateRootlessEUID (0.00s)
=== RUN   TestValidateRootlessEUIDUserns
--- PASS: TestValidateRootlessEUIDUserns (0.00s)
=== RUN   TestValidateRootlessEUIDMappingUid
--- PASS: TestValidateRootlessEUIDMappingUid (0.00s)
=== RUN   TestValidateNonZeroEUIDMappingGid
--- PASS: TestValidateNonZeroEUIDMappingGid (0.00s)
=== RUN   TestValidateRootlessEUIDMountUid
--- PASS: TestValidateRootlessEUIDMountUid (0.00s)
=== RUN   TestValidateRootlessEUIDMountGid
--- PASS: TestValidateRootlessEUIDMountGid (0.00s)
=== RUN   TestValidate
--- PASS: TestValidate (0.00s)
=== RUN   TestValidateWithInvalidRootfs
--- PASS: TestValidateWithInvalidRootfs (0.00s)
=== RUN   TestValidateNetworkWithoutNETNamespace
--- PASS: TestValidateNetworkWithoutNETNamespace (0.00s)
=== RUN   TestValidateNetworkRoutesWithoutNETNamespace
--- PASS: TestValidateNetworkRoutesWithoutNETNamespace (0.00s)
=== RUN   TestValidateHostname
--- PASS: TestValidateHostname (0.00s)
=== RUN   TestValidateHostnameWithoutUTSNamespace
--- PASS: TestValidateHostnameWithoutUTSNamespace (0.00s)
=== RUN   TestValidateSecurityWithMaskPaths
--- PASS: TestValidateSecurityWithMaskPaths (0.00s)
=== RUN   TestValidateSecurityWithROPaths
--- PASS: TestValidateSecurityWithROPaths (0.00s)
=== RUN   TestValidateSecurityWithoutNEWNS
--- PASS: TestValidateSecurityWithoutNEWNS (0.00s)
=== RUN   TestValidateUsernamespace
--- PASS: TestValidateUsernamespace (0.00s)
=== RUN   TestValidateUsernamespaceWithoutUserNS
--- PASS: TestValidateUsernamespaceWithoutUserNS (0.00s)
=== RUN   TestValidateSysctl
--- PASS: TestValidateSysctl (0.00s)
=== RUN   TestValidateValidSysctl
--- PASS: TestValidateValidSysctl (0.00s)
=== RUN   TestValidateSysctlWithSameNs
--- PASS: TestValidateSysctlWithSameNs (0.00s)
=== RUN   TestValidateSysctlWithoutNETNamespace
--- PASS: TestValidateSysctlWithoutNETNamespace (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/configs/validate	0.003s
=== RUN   TestDeviceFromPathLstatFailure
--- PASS: TestDeviceFromPathLstatFailure (0.00s)
=== RUN   TestHostDevicesIoutilReadDirFailure
--- PASS: TestHostDevicesIoutilReadDirFailure (0.00s)
=== RUN   TestHostDevicesIoutilReadDirDeepFailure
--- PASS: TestHostDevicesIoutilReadDirDeepFailure (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/devices	0.002s
=== RUN   TestExecPS
--- PASS: TestExecPS (0.14s)
=== RUN   TestIPCPrivate
--- PASS: TestIPCPrivate (0.10s)
=== RUN   TestIPCHost
--- PASS: TestIPCHost (0.07s)
=== RUN   TestIPCJoinPath
--- PASS: TestIPCJoinPath (0.10s)
=== RUN   TestIPCBadPath
--- PASS: TestIPCBadPath (0.02s)
=== RUN   TestRlimit
--- PASS: TestRlimit (0.08s)
=== RUN   TestUsernsRlimit
--- PASS: TestUsernsRlimit (0.08s)
=== RUN   TestEnter
--- PASS: TestEnter (0.13s)
=== RUN   TestProcessEnv
--- PASS: TestProcessEnv (0.09s)
=== RUN   TestProcessEmptyCaps
--- PASS: TestProcessEmptyCaps (0.07s)
=== RUN   TestProcessCaps
--- PASS: TestProcessCaps (0.07s)
=== RUN   TestAdditionalGroups
--- PASS: TestAdditionalGroups (0.08s)
=== RUN   TestFreeze
--- PASS: TestFreeze (0.09s)
=== RUN   TestSystemdFreeze
--- SKIP: TestSystemdFreeze (0.00s)
    exec_test.go:512: Systemd is unsupported
=== RUN   TestCpuShares
time="2020-02-02T22:07:18Z" level=warning msg="signal: killed"
--- PASS: TestCpuShares (0.04s)
=== RUN   TestCpuSharesSystemd
--- SKIP: TestCpuSharesSystemd (0.00s)
    exec_test.go:566: Systemd is unsupported
=== RUN   TestPids
--- PASS: TestPids (0.30s)
=== RUN   TestPidsSystemd
--- SKIP: TestPidsSystemd (0.00s)
    exec_test.go:597: Systemd is unsupported
=== RUN   TestRunWithKernelMemory
--- PASS: TestRunWithKernelMemory (0.09s)
=== RUN   TestRunWithKernelMemorySystemd
--- SKIP: TestRunWithKernelMemorySystemd (0.00s)
    exec_test.go:680: Systemd is unsupported
=== RUN   TestContainerState
--- PASS: TestContainerState (0.07s)
=== RUN   TestPassExtraFiles
--- PASS: TestPassExtraFiles (0.09s)
=== RUN   TestMountCmds
--- PASS: TestMountCmds (0.15s)
=== RUN   TestSysctl
--- PASS: TestSysctl (0.09s)
=== RUN   TestMountCgroupRO
--- PASS: TestMountCgroupRO (0.08s)
=== RUN   TestMountCgroupRW
--- PASS: TestMountCgroupRW (0.10s)
=== RUN   TestOomScoreAdj
--- PASS: TestOomScoreAdj (0.10s)
=== RUN   TestHook
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
time="2020-02-02T22:07:20Z" level=warning msg="cannot serialize hook of type configs.FuncHook, skipping"
--- PASS: TestHook (0.10s)
=== RUN   TestSTDIOPermissions
--- PASS: TestSTDIOPermissions (0.10s)
=== RUN   TestRootfsPropagationSlaveMount
--- PASS: TestRootfsPropagationSlaveMount (0.16s)
=== RUN   TestRootfsPropagationSharedMount
--- PASS: TestRootfsPropagationSharedMount (0.14s)
=== RUN   TestPIDHost
--- SKIP: TestPIDHost (0.00s)
    exec_test.go:1498: not applicable
=== RUN   TestInitJoinPID
--- PASS: TestInitJoinPID (0.19s)
=== RUN   TestInitJoinNetworkAndUser
--- PASS: TestInitJoinNetworkAndUser (0.16s)
=== RUN   TestTmpfsCopyUp
--- PASS: TestTmpfsCopyUp (0.09s)
=== RUN   TestCGROUPPrivate
--- PASS: TestCGROUPPrivate (0.09s)
=== RUN   TestCGROUPHost
--- PASS: TestCGROUPHost (0.08s)
=== RUN   TestExecIn
--- PASS: TestExecIn (0.10s)
=== RUN   TestExecInUsernsRlimit
--- PASS: TestExecInUsernsRlimit (0.12s)
=== RUN   TestExecInRlimit
--- PASS: TestExecInRlimit (0.11s)
=== RUN   TestExecInAdditionalGroups
--- PASS: TestExecInAdditionalGroups (0.12s)
=== RUN   TestExecInError
--- PASS: TestExecInError (1.02s)
=== RUN   TestExecInTTY
--- PASS: TestExecInTTY (0.10s)
=== RUN   TestExecInEnvironment
--- PASS: TestExecInEnvironment (0.10s)
=== RUN   TestExecinPassExtraFiles
--- PASS: TestExecinPassExtraFiles (0.12s)
=== RUN   TestExecInOomScoreAdj
--- PASS: TestExecInOomScoreAdj (0.12s)
=== RUN   TestExecInUserns
--- PASS: TestExecInUserns (0.12s)
=== RUN   TestSeccompDenyGetcwd
--- PASS: TestSeccompDenyGetcwd (0.08s)
=== RUN   TestSeccompPermitWriteConditional
--- PASS: TestSeccompPermitWriteConditional (0.10s)
=== RUN   TestSeccompDenyWriteConditional
--- PASS: TestSeccompDenyWriteConditional (0.09s)
=== RUN   TestSeccompPermitWriteMultipleConditions
--- PASS: TestSeccompPermitWriteMultipleConditions (0.12s)
=== RUN   TestSeccompDenyWriteMultipleConditions
--- PASS: TestSeccompDenyWriteMultipleConditions (0.07s)
=== RUN   TestSeccompMultipleConditionSameArgDeniesStdout
--- PASS: TestSeccompMultipleConditionSameArgDeniesStdout (0.06s)
=== RUN   TestSeccompMultipleConditionSameArgDeniesStderr
--- PASS: TestSeccompMultipleConditionSameArgDeniesStderr (0.09s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/integration	6.004s
=== RUN   TestIntelRdtSetL3CacheSchema
--- PASS: TestIntelRdtSetL3CacheSchema (0.00s)
=== RUN   TestIntelRdtSetMemBwSchema
--- PASS: TestIntelRdtSetMemBwSchema (0.00s)
=== RUN   TestIntelRdtSetMemBwScSchema
--- PASS: TestIntelRdtSetMemBwScSchema (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/intelrdt	0.009s
?   	github.com/nestybox/sysbox-runc/libcontainer/keys	[no test files]
?   	github.com/nestybox/sysbox-runc/libcontainer/mount	[no test files]
=== RUN   TestNsenterValidPaths
--- PASS: TestNsenterValidPaths (0.01s)
=== RUN   TestNsenterInvalidPaths
--- PASS: TestNsenterInvalidPaths (0.02s)
=== RUN   TestNsenterIncorrectPathType
--- PASS: TestNsenterIncorrectPathType (0.02s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/nsenter	0.068s
=== RUN   TestParseStatusFile
--- PASS: TestParseStatusFile (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/seccomp	0.004s
=== RUN   TestCreateCommandHookTimeout
--- PASS: TestCreateCommandHookTimeout (0.00s)
=== RUN   TestCreateHooks
--- PASS: TestCreateHooks (0.00s)
=== RUN   TestSetupSeccomp
--- PASS: TestSetupSeccomp (0.00s)
=== RUN   TestLinuxCgroupWithMemoryResource
--- PASS: TestLinuxCgroupWithMemoryResource (0.00s)
=== RUN   TestLinuxCgroupSystemd
--- PASS: TestLinuxCgroupSystemd (0.00s)
=== RUN   TestLinuxCgroupSystemdWithEmptyPath
--- PASS: TestLinuxCgroupSystemdWithEmptyPath (0.00s)
=== RUN   TestLinuxCgroupSystemdWithInvalidPath
--- PASS: TestLinuxCgroupSystemdWithInvalidPath (0.00s)
=== RUN   TestLinuxCgroupsPathSpecified
--- PASS: TestLinuxCgroupsPathSpecified (0.00s)
=== RUN   TestLinuxCgroupsPathNotSpecified
--- PASS: TestLinuxCgroupsPathNotSpecified (0.00s)
=== RUN   TestSpecconvExampleValidate
--- PASS: TestSpecconvExampleValidate (0.00s)
=== RUN   TestDupNamespaces
--- PASS: TestDupNamespaces (0.00s)
=== RUN   TestNonZeroEUIDCompatibleSpecconvValidate
--- PASS: TestNonZeroEUIDCompatibleSpecconvValidate (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/specconv	0.010s
=== RUN   TestCaptureTestFunc
--- PASS: TestCaptureTestFunc (0.00s)
=== RUN   TestParsePackageName
--- PASS: TestParsePackageName (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/stacktrace	0.008s
=== RUN   TestUIDMapInUserNS
--- PASS: TestUIDMapInUserNS (0.00s)
=== RUN   TestParseStartTime
--- PASS: TestParseStartTime (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/system	0.005s
=== RUN   TestUserParseLine
--- PASS: TestUserParseLine (0.00s)
=== RUN   TestUserParsePasswd
--- PASS: TestUserParsePasswd (0.00s)
=== RUN   TestUserParseGroup
--- PASS: TestUserParseGroup (0.00s)
=== RUN   TestValidGetExecUser
--- PASS: TestValidGetExecUser (0.00s)
=== RUN   TestInvalidGetExecUser
--- PASS: TestInvalidGetExecUser (0.00s)
=== RUN   TestGetExecUserNilSources
--- PASS: TestGetExecUserNilSources (0.00s)
=== RUN   TestGetAdditionalGroups
--- PASS: TestGetAdditionalGroups (0.00s)
=== RUN   TestGetAdditionalGroupsNumeric
--- PASS: TestGetAdditionalGroupsNumeric (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/user	0.006s
=== RUN   TestSearchLabels
--- PASS: TestSearchLabels (0.00s)
=== RUN   TestResolveRootfs
--- PASS: TestResolveRootfs (0.00s)
=== RUN   TestResolveRootfsWithSymlink
--- PASS: TestResolveRootfsWithSymlink (0.00s)
=== RUN   TestResolveRootfsWithNonExistingDir
--- PASS: TestResolveRootfsWithNonExistingDir (0.00s)
=== RUN   TestExitStatus
--- PASS: TestExitStatus (0.00s)
=== RUN   TestExitStatusSignaled
--- PASS: TestExitStatusSignaled (0.00s)
=== RUN   TestWriteJSON
--- PASS: TestWriteJSON (0.00s)
=== RUN   TestCleanPath
--- PASS: TestCleanPath (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libcontainer/utils	0.007s
?   	github.com/nestybox/sysbox-runc/libsysbox/shiftfs	[no test files]
?   	github.com/nestybox/sysbox-runc/libsysbox/sysbox	[no test files]
=== RUN   TestCfgSeccomp
--- PASS: TestCfgSeccomp (0.00s)
=== RUN   TestCfgLibModMount
--- PASS: TestCfgLibModMount (0.00s)
=== RUN   TestCfgMaskedPaths
--- PASS: TestCfgMaskedPaths (0.00s)
=== RUN   TestCfgReadonlyPaths
--- PASS: TestCfgReadonlyPaths (0.00s)
=== RUN   TestCfgSysboxFsMounts
--- PASS: TestCfgSysboxFsMounts (0.00s)
PASS
ok  	github.com/nestybox/sysbox-runc/libsysbox/syscont	0.011s
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localintegration TESTPATH=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
bats -t tests/integration
1..101
ok 1 runc update --kernel-memory (initialized)
ok 2 runc update --kernel-memory (uninitialized)
ok 3 runc create (no limits + no cgrouppath + no permission) succeeds
ok 4 # skip (test requires rootless) runc create (rootless + no limits + cgrouppath + no permission) fails with permission error
ok 5 # skip (test requires rootless) runc create (rootless + limits + no cgrouppath + no permission) fails with informative error
ok 6 runc create (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 7 runc exec (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 8 # skip (sysbox-runc unsupported feature) checkpoint and restore
ok 9 # skip (sysbox-runc unsupported feature) checkpoint --pre-dump and restore
ok 10 # skip (sysbox-runc unsupported feature) checkpoint --lazy-pages and restore
ok 11 # skip (sysbox-runc unsupported feature) checkpoint and restore in external network namespace
ok 12 # skip (sysbox-runc unsupported feature) checkpoint and restore with container specific CRIU config
ok 13 runc create
ok 14 runc create exec
ok 15 runc create --pid-file
ok 16 runc create --pid-file with new CWD
ok 17 global --debug
ok 18 global --debug to --log
ok 19 global --debug to --log --log-format 'text'
ok 20 global --debug to --log --log-format 'json'
ok 21 runc delete
ok 22 runc delete --force
ok 23 runc delete --force ignore not exist
ok 24 events --stats
ok 25 events --interval default
ok 26 events --interval 1s
ok 27 events --interval 100ms
ok 28 runc exec
ok 29 runc exec --pid-file
ok 30 runc exec --pid-file with new CWD
ok 31 runc exec ls -la
ok 32 runc exec ls -la with --cwd
ok 33 runc exec --env
ok 34 runc exec --user
ok 35 runc exec --additional-gids
ok 36 runc exec --preserve-fds
ok 37 runc -h
ok 38 runc command -h
ok 39 runc foo -h
ok 40 kill detached busybox
ok 41 list
ok 42 mask paths [file]
ok 43 mask paths [directory]
ok 44 bind mount
ok 45 bind mount above rootfs
ok 46 bind mount directly above rootfs
ok 47 bind mount below the rootfs
ok 48 rootfs on tmpfs
ok 49 bind mount on tmpfs
ok 50 runc pause and resume
ok 51 runc pause and resume with nonexist container
ok 52 ps
ok 53 ps -f json
ok 54 ps -e
ok 55 global --root
ok 56 spec generation cwd
ok 57 spec generation --bundle
ok 58 # skip (needs re-work due to migration to go-modules) spec validator
ok 59 # skip (not written yet) spec process validator
ok 60 # skip (not written yet) spec read-only path filtering
ok 61 # skip (not written yet) spec masked path filtering
ok 62 runc start
ok 63 runc run detached
ok 64 runc run detached ({u,g}id != 0)
ok 65 runc run detached --pid-file
ok 66 runc run detached --pid-file with new CWD
ok 67 runc run
ok 68 runc run ({u,g}id != 0)
ok 69 runc run with rootfs set to .
ok 70 runc run --pid-file
ok 71 state (kill + delete)
ok 72 state (pause + resume)
ok 73 syscont: root process caps
ok 74 syscont: exec root process caps
ok 75 syscont: exec non-root process caps
ok 76 syscont: exec non-root process caps
ok 77 syscont: cgroup mounts
ok 78 syscont: cgroup create
ok 79 # skip (wait until sysbox implements intercept of mount syscall) syscont: inner container procfs
ok 80 syscont: /lib/modules/<kernel-release> mount
ok 81 # skip (not written yet) syscont: disallowed mounts
ok 82 # skip (not written yet) syscont: sysbox-fs mounts
ok 83 # skip (wait until sysbox implements intercept of mount syscall) syscont: sysbox-fs can't be unmounted
ok 84 # skip (wait until sysbox implements intercept of umount syscall) syscont: procfs remount
ok 85 syscont: uses all namespaces
ok 86 syscont: unshare
ok 87 syscont: syscall: mount and umount
ok 88 syscont uid/gid mappings
ok 89 runc run [tty ptsname]
ok 90 runc run [tty owner]
ok 91 runc run [tty owner] ({u,g}id != 0)
ok 92 runc exec [tty ptsname]
ok 93 runc exec [tty owner]
ok 94 runc exec [tty owner] ({u,g}id != 0)
ok 95 runc exec [tty consolesize]
ok 96 runc create [terminal=false]
ok 97 runc run [terminal=false]
ok 98 runc run -d [terminal=false]
ok 99 update
ok 100 # skip (Test requires cgroups_rt) update rt period and runtime
ok 101 # skip (fails when git change is pending) runc version
docker run  -t --privileged --rm -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc:/root/nestybox/sysbox-runc -v /home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc/../sysbox-ipc:/root/nestybox/sysbox-ipc -v /lib/modules:/lib/modules:ro -v /pkg/mod:/go/pkg/mod runc_dev:HEAD make localintegration-shiftuid TESTPATH=
fatal: not a git repository: /root/nestybox/sysbox-runc/../.git/modules/sysbox-runc
SHIFT_UIDS=true bats -t tests/integration
1..101
ok 1 runc update --kernel-memory (initialized)
ok 2 runc update --kernel-memory (uninitialized)
ok 3 runc create (no limits + no cgrouppath + no permission) succeeds
ok 4 # skip (test requires rootless) runc create (rootless + no limits + cgrouppath + no permission) fails with permission error
ok 5 # skip (test requires rootless) runc create (rootless + limits + no cgrouppath + no permission) fails with informative error
ok 6 runc create (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 7 runc exec (limits + cgrouppath + permission on the cgroup dir) succeeds
ok 8 # skip (sysbox-runc unsupported feature) checkpoint and restore
ok 9 # skip (sysbox-runc unsupported feature) checkpoint --pre-dump and restore
ok 10 # skip (sysbox-runc unsupported feature) checkpoint --lazy-pages and restore
ok 11 # skip (sysbox-runc unsupported feature) checkpoint and restore in external network namespace
ok 12 # skip (sysbox-runc unsupported feature) checkpoint and restore with container specific CRIU config
ok 13 runc create
ok 14 runc create exec
ok 15 runc create --pid-file
ok 16 runc create --pid-file with new CWD
ok 17 global --debug
ok 18 global --debug to --log
ok 19 global --debug to --log --log-format 'text'
ok 20 global --debug to --log --log-format 'json'
ok 21 runc delete
ok 22 runc delete --force
ok 23 runc delete --force ignore not exist
ok 24 events --stats
ok 25 events --interval default
ok 26 events --interval 1s
ok 27 events --interval 100ms
ok 28 runc exec
ok 29 runc exec --pid-file
ok 30 runc exec --pid-file with new CWD
ok 31 runc exec ls -la
ok 32 runc exec ls -la with --cwd
ok 33 runc exec --env
ok 34 runc exec --user
ok 35 runc exec --additional-gids
ok 36 runc exec --preserve-fds
ok 37 runc -h
ok 38 runc command -h
ok 39 runc foo -h
ok 40 kill detached busybox
ok 41 list
ok 42 mask paths [file]
ok 43 mask paths [directory]
ok 44 bind mount
ok 45 bind mount above rootfs
ok 46 bind mount directly above rootfs
ok 47 bind mount below the rootfs
ok 48 rootfs on tmpfs
ok 49 bind mount on tmpfs
ok 50 runc pause and resume
ok 51 runc pause and resume with nonexist container
ok 52 ps
ok 53 ps -f json
ok 54 ps -e
ok 55 global --root
ok 56 spec generation cwd
ok 57 spec generation --bundle
ok 58 # skip (needs re-work due to migration to go-modules) spec validator
ok 59 # skip (not written yet) spec process validator
ok 60 # skip (not written yet) spec read-only path filtering
ok 61 # skip (not written yet) spec masked path filtering
ok 62 runc start
ok 63 runc run detached
ok 64 runc run detached ({u,g}id != 0)
ok 65 runc run detached --pid-file
ok 66 runc run detached --pid-file with new CWD
ok 67 runc run
ok 68 runc run ({u,g}id != 0)
ok 69 runc run with rootfs set to .
ok 70 runc run --pid-file
ok 71 state (kill + delete)
ok 72 state (pause + resume)
ok 73 syscont: root process caps
ok 74 syscont: exec root process caps
ok 75 syscont: exec non-root process caps
ok 76 syscont: exec non-root process caps
ok 77 syscont: cgroup mounts
ok 78 syscont: cgroup create
ok 79 # skip (wait until sysbox implements intercept of mount syscall) syscont: inner container procfs
ok 80 syscont: /lib/modules/<kernel-release> mount
ok 81 # skip (not written yet) syscont: disallowed mounts
ok 82 # skip (not written yet) syscont: sysbox-fs mounts
ok 83 # skip (wait until sysbox implements intercept of mount syscall) syscont: sysbox-fs can't be unmounted
ok 84 # skip (wait until sysbox implements intercept of umount syscall) syscont: procfs remount
ok 85 syscont: uses all namespaces
ok 86 syscont: unshare
ok 87 syscont: syscall: mount and umount
ok 88 syscont uid/gid mappings
ok 89 runc run [tty ptsname]
ok 90 runc run [tty owner]
ok 91 runc run [tty owner] ({u,g}id != 0)
ok 92 runc exec [tty ptsname]
ok 93 runc exec [tty owner]
ok 94 runc exec [tty owner] ({u,g}id != 0)
ok 95 runc exec [tty consolesize]
ok 96 runc create [terminal=false]
ok 97 runc run [terminal=false]
ok 98 runc run -d [terminal=false]
ok 99 update
ok 100 # skip (Test requires cgroups_rt) update rt period and runtime
ok 101 # skip (fails when git change is pending) runc version
make[2]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox/sysbox-runc'

** Running sysbox integration tests **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "testContainerInit && make test-sysbox-local TESTPATH="
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'sysbox-runc' is up to date.
make[1]: 'sysbox-fs' is up to date.
make[1]: 'sysbox-mgr' is up to date.
install -D -m0755 sysbox-fs/sysbox-fs /usr/local/sbin/sysbox-fs
install -D -m0755 sysbox-mgr/sysbox-mgr /usr/local/sbin/sysbox-mgr
install -D -m0755 sysbox-runc/sysbox-runc /usr/local/sbin/sysbox-runc
install -D -m0755 bin/sysbox /usr/local/sbin/sysbox
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 # skip (uid shifting disabled) uid alloc basic
ok 8 # skip (uid shifting disabled) uid exhaust
ok 9 # skip (uid shifting disabled) uid reuse
ok 10 # skip (needs UID shifting) shiftfsMgr basic
ok 11 # skip (needs UID shifting) shiftfsMgr multiple syscont
ok 12 # skip (needs UID shifting) shiftfsMgr skip shiftfs on bind-mount
ok 13 # skip (needs UID shifting) shiftfsMgr shiftfs file mount
ok 14 # skip (needs UID shifting) shiftfsMgr shiftfs no-exec on host
ok 15 # skip (needs UID shifting) shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic

** Running sysbox integration tests (with uid shifting) **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker run -it --privileged --rm --hostname sysbox-test --name sysbox-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod sysbox-test /bin/bash -c "export SHIFT_UIDS=true && testContainerInit && make test-sysbox-local TESTPATH="
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'protobuf.pb.go' is up to date.
make[1]: 'sysbox-runc' is up to date.
make[1]: 'sysbox-fs' is up to date.
make[1]: 'sysbox-mgr' is up to date.
install -D -m0755 sysbox-fs/sysbox-fs /usr/local/sbin/sysbox-fs
install -D -m0755 sysbox-mgr/sysbox-mgr /usr/local/sbin/sysbox-mgr
install -D -m0755 sysbox-runc/sysbox-runc /usr/local/sbin/sysbox-runc
install -D -m0755 bin/sysbox /usr/local/sbin/sysbox
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 uid alloc basic
ok 8 uid exhaust
ok 9 uid reuse
ok 10 shiftfsMgr basic
ok 11 shiftfsMgr multiple syscont
ok 12 shiftfsMgr skip shiftfs on bind-mount
ok 13 shiftfsMgr shiftfs file mount
ok 14 shiftfsMgr shiftfs no-exec on host
ok 15 shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
vagrant@ubuntu-eoan-vm:~/wsp/v0.1.3/sysbox$



vagrant@ubuntu-eoan-vm:~/wsp/v0.1.3/sysbox$ make test-installer
make test-cntr-installer
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:eoan
 ---> dcbcfdcd50bb
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> e658a170e84b
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> 7bd436a4539e
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> c5bd531c949b
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> 6bbd20c8a4c6
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> c339507a41df
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 7c9ad8e05804
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> c8b260367c22
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> 16fbef3033f0
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> ce3556747dc5
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 02cb515b43c6
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> 130c6ddb1244
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         disco         stable"
 ---> Using cache
 ---> 29aa064b59d6
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> f18fa45cdbd9
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> 1d29b080caac
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> 86a309735173
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> aaa4d7574731
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> 39c50d4f5f4b
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> 9b91d83bda83
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> 3665cc4d6d48
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> 4156970026bf
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> 53161d5f8b36
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> aa4bb59c4d7a
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> 4ce00cefa0f7
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> 062447bb9378
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> b3e33d085030
Successfully built b3e33d085030
Successfully tagged sysbox-test:latest

** Building the test-installer container image**

Sending build context to Docker daemon  240.6kB
Step 1/5 : FROM sysbox-test:latest
 ---> b3e33d085030
Step 2/5 : RUN apt-get update &&                                apt-get install -y --no-install-recommends               systemd                                          systemd-sysv                                     libsystemd0                                      ca-certificates                                  dbus                                             iptables                                         iproute2                                         kmod                                             locales                                          sudo                                             udev &&                                                                                   echo "ReadKMsg=no" >> /etc/systemd/journald.conf &&                                                                                         systemctl mask getty@tty1.service getty-static.service &&                                                                                   apt-get clean -y &&                                                   rm -rf                                                                   /var/cache/debconf/*                                                  /var/lib/apt/lists/*                                                  /var/log/*                                                            /tmp/*                                                                /var/tmp/*                                                            /usr/share/doc/*                                                      /usr/share/man/*                                                      /usr/share/local/* &&                                                                                                                    useradd --create-home --shell /bin/bash admin && echo "admin:admin" |         chpasswd && adduser admin sudo
 ---> Using cache
 ---> fa8f47ef4afa
Step 3/5 : STOPSIGNAL SIGRTMIN+3
 ---> Using cache
 ---> f9253105ac04
Step 4/5 : ENV container docker
 ---> Using cache
 ---> 8d9f3a1f62b2
Step 5/5 : ENTRYPOINT [ "/sbin/init" ]
 ---> Using cache
 ---> 35a7646dad8a
Successfully built 35a7646dad8a
Successfully tagged sysbox-installer-test:latest
docker run -d --rm --privileged --hostname sysbox-installer-test --name sysbox-installer-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod --mount type=tmpfs,destination=/run --mount type=tmpfs,destination=/run/lock --mount type=tmpfs,destination=/tmp sysbox-installer-test
c60cc1e75585878f1a108be509ee8702e0cce61cf316c8a7106adf7f7ae324d7

** Installing sysbox deb package **

docker exec -it sysbox-installer-test /bin/bash -c "rm -rf /usr/sbin/policy-rc.d && \
	DEBIAN_FRONTEND=noninteractive dpkg -i image/deb/debbuild/ubuntu-eoan/sysbox_0.1.3-0.ubuntu-eoan_amd64.deb"
Selecting previously unselected package sysbox.
(Reading database ... 25737 files and directories currently installed.)
Preparing to unpack .../sysbox_0.1.3-0.ubuntu-eoan_amd64.deb ...
Unpacking sysbox (0.1.3-0.ubuntu-eoan) ...
Setting up sysbox (0.1.3-0.ubuntu-eoan) ...
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-fs.service → /lib/systemd/system/sysbox-fs.service.
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-mgr.service → /lib/systemd/system/sysbox-mgr.service.
Created symlink /etc/systemd/system/multi-user.target.wants/sysbox.service → /lib/systemd/system/sysbox.service.
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"default-runtime\": \"sysbox-runc\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Running sysbox integration tests **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker exec -it sysbox-installer-test make sysbox-runc-recvtty
make[1]: Entering directory '/root/nestybox/sysbox/sysbox-runc'
make[1]: Nothing to be done for 'recvtty'.
make[1]: Leaving directory '/root/nestybox/sysbox/sysbox-runc'
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"userns-remap\": \"sysbox\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
docker exec -it sysbox-installer-test /bin/bash -c "export SB_INSTALLER=true && \
	make test-sysbox-local TESTPATH="
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 # skip (uid shifting disabled) uid alloc basic
ok 8 # skip (uid shifting disabled) uid exhaust
ok 9 # skip (uid shifting disabled) uid reuse
ok 10 # skip (needs UID shifting) shiftfsMgr basic
ok 11 # skip (needs UID shifting) shiftfsMgr multiple syscont
ok 12 # skip (needs UID shifting) shiftfsMgr skip shiftfs on bind-mount
ok 13 # skip (needs UID shifting) shiftfsMgr shiftfs file mount
ok 14 # skip (needs UID shifting) shiftfsMgr shiftfs no-exec on host
ok 15 # skip (needs UID shifting) shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
docker stop sysbox-installer-test
sysbox-installer-test
make test-cntr-installer
make[1]: Entering directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Building the test container **

Sending build context to Docker daemon  240.6kB
Step 1/26 : FROM ubuntu:eoan
 ---> dcbcfdcd50bb
Step 2/26 : RUN apt-get update && apt-get install -y     build-essential     automake     autoconf     procps     nano     less     curl     sudo     gawk     git     iptables     jq     pkg-config     libaio-dev     libcap-dev     libprotobuf-dev     libnl-3-dev     libnet-dev     libseccomp2     libseccomp-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     uidmap     kmod     unzip     time     net-tools     lsb-release     wget     ca-certificates     --no-install-recommends     && apt-get clean
 ---> Using cache
 ---> e658a170e84b
Step 3/26 : RUN wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz &&     tar -C /usr/local -xzf go1.13.3.linux-amd64.tar.gz &&     /usr/local/go/bin/go env -w GONOSUMDB=/root/nestybox
 ---> Using cache
 ---> 7bd436a4539e
Step 4/26 : ENV GOPATH /go
 ---> Using cache
 ---> c5bd531c949b
Step 5/26 : ENV PATH $GOPATH/bin:/usr/local/go/bin:$PATH
 ---> Using cache
 ---> 6bbd20c8a4c6
Step 6/26 : RUN go env -w GONOSUMDB=/root/nestybox &&     mkdir -p "$GOPATH/src" "$GOPATH/bin" &&     chmod -R 777 "$GOPATH"
 ---> Using cache
 ---> c339507a41df
Step 7/26 : RUN useradd -u1000 -m -d/home/rootless -s/bin/bash rootless
 ---> Using cache
 ---> 7c9ad8e05804
Step 8/26 : RUN cd /tmp     && git clone https://github.com/sstephenson/bats.git     && cd bats     && git reset --hard 03608115df2071fff4eaaff1605768c275e5f81f     && ./install.sh /usr/local     && rm -rf /tmp/bats
 ---> Using cache
 ---> c8b260367c22
Step 9/26 : RUN mkdir -p ~/bin/protoc     && cd ~/bin/protoc/     && wget https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip     && unzip protoc-3.6.1-linux-x86_64.zip     && cp -r include/* /usr/local/include/     && cp bin/protoc /usr/local/bin/     && cd     && rm -rf ~/bin/protoc/     && GIT_TAG="v1.3.1"     && go get -d -u github.com/golang/protobuf/protoc-gen-go     && git -C "$GOPATH"/src/github.com/golang/protobuf checkout $GIT_TAG > /dev/null     && go install github.com/golang/protobuf/protoc-gen-go
 ---> Using cache
 ---> 16fbef3033f0
Step 10/26 : RUN apt-get install -y        apt-transport-https        ca-certificates        curl        gnupg2        software-properties-common
 ---> Using cache
 ---> ce3556747dc5
Step 11/26 : RUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -
 ---> Using cache
 ---> 02cb515b43c6
Step 12/26 : RUN apt-key fingerprint 0EBFCD88
 ---> Using cache
 ---> 130c6ddb1244
Step 13/26 : RUN add-apt-repository         "deb [arch=amd64] https://download.docker.com/linux/ubuntu         disco         stable"
 ---> Using cache
 ---> 29aa064b59d6
Step 14/26 : RUN apt-get update && apt-get install -y docker-ce docker-ce-cli containerd.io
 ---> Using cache
 ---> f18fa45cdbd9
Step 15/26 : ADD https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/bash/docker /etc/bash_completion.d/docker.sh
Downloading  114.8kB
 ---> Using cache
 ---> 1d29b080caac
Step 16/26 : RUN apt-get update && apt-get install bash-completion
 ---> Using cache
 ---> 86a309735173
Step 17/26 : RUN echo ". /etc/bash_completion" >> /etc/bash.bashrc
 ---> Using cache
 ---> aaa4d7574731
Step 18/26 : RUN apt-get update && apt-get install -y     fuse     rsync
 ---> Using cache
 ---> 39c50d4f5f4b
Step 19/26 : RUN useradd sysbox     && mkdir -p /var/lib/sysboxfs
 ---> Using cache
 ---> 9b91d83bda83
Step 20/26 : COPY .docker/config.json /root/.docker/config.json
 ---> Using cache
 ---> 3665cc4d6d48
Step 21/26 : COPY scr/testContainerInit /usr/bin
 ---> Using cache
 ---> 4156970026bf
Step 22/26 : COPY scr/testContainerCleanup /usr/bin
 ---> Using cache
 ---> 53161d5f8b36
Step 23/26 : COPY bin/userns_child_exec /usr/bin
 ---> Using cache
 ---> aa4bb59c4d7a
Step 24/26 : RUN mkdir -p /root/nestybox
 ---> Using cache
 ---> 4ce00cefa0f7
Step 25/26 : WORKDIR /root/nestybox/sysbox
 ---> Using cache
 ---> 062447bb9378
Step 26/26 : CMD /bin/bash
 ---> Using cache
 ---> b3e33d085030
Successfully built b3e33d085030
Successfully tagged sysbox-test:latest

** Building the test-installer container image**

Sending build context to Docker daemon  240.6kB
Step 1/5 : FROM sysbox-test:latest
 ---> b3e33d085030
Step 2/5 : RUN apt-get update &&                                apt-get install -y --no-install-recommends               systemd                                          systemd-sysv                                     libsystemd0                                      ca-certificates                                  dbus                                             iptables                                         iproute2                                         kmod                                             locales                                          sudo                                             udev &&                                                                                   echo "ReadKMsg=no" >> /etc/systemd/journald.conf &&                                                                                         systemctl mask getty@tty1.service getty-static.service &&                                                                                   apt-get clean -y &&                                                   rm -rf                                                                   /var/cache/debconf/*                                                  /var/lib/apt/lists/*                                                  /var/log/*                                                            /tmp/*                                                                /var/tmp/*                                                            /usr/share/doc/*                                                      /usr/share/man/*                                                      /usr/share/local/* &&                                                                                                                    useradd --create-home --shell /bin/bash admin && echo "admin:admin" |         chpasswd && adduser admin sudo
 ---> Using cache
 ---> fa8f47ef4afa
Step 3/5 : STOPSIGNAL SIGRTMIN+3
 ---> Using cache
 ---> f9253105ac04
Step 4/5 : ENV container docker
 ---> Using cache
 ---> 8d9f3a1f62b2
Step 5/5 : ENTRYPOINT [ "/sbin/init" ]
 ---> Using cache
 ---> 35a7646dad8a
Successfully built 35a7646dad8a
Successfully tagged sysbox-installer-test:latest
docker run -d --rm --privileged --hostname sysbox-installer-test --name sysbox-installer-test -v /home/vagrant/wsp/v0.1.3/sysbox:/root/nestybox/sysbox -v /lib/modules:/lib/modules:ro -v /var/tmp/sysbox-test-var-lib-docker:/var/lib/docker -v /var/tmp/sysbox-test-var-lib-sysbox:/var/lib/sysbox -v /pkg/mod:/go/pkg/mod --mount type=tmpfs,destination=/run --mount type=tmpfs,destination=/run/lock --mount type=tmpfs,destination=/tmp sysbox-installer-test
fe78bb232419bd7ee6ee5c48705abcf7e800f18d9a414501cd004ac2dcdbfd24

** Installing sysbox deb package **

docker exec -it sysbox-installer-test /bin/bash -c "rm -rf /usr/sbin/policy-rc.d && \
	DEBIAN_FRONTEND=noninteractive dpkg -i image/deb/debbuild/ubuntu-eoan/sysbox_0.1.3-0.ubuntu-eoan_amd64.deb"
Selecting previously unselected package sysbox.
(Reading database ... 25737 files and directories currently installed.)
Preparing to unpack .../sysbox_0.1.3-0.ubuntu-eoan_amd64.deb ...
Unpacking sysbox (0.1.3-0.ubuntu-eoan) ...
Setting up sysbox (0.1.3-0.ubuntu-eoan) ...
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-fs.service → /lib/systemd/system/sysbox-fs.service.
Created symlink /etc/systemd/system/sysbox.service.wants/sysbox-mgr.service → /lib/systemd/system/sysbox-mgr.service.
Created symlink /etc/systemd/system/multi-user.target.wants/sysbox.service → /lib/systemd/system/sysbox.service.
docker exec -it sysbox-installer-test /bin/bash -c "cat /etc/docker/daemon.json | \
	jq '. + {\"default-runtime\": \"sysbox-runc\"}' > /tmp/daemon.json && \
	mv /tmp/daemon.json /etc/docker/daemon.json && \
	systemctl restart docker.service"
make[1]: Leaving directory '/home/vagrant/wsp/v0.1.3/sysbox'

** Running sysbox-installer integration tests (with uid shifting) **

/home/vagrant/wsp/v0.1.3/sysbox/tests/scr/testContainerPre /var/tmp/sysbox-test-var-lib-docker /var/tmp/sysbox-test-var-lib-sysbox
docker exec -it sysbox-installer-test make sysbox-runc-recvtty
make[1]: Entering directory '/root/nestybox/sysbox/sysbox-runc'
make[1]: Nothing to be done for 'recvtty'.
make[1]: Leaving directory '/root/nestybox/sysbox/sysbox-runc'
docker exec -it sysbox-installer-test /bin/bash -c "export SB_INSTALLER=true SHIFT_UIDS=true && \
	make test-sysbox-local TESTPATH="
/root/nestybox/sysbox/tests/scr/testSysbox

Executing sysbox-mgr tests ...
1..15
ok 1 dsVolMgr basic
ok 2 dsVolMgr persistence
ok 3 dsVolMgr non-persistence
ok 4 dsVolMgr consecutive restart
ok 5 dsVolMgr sync-out
ok 6 /etc/subuid check
ok 7 uid alloc basic
ok 8 uid exhaust
ok 9 uid reuse
ok 10 shiftfsMgr basic
ok 11 shiftfsMgr multiple syscont
ok 12 shiftfsMgr skip shiftfs on bind-mount
ok 13 shiftfsMgr shiftfs file mount
ok 14 shiftfsMgr shiftfs no-exec on host
ok 15 shiftfsMgr bind-mount no-exec

Executing sysbox-fs tests ...
1..32
ok 1 nf_conntrack_max lookup() operation
ok 2 nf_conntrack_max read() operation
ok 3 nf_conntrack_max write() operation (lower value)
ok 4 nf_conntrack_max write() operation (higher value)
ok 5 proc lookup
ok 6 proc read-only
ok 7 # skip (not a sysbox-fs mount yet) procCgroups lookup() operation
ok 8 # skip (not a sysbox-fs mount yet) procCpuinfo lookup() operation
ok 9 # skip (not a sysbox-fs mount yet) procDevices lookup() operation
ok 10 # skip (not a sysbox-fs mount yet) procDiskstats lookup() operation
ok 11 # skip (not a sysbox-fs mount yet) procLoadavg lookup() operation
ok 12 # skip (not a sysbox-fs mount yet) procMeminfo lookup() operation
ok 13 # skip (not a sysbox-fs mount yet) procPagetypeinfo lookup() operation
ok 14 # skip (not a sysbox-fs mount yet) procPartitions lookup() operation
ok 15 # skip (not a sysbox-fs mount yet) procStat lookup() operation
ok 16 # skip (not a sysbox-fs mount yet) procSwaps lookup() operation
ok 17 disable_ipv6 lookup
ok 18 disable_ipv6 namespacing
ok 19 /proc/sys hierarchy
ok 20 /proc/sys ownership
ok 21 /proc/sys namespaced resources
ok 22 /proc/sys non-namespaced resources
ok 23 # skip (issue #246) /proc/sys concurrent intra-container access
ok 24 /proc/sys concurrent inter-container access
ok 25 # skip (issue #246) /proc/sys access frequency
ok 26 /proc/sys stat
ok 27 /proc/sys chown
ok 28 /proc/sys chmod
ok 29 /proc/sys read-permission check
ok 30 # skip (issue #259) /proc/sys write-permission check
ok 31 procUptime lookup() operation
ok 32 procUptime read() operation

Executing docker tests ...
1..9
ok 1 basic sys container
ok 2 docker --init
ok 3 docker vol mount
ok 4 docker bind mount
ok 5 docker tmpfs mount
ok 6 vol mount on var-lib-docker
ok 7 bind mount on var-lib-docker
ok 8 redundant /var/lib/docker mount
ok 9 concurrent /var/lib/docker mount

Executing dind tests ...
1..8
ok 1 dind basic
ok 2 dind busybox
ok 3 dind docker build
ok 4 build with inner images
ok 5 commit with inner images
ok 6 dind bridge net
ok 7 dind user net
ok 8 dind host net

Executing app tests (l1) ...
1..5
ok 1 drone ci/cd pipeline execution
ok 2 l1 nginx basic
ok 3 l1 nginx client-server
ok 4 systemd basic features
ok 5 systemd mount overlaps

Executing app tests (l2) ...
1..15
ok 1 l2 apache basic
ok 2 l2 apache client-server
ok 3 # skip (unstable) l2 elasticSearch basic
ok 4 l2 fluentd basic
ok 5 # skip (unstable) l2 mysql basic
ok 6 # skip (unstable) l2 mysql client-server
ok 7 l2 nginx basic
ok 8 l2 nginx client-server
ok 9 l2 postgres basic
ok 10 l2 postgres client-server
ok 11 l2 prometheus basic
ok 12 l2 redis basic
ok 13 l2 redis client-server
ok 14 l2 telegraf basic
ok 15 # skip (unstable) l2 wordpress basic
docker stop sysbox-installer-test
sysbox-installer-test
vagrant@ubuntu-eoan-vm:~/wsp/v0.1.3/sysbox$
```
